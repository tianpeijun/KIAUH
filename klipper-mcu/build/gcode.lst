ARM GAS  /tmp/ccqT8DeC.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 2
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"gcode.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.gcode_parse_line.part.0,"ax",%progbits
  18              		.align	1
  19              		.p2align 2,,3
  20              		.arch armv7e-m
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  24              		.fpu fpv4-sp-d16
  26              	gcode_parse_line.part.0:
  27              	.LFB34:
  28              		.file 1 "app/gcode.c"
   1:app/gcode.c   **** /**
   2:app/gcode.c   ****  * @file    gcode.c
   3:app/gcode.c   ****  * @brief   G-code 解析器实现
   4:app/gcode.c   ****  * 
   5:app/gcode.c   ****  * Klipper MCU 移植项目 - G-code 解析模块
   6:app/gcode.c   ****  * 移植自 klippy/gcode.py，简化为只支持 MVP 指令
   7:app/gcode.c   ****  * 
   8:app/gcode.c   ****  * 支持的指令:
   9:app/gcode.c   ****  * - G0/G1: 直线运动 (X Y Z E F)
  10:app/gcode.c   ****  * - G28: 归零 (X Y Z 可选)
  11:app/gcode.c   ****  * - G90/G91: 绝对/相对坐标模式
  12:app/gcode.c   ****  * - M104/M109: 热端温度设置/等待
  13:app/gcode.c   ****  * - M106/M107: 风扇控制
  14:app/gcode.c   ****  * - M114: 位置查询
  15:app/gcode.c   ****  * 
  16:app/gcode.c   ****  * @note    验收标准: 4.1.1 - 4.1.7
  17:app/gcode.c   ****  */
  18:app/gcode.c   **** 
  19:app/gcode.c   **** #include "gcode.h"
  20:app/gcode.c   **** #include <stddef.h>
  21:app/gcode.c   **** #include <string.h>
  22:app/gcode.c   **** #include <ctype.h>
  23:app/gcode.c   **** #include <stdarg.h>
  24:app/gcode.c   **** 
  25:app/gcode.c   **** /* 条件编译: 仅在 MCU 构建时包含串口头文件 */
  26:app/gcode.c   **** #ifndef TEST_BUILD
  27:app/gcode.c   **** #include "src/stm32/serial.h"
  28:app/gcode.c   **** #endif
  29:app/gcode.c   **** 
  30:app/gcode.c   **** /* ========== 私有变量 ========== */
ARM GAS  /tmp/ccqT8DeC.s 			page 2


  31:app/gcode.c   **** 
  32:app/gcode.c   **** /* 当前坐标模式 */
  33:app/gcode.c   **** static gcode_mode_t s_coord_mode = GCODE_MODE_ABSOLUTE;
  34:app/gcode.c   **** 
  35:app/gcode.c   **** /* 当前位置 (用于相对坐标计算和 M114 查询) */
  36:app/gcode.c   **** static float s_pos_x = 0.0f;
  37:app/gcode.c   **** static float s_pos_y = 0.0f;
  38:app/gcode.c   **** static float s_pos_z = 0.0f;
  39:app/gcode.c   **** static float s_pos_e = 0.0f;
  40:app/gcode.c   **** 
  41:app/gcode.c   **** /* 当前进给速度 (mm/min) */
  42:app/gcode.c   **** static float s_feedrate = 3000.0f;
  43:app/gcode.c   **** 
  44:app/gcode.c   **** /* 行缓冲区 (仅在 MCU 构建时使用) */
  45:app/gcode.c   **** #define GCODE_LINE_BUFFER_SIZE  128
  46:app/gcode.c   **** #ifndef TEST_BUILD
  47:app/gcode.c   **** static char s_line_buffer[GCODE_LINE_BUFFER_SIZE];
  48:app/gcode.c   **** #endif
  49:app/gcode.c   **** 
  50:app/gcode.c   **** /* ========== 弱符号声明 (后续任务实现) ========== */
  51:app/gcode.c   **** 
  52:app/gcode.c   **** /*
  53:app/gcode.c   ****  * 使用弱符号允许在没有实现的情况下编译通过
  54:app/gcode.c   ****  * 实际功能将在后续任务中实现
  55:app/gcode.c   ****  */
  56:app/gcode.c   **** 
  57:app/gcode.c   **** /* Toolhead 运动接口 */
  58:app/gcode.c   **** __attribute__((weak)) int toolhead_move(float x, float y, float z, float e, float speed)
  59:app/gcode.c   **** {
  60:app/gcode.c   ****     (void)x; (void)y; (void)z; (void)e; (void)speed;
  61:app/gcode.c   ****     return 0;  /* 默认返回成功 */
  62:app/gcode.c   **** }
  63:app/gcode.c   **** 
  64:app/gcode.c   **** __attribute__((weak)) int toolhead_home(uint8_t axes_mask)
  65:app/gcode.c   **** {
  66:app/gcode.c   ****     (void)axes_mask;
  67:app/gcode.c   ****     return 0;  /* 默认返回成功 */
  68:app/gcode.c   **** }
  69:app/gcode.c   **** 
  70:app/gcode.c   **** __attribute__((weak)) void toolhead_get_position(float *p_x, float *p_y, float *p_z, float *p_e)
  71:app/gcode.c   **** {
  72:app/gcode.c   ****     /* 默认返回内部跟踪的位置 */
  73:app/gcode.c   ****     if (p_x != NULL) { *p_x = s_pos_x; }
  74:app/gcode.c   ****     if (p_y != NULL) { *p_y = s_pos_y; }
  75:app/gcode.c   ****     if (p_z != NULL) { *p_z = s_pos_z; }
  76:app/gcode.c   ****     if (p_e != NULL) { *p_e = s_pos_e; }
  77:app/gcode.c   **** }
  78:app/gcode.c   **** 
  79:app/gcode.c   **** __attribute__((weak)) void toolhead_wait_moves(void)
  80:app/gcode.c   **** {
  81:app/gcode.c   ****     /* 默认空实现 */
  82:app/gcode.c   **** }
  83:app/gcode.c   **** 
  84:app/gcode.c   **** /* Heater 温度接口 */
  85:app/gcode.c   **** __attribute__((weak)) void heater_set_temp(int id, float temp)
  86:app/gcode.c   **** {
  87:app/gcode.c   ****     (void)id; (void)temp;
ARM GAS  /tmp/ccqT8DeC.s 			page 3


  88:app/gcode.c   **** }
  89:app/gcode.c   **** 
  90:app/gcode.c   **** __attribute__((weak)) float heater_get_temp(int id)
  91:app/gcode.c   **** {
  92:app/gcode.c   ****     (void)id;
  93:app/gcode.c   ****     return 0.0f;  /* 默认返回 0 */
  94:app/gcode.c   **** }
  95:app/gcode.c   **** 
  96:app/gcode.c   **** __attribute__((weak)) float heater_get_target(int id)
  97:app/gcode.c   **** {
  98:app/gcode.c   ****     (void)id;
  99:app/gcode.c   ****     return 0.0f;  /* 默认返回 0 */
 100:app/gcode.c   **** }
 101:app/gcode.c   **** 
 102:app/gcode.c   **** __attribute__((weak)) int heater_is_at_target(int id)
 103:app/gcode.c   **** {
 104:app/gcode.c   ****     (void)id;
 105:app/gcode.c   ****     return 1;  /* 默认返回已达到目标 */
 106:app/gcode.c   **** }
 107:app/gcode.c   **** 
 108:app/gcode.c   **** /* Fan 风扇接口 */
 109:app/gcode.c   **** __attribute__((weak)) void fan_set_speed(int id, float speed)
 110:app/gcode.c   **** {
 111:app/gcode.c   ****     (void)id; (void)speed;
 112:app/gcode.c   **** }
 113:app/gcode.c   **** 
 114:app/gcode.c   **** __attribute__((weak)) float fan_get_speed(int id)
 115:app/gcode.c   **** {
 116:app/gcode.c   ****     (void)id;
 117:app/gcode.c   ****     return 0.0f;  /* 默认返回 0 */
 118:app/gcode.c   **** }
 119:app/gcode.c   **** 
 120:app/gcode.c   **** /* 加热器 ID 定义 */
 121:app/gcode.c   **** #define HEATER_HOTEND   0
 122:app/gcode.c   **** #define HEATER_BED      1
 123:app/gcode.c   **** 
 124:app/gcode.c   **** /* 风扇 ID 定义 */
 125:app/gcode.c   **** #define FAN_PART        0
 126:app/gcode.c   **** #define FAN_HOTEND      1
 127:app/gcode.c   **** 
 128:app/gcode.c   **** /* 归零轴掩码 */
 129:app/gcode.c   **** #define HOME_X_AXIS     (1 << 0)
 130:app/gcode.c   **** #define HOME_Y_AXIS     (1 << 1)
 131:app/gcode.c   **** #define HOME_Z_AXIS     (1 << 2)
 132:app/gcode.c   **** 
 133:app/gcode.c   **** /* ========== 私有函数声明 ========== */
 134:app/gcode.c   **** 
 135:app/gcode.c   **** static int parse_command(const char *line, gcode_cmd_t *p_cmd);
 136:app/gcode.c   **** static int parse_parameters(const char *line, gcode_cmd_t *p_cmd);
 137:app/gcode.c   **** static const char *skip_whitespace(const char *str);
 138:app/gcode.c   **** static int parse_float(const char *str, float *p_value, const char **p_end);
 139:app/gcode.c   **** static int is_supported_gcode(char cmd, int code);
 140:app/gcode.c   **** 
 141:app/gcode.c   **** /* ========== 公有函数实现 ========== */
 142:app/gcode.c   **** 
 143:app/gcode.c   **** /**
 144:app/gcode.c   ****  * @brief   初始化 G-code 解析器
ARM GAS  /tmp/ccqT8DeC.s 			page 4


 145:app/gcode.c   ****  */
 146:app/gcode.c   **** void
 147:app/gcode.c   **** gcode_init(void)
 148:app/gcode.c   **** {
 149:app/gcode.c   ****     /* 设置默认坐标模式为绝对模式 */
 150:app/gcode.c   ****     s_coord_mode = GCODE_MODE_ABSOLUTE;
 151:app/gcode.c   **** }
 152:app/gcode.c   **** 
 153:app/gcode.c   **** /**
 154:app/gcode.c   ****  * @brief   解析单行 G-code
 155:app/gcode.c   ****  */
 156:app/gcode.c   **** int
 157:app/gcode.c   **** gcode_parse_line(const char *line, gcode_cmd_t *p_cmd)
  29              		.loc 1 157 1 view -0
  30              		.cfi_startproc
  31              		@ args = 0, pretend = 0, frame = 0
  32              		@ frame_needed = 0, uses_anonymous_args = 0
  33              	.LVL0:
  34              		.loc 1 157 1 is_stmt 0 view .LVU1
  35 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
  36              		.cfi_def_cfa_offset 36
  37              		.cfi_offset 4, -36
  38              		.cfi_offset 5, -32
  39              		.cfi_offset 6, -28
  40              		.cfi_offset 7, -24
  41              		.cfi_offset 8, -20
  42              		.cfi_offset 9, -16
  43              		.cfi_offset 10, -12
  44              		.cfi_offset 11, -8
  45              		.cfi_offset 14, -4
  46              	.LVL1:
  47              	.L83:
  48              	.LBB64:
  49              	.LBB65:
 158:app/gcode.c   **** {
 159:app/gcode.c   ****     const char *p_pos;
 160:app/gcode.c   ****     int ret;
 161:app/gcode.c   ****     
 162:app/gcode.c   ****     /* 参数检查 */
 163:app/gcode.c   ****     if ((line == NULL) || (p_cmd == NULL)) {
 164:app/gcode.c   ****         return GCODE_ERR_NULL;
 165:app/gcode.c   ****     }
 166:app/gcode.c   ****     
 167:app/gcode.c   ****     /* 清空命令结构体 */
 168:app/gcode.c   ****     gcode_cmd_clear(p_cmd);
 169:app/gcode.c   ****     
 170:app/gcode.c   ****     /* 跳过行首空白 */
 171:app/gcode.c   ****     p_pos = skip_whitespace(line);
 172:app/gcode.c   ****     
 173:app/gcode.c   ****     /* 检查空行 */
 174:app/gcode.c   ****     if ((*p_pos == '\0') || (*p_pos == '\n') || (*p_pos == '\r')) {
 175:app/gcode.c   ****         return GCODE_ERR_EMPTY;
 176:app/gcode.c   ****     }
 177:app/gcode.c   ****     
 178:app/gcode.c   ****     /* 检查注释行 (以 ; 开头) */
 179:app/gcode.c   ****     if (*p_pos == ';') {
 180:app/gcode.c   ****         return GCODE_ERR_COMMENT;
ARM GAS  /tmp/ccqT8DeC.s 			page 5


 181:app/gcode.c   ****     }
 182:app/gcode.c   ****     
 183:app/gcode.c   ****     /* 解析命令字母和编号 */
 184:app/gcode.c   ****     ret = parse_command(p_pos, p_cmd);
 185:app/gcode.c   ****     if (ret != GCODE_OK) {
 186:app/gcode.c   ****         return ret;
 187:app/gcode.c   ****     }
 188:app/gcode.c   ****     
 189:app/gcode.c   ****     /* 检查是否为支持的命令 */
 190:app/gcode.c   ****     if (!is_supported_gcode(p_cmd->cmd, p_cmd->code)) {
 191:app/gcode.c   ****         return GCODE_ERR_UNKNOWN;
 192:app/gcode.c   ****     }
 193:app/gcode.c   ****     
 194:app/gcode.c   ****     /* 解析参数 */
 195:app/gcode.c   ****     ret = parse_parameters(p_pos, p_cmd);
 196:app/gcode.c   ****     if (ret != GCODE_OK) {
 197:app/gcode.c   ****         return ret;
 198:app/gcode.c   ****     }
 199:app/gcode.c   ****     
 200:app/gcode.c   ****     return GCODE_OK;
 201:app/gcode.c   **** }
 202:app/gcode.c   **** 
 203:app/gcode.c   **** /**
 204:app/gcode.c   ****  * @brief   获取当前坐标模式
 205:app/gcode.c   ****  */
 206:app/gcode.c   **** gcode_mode_t
 207:app/gcode.c   **** gcode_get_mode(void)
 208:app/gcode.c   **** {
 209:app/gcode.c   ****     return s_coord_mode;
 210:app/gcode.c   **** }
 211:app/gcode.c   **** 
 212:app/gcode.c   **** /**
 213:app/gcode.c   ****  * @brief   设置坐标模式
 214:app/gcode.c   ****  */
 215:app/gcode.c   **** void
 216:app/gcode.c   **** gcode_set_mode(gcode_mode_t mode)
 217:app/gcode.c   **** {
 218:app/gcode.c   ****     s_coord_mode = mode;
 219:app/gcode.c   **** }
 220:app/gcode.c   **** 
 221:app/gcode.c   **** /**
 222:app/gcode.c   ****  * @brief   清空命令结构体
 223:app/gcode.c   ****  */
 224:app/gcode.c   **** void
 225:app/gcode.c   **** gcode_cmd_clear(gcode_cmd_t *p_cmd)
 226:app/gcode.c   **** {
 227:app/gcode.c   ****     if (p_cmd != NULL) {
 228:app/gcode.c   ****         memset(p_cmd, 0, sizeof(gcode_cmd_t));
 229:app/gcode.c   ****     }
 230:app/gcode.c   **** }
 231:app/gcode.c   **** 
 232:app/gcode.c   **** /* ========== 私有函数实现 ========== */
 233:app/gcode.c   **** 
 234:app/gcode.c   **** /**
 235:app/gcode.c   ****  * @brief   跳过空白字符
 236:app/gcode.c   ****  * @param   str     输入字符串
 237:app/gcode.c   ****  * @retval  指向第一个非空白字符的指针
ARM GAS  /tmp/ccqT8DeC.s 			page 6


 238:app/gcode.c   ****  */
 239:app/gcode.c   **** static const char *
 240:app/gcode.c   **** skip_whitespace(const char *str)
 241:app/gcode.c   **** {
 242:app/gcode.c   ****     while ((*str == ' ') || (*str == '\t')) {
  50              		.loc 1 242 13 view .LVU2
  51 0004 0778     		ldrb	r7, [r0]	@ zero_extendqisi2
  52              		.loc 1 242 11 view .LVU3
  53 0006 202F     		cmp	r7, #32
  54 0008 0346     		mov	r3, r0
  55              	.LVL2:
  56              		.loc 1 242 11 is_stmt 1 view .LVU4
  57 000a 0246     		mov	r2, r0
  58 000c 00F10100 		add	r0, r0, #1
  59              	.LVL3:
  60              		.loc 1 242 11 is_stmt 0 view .LVU5
  61 0010 F8D0     		beq	.L83
  62              		.loc 1 242 26 view .LVU6
  63 0012 092F     		cmp	r7, #9
  64 0014 F6D0     		beq	.L83
 243:app/gcode.c   ****         str++;
 244:app/gcode.c   ****     }
 245:app/gcode.c   ****     return str;
  65              		.loc 1 245 5 is_stmt 1 view .LVU7
  66              	.LVL4:
  67              		.loc 1 245 5 is_stmt 0 view .LVU8
  68              	.LBE65:
  69              	.LBE64:
 174:app/gcode.c   ****         return GCODE_ERR_EMPTY;
  70              		.loc 1 174 5 is_stmt 1 view .LVU9
 174:app/gcode.c   ****         return GCODE_ERR_EMPTY;
  71              		.loc 1 174 8 is_stmt 0 view .LVU10
  72 0016 0D2F     		cmp	r7, #13
  73 0018 32D9     		bls	.L3
 179:app/gcode.c   ****         return GCODE_ERR_COMMENT;
  74              		.loc 1 179 5 is_stmt 1 view .LVU11
 179:app/gcode.c   ****         return GCODE_ERR_COMMENT;
  75              		.loc 1 179 8 is_stmt 0 view .LVU12
  76 001a 3B2F     		cmp	r7, #59
  77 001c 00F07C81 		beq	.L110
  78              	.L5:
  79              	.LVL5:
 242:app/gcode.c   ****         str++;
  80              		.loc 1 242 11 is_stmt 1 view .LVU13
  81              		.loc 1 245 5 view .LVU14
  82              	.LBB66:
  83              	.LBB67:
 246:app/gcode.c   **** }
 247:app/gcode.c   **** 
 248:app/gcode.c   **** /**
 249:app/gcode.c   ****  * @brief   解析浮点数
 250:app/gcode.c   ****  * @param   str         输入字符串
 251:app/gcode.c   ****  * @param   p_value     输出浮点值
 252:app/gcode.c   ****  * @param   p_end       输出解析结束位置
 253:app/gcode.c   ****  * @retval  0 成功，-1 失败
 254:app/gcode.c   ****  * 
 255:app/gcode.c   ****  * 简单的浮点数解析，支持:
ARM GAS  /tmp/ccqT8DeC.s 			page 7


 256:app/gcode.c   ****  * - 整数: 123
 257:app/gcode.c   ****  * - 小数: 123.456
 258:app/gcode.c   ****  * - 负数: -123.456
 259:app/gcode.c   ****  */
 260:app/gcode.c   **** static int
 261:app/gcode.c   **** parse_float(const char *str, float *p_value, const char **p_end)
 262:app/gcode.c   **** {
 263:app/gcode.c   ****     float result = 0.0f;
 264:app/gcode.c   ****     float fraction = 0.0f;
 265:app/gcode.c   ****     float divisor = 10.0f;
 266:app/gcode.c   ****     int negative = 0;
 267:app/gcode.c   ****     int has_digits = 0;
 268:app/gcode.c   ****     int in_fraction = 0;
 269:app/gcode.c   ****     
 270:app/gcode.c   ****     /* 跳过空白 */
 271:app/gcode.c   ****     str = skip_whitespace(str);
 272:app/gcode.c   ****     
 273:app/gcode.c   ****     /* 检查负号 */
 274:app/gcode.c   ****     if (*str == '-') {
 275:app/gcode.c   ****         negative = 1;
 276:app/gcode.c   ****         str++;
 277:app/gcode.c   ****     } else if (*str == '+') {
 278:app/gcode.c   ****         str++;
 279:app/gcode.c   ****     }
 280:app/gcode.c   ****     
 281:app/gcode.c   ****     /* 解析数字 */
 282:app/gcode.c   ****     while (1) {
 283:app/gcode.c   ****         if ((*str >= '0') && (*str <= '9')) {
 284:app/gcode.c   ****             has_digits = 1;
 285:app/gcode.c   ****             if (in_fraction) {
 286:app/gcode.c   ****                 fraction += (float)(*str - '0') / divisor;
 287:app/gcode.c   ****                 divisor *= 10.0f;
 288:app/gcode.c   ****             } else {
 289:app/gcode.c   ****                 result = result * 10.0f + (float)(*str - '0');
 290:app/gcode.c   ****             }
 291:app/gcode.c   ****             str++;
 292:app/gcode.c   ****         } else if ((*str == '.') && (!in_fraction)) {
 293:app/gcode.c   ****             in_fraction = 1;
 294:app/gcode.c   ****             str++;
 295:app/gcode.c   ****         } else {
 296:app/gcode.c   ****             break;
 297:app/gcode.c   ****         }
 298:app/gcode.c   ****     }
 299:app/gcode.c   ****     
 300:app/gcode.c   ****     /* 检查是否有有效数字 */
 301:app/gcode.c   ****     if (!has_digits) {
 302:app/gcode.c   ****         return -1;
 303:app/gcode.c   ****     }
 304:app/gcode.c   ****     
 305:app/gcode.c   ****     /* 合并整数和小数部分 */
 306:app/gcode.c   ****     result += fraction;
 307:app/gcode.c   ****     
 308:app/gcode.c   ****     /* 应用符号 */
 309:app/gcode.c   ****     if (negative) {
 310:app/gcode.c   ****         result = -result;
 311:app/gcode.c   ****     }
 312:app/gcode.c   ****     
ARM GAS  /tmp/ccqT8DeC.s 			page 8


 313:app/gcode.c   ****     *p_value = result;
 314:app/gcode.c   ****     if (p_end != NULL) {
 315:app/gcode.c   ****         *p_end = str;
 316:app/gcode.c   ****     }
 317:app/gcode.c   ****     
 318:app/gcode.c   ****     return 0;
 319:app/gcode.c   **** }
 320:app/gcode.c   **** 
 321:app/gcode.c   **** /**
 322:app/gcode.c   ****  * @brief   解析命令字母和编号
 323:app/gcode.c   ****  * @param   line    输入行
 324:app/gcode.c   ****  * @param   p_cmd   输出命令结构体
 325:app/gcode.c   ****  * @retval  GCODE_OK 成功
 326:app/gcode.c   ****  * @retval  GCODE_ERR_INVALID 无效命令格式
 327:app/gcode.c   ****  */
 328:app/gcode.c   **** static int
 329:app/gcode.c   **** parse_command(const char *line, gcode_cmd_t *p_cmd)
 330:app/gcode.c   **** {
 331:app/gcode.c   ****     const char *p_pos = line;
 332:app/gcode.c   ****     char cmd_char;
 333:app/gcode.c   ****     int code = 0;
 334:app/gcode.c   ****     
 335:app/gcode.c   ****     /* 跳过空白 */
 336:app/gcode.c   ****     p_pos = skip_whitespace(p_pos);
 337:app/gcode.c   ****     
 338:app/gcode.c   ****     /* 获取命令字母 (G 或 M) */
 339:app/gcode.c   ****     cmd_char = (char)toupper((unsigned char)*p_pos);
  84              		.loc 1 339 5 view .LVU15
  85              	.LBB68:
  86              		.loc 1 339 22 view .LVU16
  87              		.loc 1 339 22 view .LVU17
  88 0020 DFF804B3 		ldr	fp, .L118+4
  89 0024 1BF80700 		ldrb	r0, [fp, r7]	@ zero_extendqisi2
  90 0028 00F00300 		and	r0, r0, #3
  91 002c 0228     		cmp	r0, #2
  92              	.LBE68:
  93              		.loc 1 339 14 is_stmt 0 view .LVU18
  94 002e 04BF     		itt	eq
  95 0030 203F     		subeq	r7, r7, #32
  96              	.LVL6:
  97              		.loc 1 339 14 view .LVU19
  98 0032 FFB2     		uxtbeq	r7, r7
  99              	.LVL7:
 340:app/gcode.c   ****     if ((cmd_char != 'G') && (cmd_char != 'M')) {
 100              		.loc 1 340 5 is_stmt 1 view .LVU20
 101              		.loc 1 340 8 is_stmt 0 view .LVU21
 102 0034 472F     		cmp	r7, #71
 103 0036 2BD0     		beq	.L7
 104              		.loc 1 340 27 view .LVU22
 105 0038 4D2F     		cmp	r7, #77
 106 003a 40F07081 		bne	.L111
 341:app/gcode.c   ****         return GCODE_ERR_INVALID;
 342:app/gcode.c   ****     }
 343:app/gcode.c   ****     p_pos++;
 107              		.loc 1 343 5 is_stmt 1 view .LVU23
 344:app/gcode.c   ****     
 345:app/gcode.c   ****     /* 解析命令编号 */
ARM GAS  /tmp/ccqT8DeC.s 			page 9


 346:app/gcode.c   ****     while ((*p_pos >= '0') && (*p_pos <= '9')) {
 108              		.loc 1 346 13 is_stmt 0 view .LVU24
 109 003e 5878     		ldrb	r0, [r3, #1]	@ zero_extendqisi2
 110              		.loc 1 346 28 view .LVU25
 111 0040 3038     		subs	r0, r0, #48
 112              		.loc 1 346 11 view .LVU26
 113 0042 C4B2     		uxtb	r4, r0
 114 0044 092C     		cmp	r4, #9
 343:app/gcode.c   ****     
 115              		.loc 1 343 10 view .LVU27
 116 0046 03F10103 		add	r3, r3, #1
 117              	.LVL8:
 118              		.loc 1 346 5 is_stmt 1 view .LVU28
 119              		.loc 1 346 11 view .LVU29
 120 004a 00F26181 		bhi	.L112
 121              	.L46:
 333:app/gcode.c   ****     
 122              		.loc 1 333 9 is_stmt 0 view .LVU30
 123 004e 4FF00008 		mov	r8, #0
 124              	.LVL9:
 125              	.L9:
 347:app/gcode.c   ****         code = code * 10 + (*p_pos - '0');
 126              		.loc 1 347 9 is_stmt 1 view .LVU31
 346:app/gcode.c   ****         code = code * 10 + (*p_pos - '0');
 127              		.loc 1 346 13 is_stmt 0 view .LVU32
 128 0052 13F8014F 		ldrb	r4, [r3, #1]!	@ zero_extendqisi2
 129              	.LVL10:
 130              		.loc 1 347 21 view .LVU33
 131 0056 08EB8808 		add	r8, r8, r8, lsl #2
 132              	.LVL11:
 133              		.loc 1 347 14 view .LVU34
 134 005a 00EB4808 		add	r8, r0, r8, lsl #1
 135              	.LVL12:
 348:app/gcode.c   ****         p_pos++;
 136              		.loc 1 348 9 is_stmt 1 view .LVU35
 346:app/gcode.c   ****         code = code * 10 + (*p_pos - '0');
 137              		.loc 1 346 11 view .LVU36
 346:app/gcode.c   ****         code = code * 10 + (*p_pos - '0');
 138              		.loc 1 346 28 is_stmt 0 view .LVU37
 139 005e A4F13000 		sub	r0, r4, #48
 346:app/gcode.c   ****         code = code * 10 + (*p_pos - '0');
 140              		.loc 1 346 11 view .LVU38
 141 0062 C4B2     		uxtb	r4, r0
 142 0064 092C     		cmp	r4, #9
 143 0066 F4D9     		bls	.L9
 349:app/gcode.c   ****     }
 350:app/gcode.c   ****     
 351:app/gcode.c   ****     /* 存储命令 */
 352:app/gcode.c   ****     p_cmd->cmd = cmd_char;
 144              		.loc 1 352 5 is_stmt 1 view .LVU39
 145              	.LBE67:
 146              	.LBE66:
 147              	.LBB74:
 148              	.LBB75:
 353:app/gcode.c   ****     p_cmd->code = code;
 354:app/gcode.c   ****     
 355:app/gcode.c   ****     return GCODE_OK;
ARM GAS  /tmp/ccqT8DeC.s 			page 10


 356:app/gcode.c   **** }
 357:app/gcode.c   **** 
 358:app/gcode.c   **** /**
 359:app/gcode.c   ****  * @brief   解析命令参数
 360:app/gcode.c   ****  * @param   line    输入行
 361:app/gcode.c   ****  * @param   p_cmd   命令结构体 (已包含命令字母和编号)
 362:app/gcode.c   ****  * @retval  GCODE_OK 成功
 363:app/gcode.c   ****  * @retval  GCODE_ERR_PARAM 参数错误
 364:app/gcode.c   ****  * 
 365:app/gcode.c   ****  * 解析 X, Y, Z, E, F, S 参数
 366:app/gcode.c   ****  */
 367:app/gcode.c   **** static int
 368:app/gcode.c   **** parse_parameters(const char *line, gcode_cmd_t *p_cmd)
 369:app/gcode.c   **** {
 370:app/gcode.c   ****     const char *p_pos = line;
 371:app/gcode.c   ****     char param_char;
 372:app/gcode.c   ****     float value;
 373:app/gcode.c   ****     
 374:app/gcode.c   ****     /* 跳过命令部分 (G/M + 数字) */
 375:app/gcode.c   ****     p_pos = skip_whitespace(p_pos);
 376:app/gcode.c   ****     if ((*p_pos == 'G') || (*p_pos == 'g') || 
 377:app/gcode.c   ****         (*p_pos == 'M') || (*p_pos == 'm')) {
 378:app/gcode.c   ****         p_pos++;
 379:app/gcode.c   ****         while ((*p_pos >= '0') && (*p_pos <= '9')) {
 380:app/gcode.c   ****             p_pos++;
 381:app/gcode.c   ****         }
 382:app/gcode.c   ****     }
 383:app/gcode.c   ****     
 384:app/gcode.c   ****     /* 解析参数 */
 385:app/gcode.c   ****     while (*p_pos != '\0') {
 386:app/gcode.c   ****         /* 跳过空白 */
 387:app/gcode.c   ****         p_pos = skip_whitespace(p_pos);
 388:app/gcode.c   ****         
 389:app/gcode.c   ****         /* 检查行尾或注释 */
 390:app/gcode.c   ****         if ((*p_pos == '\0') || (*p_pos == '\n') || 
 391:app/gcode.c   ****             (*p_pos == '\r') || (*p_pos == ';')) {
 392:app/gcode.c   ****             break;
 393:app/gcode.c   ****         }
 394:app/gcode.c   ****         
 395:app/gcode.c   ****         /* 获取参数字母 */
 396:app/gcode.c   ****         param_char = (char)toupper((unsigned char)*p_pos);
 397:app/gcode.c   ****         p_pos++;
 398:app/gcode.c   ****         
 399:app/gcode.c   ****         /* 解析参数值 */
 400:app/gcode.c   ****         if (parse_float(p_pos, &value, &p_pos) != 0) {
 401:app/gcode.c   ****             /* 某些参数可能没有值 (如 G28 X Y Z) */
 402:app/gcode.c   ****             /* 对于 G28，X/Y/Z 参数不需要值 */
 403:app/gcode.c   ****             if ((p_cmd->cmd == 'G') && (p_cmd->code == 28)) {
 404:app/gcode.c   ****                 value = 0.0f;
 405:app/gcode.c   ****             } else {
 406:app/gcode.c   ****                 /* 跳过无效参数 */
 407:app/gcode.c   ****                 continue;
 408:app/gcode.c   ****             }
 409:app/gcode.c   ****         }
 410:app/gcode.c   ****         
 411:app/gcode.c   ****         /* 存储参数值 */
 412:app/gcode.c   ****         switch (param_char) {
ARM GAS  /tmp/ccqT8DeC.s 			page 11


 413:app/gcode.c   ****             case 'X':
 414:app/gcode.c   ****                 p_cmd->x = value;
 415:app/gcode.c   ****                 p_cmd->has_x = 1;
 416:app/gcode.c   ****                 break;
 417:app/gcode.c   ****             case 'Y':
 418:app/gcode.c   ****                 p_cmd->y = value;
 419:app/gcode.c   ****                 p_cmd->has_y = 1;
 420:app/gcode.c   ****                 break;
 421:app/gcode.c   ****             case 'Z':
 422:app/gcode.c   ****                 p_cmd->z = value;
 423:app/gcode.c   ****                 p_cmd->has_z = 1;
 424:app/gcode.c   ****                 break;
 425:app/gcode.c   ****             case 'E':
 426:app/gcode.c   ****                 p_cmd->e = value;
 427:app/gcode.c   ****                 p_cmd->has_e = 1;
 428:app/gcode.c   ****                 break;
 429:app/gcode.c   ****             case 'F':
 430:app/gcode.c   ****                 p_cmd->f = value;
 431:app/gcode.c   ****                 p_cmd->has_f = 1;
 432:app/gcode.c   ****                 break;
 433:app/gcode.c   ****             case 'S':
 434:app/gcode.c   ****                 p_cmd->s = value;
 435:app/gcode.c   ****                 p_cmd->has_s = 1;
 436:app/gcode.c   ****                 break;
 437:app/gcode.c   ****             default:
 438:app/gcode.c   ****                 /* 忽略未知参数 */
 439:app/gcode.c   ****                 break;
 440:app/gcode.c   ****         }
 441:app/gcode.c   ****     }
 442:app/gcode.c   ****     
 443:app/gcode.c   ****     return GCODE_OK;
 444:app/gcode.c   **** }
 445:app/gcode.c   **** 
 446:app/gcode.c   **** /**
 447:app/gcode.c   ****  * @brief   检查是否为支持的 G-code 命令
 448:app/gcode.c   ****  * @param   cmd     命令字母 (G/M)
 449:app/gcode.c   ****  * @param   code    命令编号
 450:app/gcode.c   ****  * @retval  1 支持，0 不支持
 451:app/gcode.c   ****  */
 452:app/gcode.c   **** static int
 453:app/gcode.c   **** is_supported_gcode(char cmd, int code)
 454:app/gcode.c   **** {
 455:app/gcode.c   ****     if (cmd == 'G') {
 149              		.loc 1 455 8 is_stmt 0 view .LVU40
 150 0068 472F     		cmp	r7, #71
 151              	.LBE75:
 152              	.LBE74:
 153              	.LBB81:
 154              	.LBB69:
 352:app/gcode.c   ****     p_cmd->code = code;
 155              		.loc 1 352 16 view .LVU41
 156 006a 0F70     		strb	r7, [r1]
 353:app/gcode.c   ****     p_cmd->code = code;
 157              		.loc 1 353 5 is_stmt 1 view .LVU42
 353:app/gcode.c   ****     p_cmd->code = code;
 158              		.loc 1 353 17 is_stmt 0 view .LVU43
 159 006c C1F80480 		str	r8, [r1, #4]
ARM GAS  /tmp/ccqT8DeC.s 			page 12


 355:app/gcode.c   **** }
 160              		.loc 1 355 5 is_stmt 1 view .LVU44
 161              	.LVL13:
 355:app/gcode.c   **** }
 162              		.loc 1 355 5 is_stmt 0 view .LVU45
 163              	.LBE69:
 164              	.LBE81:
 185:app/gcode.c   ****         return ret;
 165              		.loc 1 185 5 is_stmt 1 view .LVU46
 190:app/gcode.c   ****         return GCODE_ERR_UNKNOWN;
 166              		.loc 1 190 5 view .LVU47
 167              	.LBB82:
 168              	.LBI74:
 453:app/gcode.c   **** {
 169              		.loc 1 453 1 view .LVU48
 170              	.LBB76:
 171              		.loc 1 455 5 view .LVU49
 172              		.loc 1 455 8 is_stmt 0 view .LVU50
 173 0070 00F03E81 		beq	.L113
 456:app/gcode.c   ****         switch (code) {
 457:app/gcode.c   ****             case 0:     /* G0: 快速移动 */
 458:app/gcode.c   ****             case 1:     /* G1: 直线插补 */
 459:app/gcode.c   ****             case 28:    /* G28: 归零 */
 460:app/gcode.c   ****             case 90:    /* G90: 绝对坐标 */
 461:app/gcode.c   ****             case 91:    /* G91: 相对坐标 */
 462:app/gcode.c   ****                 return 1;
 463:app/gcode.c   ****             default:
 464:app/gcode.c   ****                 return 0;
 465:app/gcode.c   ****         }
 466:app/gcode.c   ****     } else if (cmd == 'M') {
 174              		.loc 1 466 12 is_stmt 1 view .LVU51
 175              		.loc 1 466 15 is_stmt 0 view .LVU52
 176 0074 4D2F     		cmp	r7, #77
 177 0076 77D0     		beq	.L114
 178              	.LVL14:
 179              	.L52:
 180              		.loc 1 466 15 view .LVU53
 181              	.LBE76:
 182              	.LBE82:
 191:app/gcode.c   ****     }
 183              		.loc 1 191 16 view .LVU54
 184 0078 6FF00500 		mvn	r0, #5
 185              	.LVL15:
 186              	.L1:
 201:app/gcode.c   **** 
 187              		.loc 1 201 1 view .LVU55
 188 007c BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 189              	.L3:
 174:app/gcode.c   ****         return GCODE_ERR_EMPTY;
 190              		.loc 1 174 8 view .LVU56
 191 0080 42F20140 		movw	r0, #9217
 192 0084 F840     		lsrs	r0, r0, r7
 193 0086 C007     		lsls	r0, r0, #31
 194 0088 CAD5     		bpl	.L5
 175:app/gcode.c   ****     }
 195              		.loc 1 175 16 view .LVU57
 196 008a 6FF00100 		mvn	r0, #1
ARM GAS  /tmp/ccqT8DeC.s 			page 13


 197 008e F5E7     		b	.L1
 198              	.LVL16:
 199              	.L7:
 200              	.LBB83:
 201              	.LBB70:
 343:app/gcode.c   ****     
 202              		.loc 1 343 5 is_stmt 1 view .LVU58
 346:app/gcode.c   ****         code = code * 10 + (*p_pos - '0');
 203              		.loc 1 346 13 is_stmt 0 view .LVU59
 204 0090 5878     		ldrb	r0, [r3, #1]	@ zero_extendqisi2
 346:app/gcode.c   ****         code = code * 10 + (*p_pos - '0');
 205              		.loc 1 346 28 view .LVU60
 206 0092 3038     		subs	r0, r0, #48
 346:app/gcode.c   ****         code = code * 10 + (*p_pos - '0');
 207              		.loc 1 346 11 view .LVU61
 208 0094 C4B2     		uxtb	r4, r0
 209 0096 092C     		cmp	r4, #9
 343:app/gcode.c   ****     
 210              		.loc 1 343 10 view .LVU62
 211 0098 03F10103 		add	r3, r3, #1
 212              	.LVL17:
 346:app/gcode.c   ****         code = code * 10 + (*p_pos - '0');
 213              		.loc 1 346 5 is_stmt 1 view .LVU63
 346:app/gcode.c   ****         code = code * 10 + (*p_pos - '0');
 214              		.loc 1 346 11 view .LVU64
 215 009c D7D9     		bls	.L46
 352:app/gcode.c   ****     p_cmd->code = code;
 216              		.loc 1 352 5 view .LVU65
 353:app/gcode.c   ****     
 217              		.loc 1 353 17 is_stmt 0 view .LVU66
 218 009e 0023     		movs	r3, #0
 219              	.LVL18:
 352:app/gcode.c   ****     p_cmd->code = code;
 220              		.loc 1 352 16 view .LVU67
 221 00a0 0F70     		strb	r7, [r1]
 353:app/gcode.c   ****     
 222              		.loc 1 353 5 is_stmt 1 view .LVU68
 353:app/gcode.c   ****     
 223              		.loc 1 353 17 is_stmt 0 view .LVU69
 224 00a2 4B60     		str	r3, [r1, #4]
 355:app/gcode.c   **** }
 225              		.loc 1 355 5 is_stmt 1 view .LVU70
 226              	.LVL19:
 355:app/gcode.c   **** }
 227              		.loc 1 355 5 is_stmt 0 view .LVU71
 228              	.LBE70:
 229              	.LBE83:
 185:app/gcode.c   ****         return ret;
 230              		.loc 1 185 5 is_stmt 1 view .LVU72
 190:app/gcode.c   ****         return GCODE_ERR_UNKNOWN;
 231              		.loc 1 190 5 view .LVU73
 232              	.LBB84:
 453:app/gcode.c   **** {
 233              		.loc 1 453 1 view .LVU74
 234              	.LBB77:
 455:app/gcode.c   ****         switch (code) {
 235              		.loc 1 455 5 view .LVU75
ARM GAS  /tmp/ccqT8DeC.s 			page 14


 236              	.LBE77:
 237              	.LBE84:
 238              	.LBB85:
 239              	.LBB71:
 333:app/gcode.c   ****     
 240              		.loc 1 333 9 is_stmt 0 view .LVU76
 241 00a4 9846     		mov	r8, r3
 242              	.LVL20:
 243              	.L84:
 333:app/gcode.c   ****     
 244              		.loc 1 333 9 view .LVU77
 245 00a6 9646     		mov	lr, r2
 246              	.LVL21:
 333:app/gcode.c   ****     
 247              		.loc 1 333 9 view .LVU78
 248              	.LBE71:
 249              	.LBE85:
 250              	.LBB86:
 251              	.LBB87:
 252              	.LBB88:
 253              	.LBB89:
 242:app/gcode.c   ****         str++;
 254              		.loc 1 242 11 is_stmt 1 view .LVU79
 242:app/gcode.c   ****         str++;
 255              		.loc 1 242 13 is_stmt 0 view .LVU80
 256 00a8 12F8013B 		ldrb	r3, [r2], #1	@ zero_extendqisi2
 257              	.LVL22:
 242:app/gcode.c   ****         str++;
 258              		.loc 1 242 11 view .LVU81
 259 00ac 202B     		cmp	r3, #32
 260 00ae FAD0     		beq	.L84
 242:app/gcode.c   ****         str++;
 261              		.loc 1 242 26 view .LVU82
 262 00b0 092B     		cmp	r3, #9
 263 00b2 F8D0     		beq	.L84
 245:app/gcode.c   **** }
 264              		.loc 1 245 5 is_stmt 1 view .LVU83
 265              	.LVL23:
 245:app/gcode.c   **** }
 266              		.loc 1 245 5 is_stmt 0 view .LVU84
 267              	.LBE89:
 268              	.LBE88:
 376:app/gcode.c   ****         (*p_pos == 'M') || (*p_pos == 'm')) {
 269              		.loc 1 376 5 is_stmt 1 view .LVU85
 376:app/gcode.c   ****         (*p_pos == 'M') || (*p_pos == 'm')) {
 270              		.loc 1 376 8 is_stmt 0 view .LVU86
 271 00b4 03F0DF02 		and	r2, r3, #223
 272 00b8 472A     		cmp	r2, #71
 273 00ba 73D0     		beq	.L16
 376:app/gcode.c   ****         (*p_pos == 'M') || (*p_pos == 'm')) {
 274              		.loc 1 376 44 view .LVU87
 275 00bc 4D2A     		cmp	r2, #77
 276 00be 71D0     		beq	.L16
 277              	.L18:
 385:app/gcode.c   ****         /* 跳过空白 */
 278              		.loc 1 385 11 is_stmt 1 view .LVU88
 279 00c0 002B     		cmp	r3, #0
ARM GAS  /tmp/ccqT8DeC.s 			page 15


 280 00c2 00F0A880 		beq	.L22
 281              	.LBB90:
 282              	.LBB91:
 289:app/gcode.c   ****             }
 283              		.loc 1 289 33 is_stmt 0 view .LVU89
 284 00c6 F2EE045A 		vmov.f32	s11, #1.0e+1
 285 00ca 01E0     		b	.L45
 286              	.LVL24:
 287              	.L20:
 289:app/gcode.c   ****             }
 288              		.loc 1 289 33 view .LVU90
 289              	.LBE91:
 290              	.LBE90:
 291              	.LBB97:
 292              	.LBB98:
 243:app/gcode.c   ****     }
 293              		.loc 1 243 9 is_stmt 1 view .LVU91
 242:app/gcode.c   ****         str++;
 294              		.loc 1 242 13 is_stmt 0 view .LVU92
 295 00cc 1EF8013F 		ldrb	r3, [lr, #1]!	@ zero_extendqisi2
 296              	.LVL25:
 297              	.L45:
 242:app/gcode.c   ****         str++;
 298              		.loc 1 242 11 is_stmt 1 view .LVU93
 299 00d0 202B     		cmp	r3, #32
 300 00d2 FBD0     		beq	.L20
 242:app/gcode.c   ****         str++;
 301              		.loc 1 242 26 is_stmt 0 view .LVU94
 302 00d4 092B     		cmp	r3, #9
 303 00d6 F9D0     		beq	.L20
 245:app/gcode.c   **** }
 304              		.loc 1 245 5 is_stmt 1 view .LVU95
 305              	.LVL26:
 245:app/gcode.c   **** }
 306              		.loc 1 245 5 is_stmt 0 view .LVU96
 307              	.LBE98:
 308              	.LBE97:
 390:app/gcode.c   ****             (*p_pos == '\r') || (*p_pos == ';')) {
 309              		.loc 1 390 9 is_stmt 1 view .LVU97
 390:app/gcode.c   ****             (*p_pos == '\r') || (*p_pos == ';')) {
 310              		.loc 1 390 12 is_stmt 0 view .LVU98
 311 00d8 0D2B     		cmp	r3, #13
 312 00da 40F2F380 		bls	.L21
 391:app/gcode.c   ****             break;
 313              		.loc 1 391 30 view .LVU99
 314 00de 3B2B     		cmp	r3, #59
 315 00e0 00F09980 		beq	.L22
 316              	.L23:
 396:app/gcode.c   ****         p_pos++;
 317              		.loc 1 396 9 is_stmt 1 view .LVU100
 318              	.LBB99:
 396:app/gcode.c   ****         p_pos++;
 319              		.loc 1 396 28 view .LVU101
 320              	.LVL27:
 396:app/gcode.c   ****         p_pos++;
 321              		.loc 1 396 28 view .LVU102
 322 00e4 1BF80320 		ldrb	r2, [fp, r3]	@ zero_extendqisi2
ARM GAS  /tmp/ccqT8DeC.s 			page 16


 323 00e8 02F00302 		and	r2, r2, #3
 324 00ec 022A     		cmp	r2, #2
 325              	.LBE99:
 397:app/gcode.c   ****         
 326              		.loc 1 397 14 is_stmt 0 view .LVU103
 327 00ee 0EF1010C 		add	ip, lr, #1
 328              	.LBB100:
 396:app/gcode.c   ****         p_pos++;
 329              		.loc 1 396 28 view .LVU104
 330 00f2 08BF     		it	eq
 331 00f4 203B     		subeq	r3, r3, #32
 332              	.LVL28:
 396:app/gcode.c   ****         p_pos++;
 333              		.loc 1 396 28 view .LVU105
 334              	.LBE100:
 397:app/gcode.c   ****         
 335              		.loc 1 397 9 is_stmt 1 view .LVU106
 400:app/gcode.c   ****             /* 某些参数可能没有值 (如 G28 X Y Z) */
 336              		.loc 1 400 9 view .LVU107
 337              	.LBB101:
 338              	.LBI90:
 261:app/gcode.c   **** {
 339              		.loc 1 261 1 view .LVU108
 340              	.LBB94:
 263:app/gcode.c   ****     float fraction = 0.0f;
 341              		.loc 1 263 5 view .LVU109
 264:app/gcode.c   ****     float divisor = 10.0f;
 342              		.loc 1 264 5 view .LVU110
 265:app/gcode.c   ****     int negative = 0;
 343              		.loc 1 265 5 view .LVU111
 266:app/gcode.c   ****     int has_digits = 0;
 344              		.loc 1 266 5 view .LVU112
 267:app/gcode.c   ****     int in_fraction = 0;
 345              		.loc 1 267 5 view .LVU113
 268:app/gcode.c   ****     
 346              		.loc 1 268 5 view .LVU114
 271:app/gcode.c   ****     
 347              		.loc 1 271 5 view .LVU115
 348              	.LBB92:
 349              	.LBI92:
 240:app/gcode.c   **** {
 350              		.loc 1 240 1 view .LVU116
 351              	.LBB93:
 242:app/gcode.c   ****         str++;
 352              		.loc 1 242 5 view .LVU117
 353 00f6 6446     		mov	r4, ip
 354              	.LVL29:
 355              	.L85:
 242:app/gcode.c   ****         str++;
 356              		.loc 1 242 13 is_stmt 0 view .LVU118
 357 00f8 2078     		ldrb	r0, [r4]	@ zero_extendqisi2
 242:app/gcode.c   ****         str++;
 358              		.loc 1 242 11 view .LVU119
 359 00fa 2028     		cmp	r0, #32
 360 00fc 2246     		mov	r2, r4
 361              	.LVL30:
 242:app/gcode.c   ****         str++;
ARM GAS  /tmp/ccqT8DeC.s 			page 17


 362              		.loc 1 242 11 is_stmt 1 view .LVU120
 363 00fe 04F10104 		add	r4, r4, #1
 364 0102 F9D0     		beq	.L85
 242:app/gcode.c   ****         str++;
 365              		.loc 1 242 26 is_stmt 0 view .LVU121
 366 0104 0928     		cmp	r0, #9
 367 0106 F7D0     		beq	.L85
 245:app/gcode.c   **** }
 368              		.loc 1 245 5 is_stmt 1 view .LVU122
 369              	.LVL31:
 245:app/gcode.c   **** }
 370              		.loc 1 245 5 is_stmt 0 view .LVU123
 371              	.LBE93:
 372              	.LBE92:
 274:app/gcode.c   ****         negative = 1;
 373              		.loc 1 274 5 is_stmt 1 view .LVU124
 274:app/gcode.c   ****         negative = 1;
 374              		.loc 1 274 8 is_stmt 0 view .LVU125
 375 0108 2D28     		cmp	r0, #45
 376 010a 00F0EC80 		beq	.L115
 277:app/gcode.c   ****         str++;
 377              		.loc 1 277 12 is_stmt 1 view .LVU126
 277:app/gcode.c   ****         str++;
 378              		.loc 1 277 15 is_stmt 0 view .LVU127
 379 010e 2B28     		cmp	r0, #43
 278:app/gcode.c   ****     }
 380              		.loc 1 278 9 is_stmt 1 view .LVU128
 381              	.LVL32:
 283:app/gcode.c   ****             has_digits = 1;
 382              		.loc 1 283 14 is_stmt 0 view .LVU129
 383 0110 08BF     		it	eq
 384 0112 5078     		ldrbeq	r0, [r2, #1]	@ zero_extendqisi2
 266:app/gcode.c   ****     int has_digits = 0;
 385              		.loc 1 266 9 view .LVU130
 386 0114 4FF00009 		mov	r9, #0
 278:app/gcode.c   ****     }
 387              		.loc 1 278 12 view .LVU131
 388 0118 08BF     		it	eq
 389 011a 2246     		moveq	r2, r4
 390              	.LVL33:
 391              	.L28:
 284:app/gcode.c   ****             if (in_fraction) {
 392              		.loc 1 284 24 view .LVU132
 393 011c 9FED816A 		vldr.32	s12, .L118
 394 0120 0026     		movs	r6, #0
 395 0122 F0EE467A 		vmov.f32	s15, s12
 396 0126 0132     		adds	r2, r2, #1
 397 0128 B246     		mov	r10, r6
 398 012a F2EE046A 		vmov.f32	s13, #1.0e+1
 399 012e 0FE0     		b	.L29
 400              	.LVL34:
 401              	.L116:
 286:app/gcode.c   ****                 divisor *= 10.0f;
 402              		.loc 1 286 17 is_stmt 1 view .LVU133
 289:app/gcode.c   ****             }
 403              		.loc 1 289 17 view .LVU134
 285:app/gcode.c   ****                 fraction += (float)(*str - '0') / divisor;
ARM GAS  /tmp/ccqT8DeC.s 			page 18


 404              		.loc 1 285 16 is_stmt 0 view .LVU135
 405 0130 002E     		cmp	r6, #0
 406 0132 46D0     		beq	.L31
 286:app/gcode.c   ****                 divisor *= 10.0f;
 407              		.loc 1 286 29 view .LVU136
 408 0134 07EE104A 		vmov	s14, r4	@ int
 409 0138 B8EEC75A 		vcvt.f32.s32	s10, s14
 286:app/gcode.c   ****                 divisor *= 10.0f;
 410              		.loc 1 286 49 view .LVU137
 411 013c 85EE267A 		vdiv.f32	s14, s10, s13
 287:app/gcode.c   ****             } else {
 412              		.loc 1 287 25 view .LVU138
 413 0140 66EEA56A 		vmul.f32	s13, s13, s11
 414              	.LVL35:
 286:app/gcode.c   ****                 divisor *= 10.0f;
 415              		.loc 1 286 26 view .LVU139
 416 0144 36EE076A 		vadd.f32	s12, s12, s14
 417              	.LVL36:
 287:app/gcode.c   ****             } else {
 418              		.loc 1 287 17 is_stmt 1 view .LVU140
 419              	.L32:
 291:app/gcode.c   ****         } else if ((*str == '.') && (!in_fraction)) {
 420              		.loc 1 291 13 view .LVU141
 284:app/gcode.c   ****             if (in_fraction) {
 421              		.loc 1 284 24 is_stmt 0 view .LVU142
 422 0148 4FF0010A 		mov	r10, #1
 423              	.LVL37:
 424              	.L33:
 283:app/gcode.c   ****             has_digits = 1;
 425              		.loc 1 283 14 view .LVU143
 426 014c 12F8010B 		ldrb	r0, [r2], #1	@ zero_extendqisi2
 427              	.LVL38:
 428              	.L29:
 284:app/gcode.c   ****             if (in_fraction) {
 429              		.loc 1 284 13 is_stmt 1 view .LVU144
 285:app/gcode.c   ****                 fraction += (float)(*str - '0') / divisor;
 430              		.loc 1 285 13 view .LVU145
 292:app/gcode.c   ****             in_fraction = 1;
 431              		.loc 1 292 16 view .LVU146
 293:app/gcode.c   ****             str++;
 432              		.loc 1 293 13 view .LVU147
 294:app/gcode.c   ****         } else {
 433              		.loc 1 294 13 view .LVU148
 283:app/gcode.c   ****             has_digits = 1;
 434              		.loc 1 283 27 is_stmt 0 view .LVU149
 435 0150 A0F13004 		sub	r4, r0, #48
 283:app/gcode.c   ****             has_digits = 1;
 436              		.loc 1 283 12 view .LVU150
 437 0154 E5B2     		uxtb	r5, r4
 438 0156 092D     		cmp	r5, #9
 439 0158 02F1FF3E 		add	lr, r2, #-1
 440              	.LVL39:
 282:app/gcode.c   ****         if ((*str >= '0') && (*str <= '9')) {
 441              		.loc 1 282 5 is_stmt 1 view .LVU151
 283:app/gcode.c   ****             has_digits = 1;
 442              		.loc 1 283 9 view .LVU152
 283:app/gcode.c   ****             has_digits = 1;
ARM GAS  /tmp/ccqT8DeC.s 			page 19


 443              		.loc 1 283 12 is_stmt 0 view .LVU153
 444 015c E8D9     		bls	.L116
 292:app/gcode.c   ****             in_fraction = 1;
 445              		.loc 1 292 19 view .LVU154
 446 015e 2E28     		cmp	r0, #46
 447 0160 38D1     		bne	.L34
 292:app/gcode.c   ****             in_fraction = 1;
 448              		.loc 1 292 34 view .LVU155
 449 0162 BEBB     		cbnz	r6, .L34
 293:app/gcode.c   ****             str++;
 450              		.loc 1 293 25 view .LVU156
 451 0164 0126     		movs	r6, #1
 452              	.LVL40:
 293:app/gcode.c   ****             str++;
 453              		.loc 1 293 25 view .LVU157
 454 0166 F1E7     		b	.L33
 455              	.LVL41:
 456              	.L114:
 293:app/gcode.c   ****             str++;
 457              		.loc 1 293 25 view .LVU158
 458              	.LBE94:
 459              	.LBE101:
 460              	.LBE87:
 461              	.LBE86:
 462              	.LBB107:
 463              	.LBB78:
 467:app/gcode.c   ****         switch (code) {
 464              		.loc 1 467 9 is_stmt 1 view .LVU159
 465 0168 A8F16803 		sub	r3, r8, #104
 466 016c 0A2B     		cmp	r3, #10
 467 016e 83D8     		bhi	.L52
 468 0170 01A0     		adr	r0, .L14
 469 0172 50F823F0 		ldr	pc, [r0, r3, lsl #2]
 470 0176 00BF     		.p2align 2
 471              	.L14:
 472 0178 A7000000 		.word	.L84+1
 473 017c 79000000 		.word	.L52+1
 474 0180 A7000000 		.word	.L84+1
 475 0184 A7000000 		.word	.L84+1
 476 0188 79000000 		.word	.L52+1
 477 018c A7000000 		.word	.L84+1
 478 0190 79000000 		.word	.L52+1
 479 0194 79000000 		.word	.L52+1
 480 0198 79000000 		.word	.L52+1
 481 019c 79000000 		.word	.L52+1
 482 01a0 A7000000 		.word	.L84+1
 483              	.LVL42:
 484              		.p2align 1
 485              	.L16:
 486              		.loc 1 467 9 is_stmt 0 view .LVU160
 487              	.LBE78:
 488              	.LBE107:
 489              	.LBB108:
 490              	.LBB104:
 378:app/gcode.c   ****         while ((*p_pos >= '0') && (*p_pos <= '9')) {
 491              		.loc 1 378 9 is_stmt 1 view .LVU161
 379:app/gcode.c   ****             p_pos++;
ARM GAS  /tmp/ccqT8DeC.s 			page 20


 492              		.loc 1 379 17 is_stmt 0 view .LVU162
 493 01a4 9EF80130 		ldrb	r3, [lr, #1]	@ zero_extendqisi2
 379:app/gcode.c   ****             p_pos++;
 494              		.loc 1 379 15 view .LVU163
 495 01a8 A3F13002 		sub	r2, r3, #48
 496 01ac 092A     		cmp	r2, #9
 378:app/gcode.c   ****         while ((*p_pos >= '0') && (*p_pos <= '9')) {
 497              		.loc 1 378 14 view .LVU164
 498 01ae 0EF1010E 		add	lr, lr, #1
 499              	.LVL43:
 379:app/gcode.c   ****             p_pos++;
 500              		.loc 1 379 9 is_stmt 1 view .LVU165
 379:app/gcode.c   ****             p_pos++;
 501              		.loc 1 379 15 view .LVU166
 502 01b2 85D8     		bhi	.L18
 503              	.L19:
 380:app/gcode.c   ****         }
 504              		.loc 1 380 13 view .LVU167
 505              	.LVL44:
 379:app/gcode.c   ****             p_pos++;
 506              		.loc 1 379 15 view .LVU168
 379:app/gcode.c   ****             p_pos++;
 507              		.loc 1 379 17 is_stmt 0 view .LVU169
 508 01b4 1EF8013F 		ldrb	r3, [lr, #1]!	@ zero_extendqisi2
 509              	.LVL45:
 379:app/gcode.c   ****             p_pos++;
 510              		.loc 1 379 15 view .LVU170
 511 01b8 A3F13002 		sub	r2, r3, #48
 512 01bc 092A     		cmp	r2, #9
 513 01be F9D9     		bls	.L19
 514 01c0 7EE7     		b	.L18
 515              	.LVL46:
 516              	.L31:
 517              	.LBB102:
 518              	.LBB95:
 289:app/gcode.c   ****             }
 519              		.loc 1 289 33 view .LVU171
 520 01c2 27EEA57A 		vmul.f32	s14, s15, s11
 289:app/gcode.c   ****             }
 521              		.loc 1 289 43 view .LVU172
 522 01c6 07EE904A 		vmov	s15, r4	@ int
 523              	.LVL47:
 289:app/gcode.c   ****             }
 524              		.loc 1 289 43 view .LVU173
 525 01ca F8EEE77A 		vcvt.f32.s32	s15, s15
 289:app/gcode.c   ****             }
 526              		.loc 1 289 24 view .LVU174
 527 01ce 77EE877A 		vadd.f32	s15, s15, s14
 528              	.LVL48:
 289:app/gcode.c   ****             }
 529              		.loc 1 289 24 view .LVU175
 530 01d2 B9E7     		b	.L32
 531              	.LVL49:
 532              	.L34:
 301:app/gcode.c   ****         return -1;
 533              		.loc 1 301 5 is_stmt 1 view .LVU176
 301:app/gcode.c   ****         return -1;
ARM GAS  /tmp/ccqT8DeC.s 			page 21


 534              		.loc 1 301 8 is_stmt 0 view .LVU177
 535 01d4 BAF1000F 		cmp	r10, #0
 536 01d8 7CD0     		beq	.L35
 306:app/gcode.c   ****     
 537              		.loc 1 306 5 is_stmt 1 view .LVU178
 306:app/gcode.c   ****     
 538              		.loc 1 306 12 is_stmt 0 view .LVU179
 539 01da 76EE277A 		vadd.f32	s15, s12, s15
 540              	.LVL50:
 309:app/gcode.c   ****         result = -result;
 541              		.loc 1 309 5 is_stmt 1 view .LVU180
 309:app/gcode.c   ****         result = -result;
 542              		.loc 1 309 8 is_stmt 0 view .LVU181
 543 01de B9F1000F 		cmp	r9, #0
 544 01e2 01D0     		beq	.L36
 310:app/gcode.c   ****     }
 545              		.loc 1 310 9 is_stmt 1 view .LVU182
 310:app/gcode.c   ****     }
 546              		.loc 1 310 16 is_stmt 0 view .LVU183
 547 01e4 F1EE677A 		vneg.f32	s15, s15
 548              	.LVL51:
 549              	.L36:
 310:app/gcode.c   ****     }
 550              		.loc 1 310 16 view .LVU184
 551              	.LBE95:
 552              	.LBE102:
 412:app/gcode.c   ****             case 'X':
 553              		.loc 1 412 9 is_stmt 1 view .LVU185
 554 01e8 DBB2     		uxtb	r3, r3
 412:app/gcode.c   ****             case 'X':
 555              		.loc 1 412 9 is_stmt 0 view .LVU186
 556 01ea 453B     		subs	r3, r3, #69
 557              	.LVL52:
 412:app/gcode.c   ****             case 'X':
 558              		.loc 1 412 9 view .LVU187
 559 01ec 152B     		cmp	r3, #21
 560 01ee 0DD8     		bhi	.L37
 561 01f0 DFE803F0 		tbb	[pc, r3]
 562              	.L39:
 563 01f4 5A       		.byte	(.L44-.L39)/2
 564 01f5 4C       		.byte	(.L43-.L39)/2
 565 01f6 0C       		.byte	(.L37-.L39)/2
 566 01f7 0C       		.byte	(.L37-.L39)/2
 567 01f8 0C       		.byte	(.L37-.L39)/2
 568 01f9 0C       		.byte	(.L37-.L39)/2
 569 01fa 0C       		.byte	(.L37-.L39)/2
 570 01fb 0C       		.byte	(.L37-.L39)/2
 571 01fc 0C       		.byte	(.L37-.L39)/2
 572 01fd 0C       		.byte	(.L37-.L39)/2
 573 01fe 0C       		.byte	(.L37-.L39)/2
 574 01ff 0C       		.byte	(.L37-.L39)/2
 575 0200 0C       		.byte	(.L37-.L39)/2
 576 0201 0C       		.byte	(.L37-.L39)/2
 577 0202 3E       		.byte	(.L42-.L39)/2
 578 0203 0C       		.byte	(.L37-.L39)/2
 579 0204 0C       		.byte	(.L37-.L39)/2
 580 0205 0C       		.byte	(.L37-.L39)/2
ARM GAS  /tmp/ccqT8DeC.s 			page 22


 581 0206 0C       		.byte	(.L37-.L39)/2
 582 0207 30       		.byte	(.L41-.L39)/2
 583 0208 22       		.byte	(.L40-.L39)/2
 584 0209 14       		.byte	(.L38-.L39)/2
 585              	.LVL53:
 586              		.p2align 1
 587              	.L55:
 397:app/gcode.c   ****         
 588              		.loc 1 397 14 view .LVU188
 589 020a E646     		mov	lr, ip
 590              	.LVL54:
 591              	.L37:
 385:app/gcode.c   ****         /* 跳过空白 */
 592              		.loc 1 385 11 is_stmt 1 view .LVU189
 385:app/gcode.c   ****         /* 跳过空白 */
 593              		.loc 1 385 12 is_stmt 0 view .LVU190
 594 020c 9EF80030 		ldrb	r3, [lr]	@ zero_extendqisi2
 385:app/gcode.c   ****         /* 跳过空白 */
 595              		.loc 1 385 11 view .LVU191
 596 0210 002B     		cmp	r3, #0
 597 0212 7FF45DAF 		bne	.L45
 598              	.LVL55:
 599              	.L22:
 385:app/gcode.c   ****         /* 跳过空白 */
 600              		.loc 1 385 11 view .LVU192
 601              	.LBE104:
 602              	.LBE108:
 200:app/gcode.c   **** }
 603              		.loc 1 200 12 view .LVU193
 604 0216 0020     		movs	r0, #0
 605              	.L117:
 201:app/gcode.c   **** 
 606              		.loc 1 201 1 view .LVU194
 607 0218 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 608              	.LVL56:
 609              	.L38:
 610              	.LBB109:
 611              	.LBB105:
 422:app/gcode.c   ****                 p_cmd->has_z = 1;
 612              		.loc 1 422 17 is_stmt 1 view .LVU195
 423:app/gcode.c   ****                 break;
 613              		.loc 1 423 30 is_stmt 0 view .LVU196
 614 021c 91F82030 		ldrb	r3, [r1, #32]	@ zero_extendqisi2
 615              	.LVL57:
 422:app/gcode.c   ****                 p_cmd->has_z = 1;
 616              		.loc 1 422 26 view .LVU197
 617 0220 C1ED047A 		vstr.32	s15, [r1, #16]
 618              	.LVL58:
 423:app/gcode.c   ****                 break;
 619              		.loc 1 423 17 is_stmt 1 view .LVU198
 423:app/gcode.c   ****                 break;
 620              		.loc 1 423 30 is_stmt 0 view .LVU199
 621 0224 43F00403 		orr	r3, r3, #4
 622 0228 81F82030 		strb	r3, [r1, #32]
 424:app/gcode.c   ****             case 'E':
 623              		.loc 1 424 17 is_stmt 1 view .LVU200
 624              	.LVL59:
ARM GAS  /tmp/ccqT8DeC.s 			page 23


 385:app/gcode.c   ****         /* 跳过空白 */
 625              		.loc 1 385 11 view .LVU201
 385:app/gcode.c   ****         /* 跳过空白 */
 626              		.loc 1 385 12 is_stmt 0 view .LVU202
 627 022c 9EF80030 		ldrb	r3, [lr]	@ zero_extendqisi2
 385:app/gcode.c   ****         /* 跳过空白 */
 628              		.loc 1 385 11 view .LVU203
 629 0230 002B     		cmp	r3, #0
 630 0232 7FF44DAF 		bne	.L45
 631 0236 EEE7     		b	.L22
 632              	.LVL60:
 633              	.L40:
 418:app/gcode.c   ****                 p_cmd->has_y = 1;
 634              		.loc 1 418 17 is_stmt 1 view .LVU204
 419:app/gcode.c   ****                 break;
 635              		.loc 1 419 30 is_stmt 0 view .LVU205
 636 0238 91F82030 		ldrb	r3, [r1, #32]	@ zero_extendqisi2
 637              	.LVL61:
 418:app/gcode.c   ****                 p_cmd->has_y = 1;
 638              		.loc 1 418 26 view .LVU206
 639 023c C1ED037A 		vstr.32	s15, [r1, #12]
 640              	.LVL62:
 419:app/gcode.c   ****                 break;
 641              		.loc 1 419 17 is_stmt 1 view .LVU207
 419:app/gcode.c   ****                 break;
 642              		.loc 1 419 30 is_stmt 0 view .LVU208
 643 0240 43F00203 		orr	r3, r3, #2
 644 0244 81F82030 		strb	r3, [r1, #32]
 420:app/gcode.c   ****             case 'Z':
 645              		.loc 1 420 17 is_stmt 1 view .LVU209
 646              	.LVL63:
 385:app/gcode.c   ****         /* 跳过空白 */
 647              		.loc 1 385 11 view .LVU210
 385:app/gcode.c   ****         /* 跳过空白 */
 648              		.loc 1 385 12 is_stmt 0 view .LVU211
 649 0248 9EF80030 		ldrb	r3, [lr]	@ zero_extendqisi2
 385:app/gcode.c   ****         /* 跳过空白 */
 650              		.loc 1 385 11 view .LVU212
 651 024c 002B     		cmp	r3, #0
 652 024e 7FF43FAF 		bne	.L45
 653 0252 E0E7     		b	.L22
 654              	.LVL64:
 655              	.L41:
 414:app/gcode.c   ****                 p_cmd->has_x = 1;
 656              		.loc 1 414 17 is_stmt 1 view .LVU213
 415:app/gcode.c   ****                 break;
 657              		.loc 1 415 30 is_stmt 0 view .LVU214
 658 0254 91F82030 		ldrb	r3, [r1, #32]	@ zero_extendqisi2
 659              	.LVL65:
 414:app/gcode.c   ****                 p_cmd->has_x = 1;
 660              		.loc 1 414 26 view .LVU215
 661 0258 C1ED027A 		vstr.32	s15, [r1, #8]
 662              	.LVL66:
 415:app/gcode.c   ****                 break;
 663              		.loc 1 415 17 is_stmt 1 view .LVU216
 415:app/gcode.c   ****                 break;
 664              		.loc 1 415 30 is_stmt 0 view .LVU217
ARM GAS  /tmp/ccqT8DeC.s 			page 24


 665 025c 43F00103 		orr	r3, r3, #1
 666 0260 81F82030 		strb	r3, [r1, #32]
 416:app/gcode.c   ****             case 'Y':
 667              		.loc 1 416 17 is_stmt 1 view .LVU218
 668              	.LVL67:
 385:app/gcode.c   ****         /* 跳过空白 */
 669              		.loc 1 385 11 view .LVU219
 385:app/gcode.c   ****         /* 跳过空白 */
 670              		.loc 1 385 12 is_stmt 0 view .LVU220
 671 0264 9EF80030 		ldrb	r3, [lr]	@ zero_extendqisi2
 385:app/gcode.c   ****         /* 跳过空白 */
 672              		.loc 1 385 11 view .LVU221
 673 0268 002B     		cmp	r3, #0
 674 026a 7FF431AF 		bne	.L45
 675 026e D2E7     		b	.L22
 676              	.LVL68:
 677              	.L42:
 434:app/gcode.c   ****                 p_cmd->has_s = 1;
 678              		.loc 1 434 17 is_stmt 1 view .LVU222
 435:app/gcode.c   ****                 break;
 679              		.loc 1 435 30 is_stmt 0 view .LVU223
 680 0270 91F82030 		ldrb	r3, [r1, #32]	@ zero_extendqisi2
 681              	.LVL69:
 434:app/gcode.c   ****                 p_cmd->has_s = 1;
 682              		.loc 1 434 26 view .LVU224
 683 0274 C1ED077A 		vstr.32	s15, [r1, #28]
 684              	.LVL70:
 435:app/gcode.c   ****                 break;
 685              		.loc 1 435 17 is_stmt 1 view .LVU225
 435:app/gcode.c   ****                 break;
 686              		.loc 1 435 30 is_stmt 0 view .LVU226
 687 0278 43F02003 		orr	r3, r3, #32
 688 027c 81F82030 		strb	r3, [r1, #32]
 436:app/gcode.c   ****             default:
 689              		.loc 1 436 17 is_stmt 1 view .LVU227
 690              	.LVL71:
 385:app/gcode.c   ****         /* 跳过空白 */
 691              		.loc 1 385 11 view .LVU228
 385:app/gcode.c   ****         /* 跳过空白 */
 692              		.loc 1 385 12 is_stmt 0 view .LVU229
 693 0280 9EF80030 		ldrb	r3, [lr]	@ zero_extendqisi2
 385:app/gcode.c   ****         /* 跳过空白 */
 694              		.loc 1 385 11 view .LVU230
 695 0284 002B     		cmp	r3, #0
 696 0286 7FF423AF 		bne	.L45
 697 028a C4E7     		b	.L22
 698              	.LVL72:
 699              	.L43:
 430:app/gcode.c   ****                 p_cmd->has_f = 1;
 700              		.loc 1 430 17 is_stmt 1 view .LVU231
 431:app/gcode.c   ****                 break;
 701              		.loc 1 431 30 is_stmt 0 view .LVU232
 702 028c 91F82030 		ldrb	r3, [r1, #32]	@ zero_extendqisi2
 703              	.LVL73:
 430:app/gcode.c   ****                 p_cmd->has_f = 1;
 704              		.loc 1 430 26 view .LVU233
 705 0290 C1ED067A 		vstr.32	s15, [r1, #24]
ARM GAS  /tmp/ccqT8DeC.s 			page 25


 706              	.LVL74:
 431:app/gcode.c   ****                 break;
 707              		.loc 1 431 17 is_stmt 1 view .LVU234
 431:app/gcode.c   ****                 break;
 708              		.loc 1 431 30 is_stmt 0 view .LVU235
 709 0294 43F01003 		orr	r3, r3, #16
 710 0298 81F82030 		strb	r3, [r1, #32]
 432:app/gcode.c   ****             case 'S':
 711              		.loc 1 432 17 is_stmt 1 view .LVU236
 712              	.LVL75:
 385:app/gcode.c   ****         /* 跳过空白 */
 713              		.loc 1 385 11 view .LVU237
 385:app/gcode.c   ****         /* 跳过空白 */
 714              		.loc 1 385 12 is_stmt 0 view .LVU238
 715 029c 9EF80030 		ldrb	r3, [lr]	@ zero_extendqisi2
 385:app/gcode.c   ****         /* 跳过空白 */
 716              		.loc 1 385 11 view .LVU239
 717 02a0 002B     		cmp	r3, #0
 718 02a2 7FF415AF 		bne	.L45
 719 02a6 B6E7     		b	.L22
 720              	.LVL76:
 721              	.L44:
 426:app/gcode.c   ****                 p_cmd->has_e = 1;
 722              		.loc 1 426 17 is_stmt 1 view .LVU240
 427:app/gcode.c   ****                 break;
 723              		.loc 1 427 30 is_stmt 0 view .LVU241
 724 02a8 91F82030 		ldrb	r3, [r1, #32]	@ zero_extendqisi2
 725              	.LVL77:
 426:app/gcode.c   ****                 p_cmd->has_e = 1;
 726              		.loc 1 426 26 view .LVU242
 727 02ac C1ED057A 		vstr.32	s15, [r1, #20]
 728              	.LVL78:
 427:app/gcode.c   ****                 break;
 729              		.loc 1 427 17 is_stmt 1 view .LVU243
 427:app/gcode.c   ****                 break;
 730              		.loc 1 427 30 is_stmt 0 view .LVU244
 731 02b0 43F00803 		orr	r3, r3, #8
 732 02b4 81F82030 		strb	r3, [r1, #32]
 428:app/gcode.c   ****             case 'F':
 733              		.loc 1 428 17 is_stmt 1 view .LVU245
 734              	.LVL79:
 385:app/gcode.c   ****         /* 跳过空白 */
 735              		.loc 1 385 11 view .LVU246
 385:app/gcode.c   ****         /* 跳过空白 */
 736              		.loc 1 385 12 is_stmt 0 view .LVU247
 737 02b8 9EF80030 		ldrb	r3, [lr]	@ zero_extendqisi2
 385:app/gcode.c   ****         /* 跳过空白 */
 738              		.loc 1 385 11 view .LVU248
 739 02bc 002B     		cmp	r3, #0
 740 02be 7FF407AF 		bne	.L45
 741 02c2 A8E7     		b	.L22
 742              	.L21:
 390:app/gcode.c   ****             (*p_pos == '\r') || (*p_pos == ';')) {
 743              		.loc 1 390 12 view .LVU249
 744 02c4 42F20142 		movw	r2, #9217
 745 02c8 DA40     		lsrs	r2, r2, r3
 746 02ca D207     		lsls	r2, r2, #31
ARM GAS  /tmp/ccqT8DeC.s 			page 26


 747 02cc 7FF50AAF 		bpl	.L23
 748              	.LBE105:
 749              	.LBE109:
 200:app/gcode.c   **** }
 750              		.loc 1 200 12 view .LVU250
 751 02d0 0020     		movs	r0, #0
 752 02d2 A1E7     		b	.L117
 753              	.LVL80:
 754              	.L35:
 755              	.LBB110:
 756              	.LBB106:
 403:app/gcode.c   ****                 value = 0.0f;
 757              		.loc 1 403 13 is_stmt 1 view .LVU251
 403:app/gcode.c   ****                 value = 0.0f;
 758              		.loc 1 403 16 is_stmt 0 view .LVU252
 759 02d4 472F     		cmp	r7, #71
 760 02d6 98D1     		bne	.L55
 403:app/gcode.c   ****                 value = 0.0f;
 761              		.loc 1 403 37 view .LVU253
 762 02d8 B8F11C0F 		cmp	r8, #28
 763 02dc 95D1     		bne	.L55
 404:app/gcode.c   ****             } else {
 764              		.loc 1 404 23 view .LVU254
 765 02de DFED117A 		vldr.32	s15, .L118
 397:app/gcode.c   ****         
 766              		.loc 1 397 14 view .LVU255
 767 02e2 E646     		mov	lr, ip
 768 02e4 80E7     		b	.L36
 769              	.LVL81:
 770              	.L115:
 771              	.LBB103:
 772              	.LBB96:
 275:app/gcode.c   ****         str++;
 773              		.loc 1 275 9 is_stmt 1 view .LVU256
 276:app/gcode.c   ****     } else if (*str == '+') {
 774              		.loc 1 276 9 view .LVU257
 283:app/gcode.c   ****             has_digits = 1;
 775              		.loc 1 283 14 is_stmt 0 view .LVU258
 776 02e6 5078     		ldrb	r0, [r2, #1]	@ zero_extendqisi2
 275:app/gcode.c   ****         str++;
 777              		.loc 1 275 18 view .LVU259
 778 02e8 4FF00109 		mov	r9, #1
 276:app/gcode.c   ****     } else if (*str == '+') {
 779              		.loc 1 276 12 view .LVU260
 780 02ec 2246     		mov	r2, r4
 781 02ee 15E7     		b	.L28
 782              	.LVL82:
 783              	.L113:
 276:app/gcode.c   ****     } else if (*str == '+') {
 784              		.loc 1 276 12 view .LVU261
 785              	.LBE96:
 786              	.LBE103:
 787              	.LBE106:
 788              	.LBE110:
 789              	.LBB111:
 790              	.LBB79:
 456:app/gcode.c   ****             case 0:     /* G0: 快速移动 */
ARM GAS  /tmp/ccqT8DeC.s 			page 27


 791              		.loc 1 456 9 is_stmt 1 view .LVU262
 792 02f0 B8F11C0F 		cmp	r8, #28
 793 02f4 3FF4D7AE 		beq	.L84
 794 02f8 04DC     		bgt	.L12
 795 02fa B8F1010F 		cmp	r8, #1
 796 02fe 3FF7BBAE 		bgt	.L52
 797 0302 D0E6     		b	.L84
 798              	.L12:
 799 0304 A8F15A03 		sub	r3, r8, #90
 800 0308 012B     		cmp	r3, #1
 801 030a 3FF6B5AE 		bhi	.L52
 802 030e CAE6     		b	.L84
 803              	.LVL83:
 804              	.L112:
 456:app/gcode.c   ****             case 0:     /* G0: 快速移动 */
 805              		.loc 1 456 9 is_stmt 0 view .LVU263
 806              	.LBE79:
 807              	.LBE111:
 808              	.LBB112:
 809              	.LBB72:
 352:app/gcode.c   ****     p_cmd->code = code;
 810              		.loc 1 352 5 is_stmt 1 view .LVU264
 353:app/gcode.c   ****     
 811              		.loc 1 353 17 is_stmt 0 view .LVU265
 812 0310 0023     		movs	r3, #0
 813              	.LVL84:
 352:app/gcode.c   ****     p_cmd->code = code;
 814              		.loc 1 352 16 view .LVU266
 815 0312 0F70     		strb	r7, [r1]
 353:app/gcode.c   ****     
 816              		.loc 1 353 5 is_stmt 1 view .LVU267
 353:app/gcode.c   ****     
 817              		.loc 1 353 17 is_stmt 0 view .LVU268
 818 0314 4B60     		str	r3, [r1, #4]
 355:app/gcode.c   **** }
 819              		.loc 1 355 5 is_stmt 1 view .LVU269
 820              	.LVL85:
 355:app/gcode.c   **** }
 821              		.loc 1 355 5 is_stmt 0 view .LVU270
 822              	.LBE72:
 823              	.LBE112:
 185:app/gcode.c   ****         return ret;
 824              		.loc 1 185 5 is_stmt 1 view .LVU271
 190:app/gcode.c   ****         return GCODE_ERR_UNKNOWN;
 825              		.loc 1 190 5 view .LVU272
 826              	.LBB113:
 453:app/gcode.c   **** {
 827              		.loc 1 453 1 view .LVU273
 828              	.LBB80:
 455:app/gcode.c   ****         switch (code) {
 829              		.loc 1 455 5 view .LVU274
 466:app/gcode.c   ****         switch (code) {
 830              		.loc 1 466 12 view .LVU275
 831 0316 AFE6     		b	.L52
 832              	.LVL86:
 833              	.L110:
 466:app/gcode.c   ****         switch (code) {
ARM GAS  /tmp/ccqT8DeC.s 			page 28


 834              		.loc 1 466 12 is_stmt 0 view .LVU276
 835              	.LBE80:
 836              	.LBE113:
 180:app/gcode.c   ****     }
 837              		.loc 1 180 16 view .LVU277
 838 0318 6FF00200 		mvn	r0, #2
 839 031c AEE6     		b	.L1
 840              	.LVL87:
 841              	.L111:
 842              	.LBB114:
 843              	.LBB73:
 341:app/gcode.c   ****     }
 844              		.loc 1 341 16 view .LVU278
 845 031e 6FF00300 		mvn	r0, #3
 846 0322 ABE6     		b	.L1
 847              	.L119:
 848              		.align	2
 849              	.L118:
 850 0324 00000000 		.word	0
 851 0328 01000000 		.word	_ctype_+1
 852              	.LBE73:
 853              	.LBE114:
 854              		.cfi_endproc
 855              	.LFE34:
 857              		.section	.text.toolhead_move,"ax",%progbits
 858              		.align	1
 859              		.p2align 2,,3
 860              		.weak	toolhead_move
 861              		.syntax unified
 862              		.thumb
 863              		.thumb_func
 864              		.fpu fpv4-sp-d16
 866              	toolhead_move:
 867              	.LVL88:
 868              	.LFB0:
  59:app/gcode.c   ****     (void)x; (void)y; (void)z; (void)e; (void)speed;
 869              		.loc 1 59 1 is_stmt 1 view -0
 870              		.cfi_startproc
 871              		@ args = 0, pretend = 0, frame = 0
 872              		@ frame_needed = 0, uses_anonymous_args = 0
 873              		@ link register save eliminated.
  60:app/gcode.c   ****     return 0;  /* 默认返回成功 */
 874              		.loc 1 60 5 view .LVU280
  60:app/gcode.c   ****     return 0;  /* 默认返回成功 */
 875              		.loc 1 60 14 view .LVU281
  60:app/gcode.c   ****     return 0;  /* 默认返回成功 */
 876              		.loc 1 60 23 view .LVU282
  60:app/gcode.c   ****     return 0;  /* 默认返回成功 */
 877              		.loc 1 60 32 view .LVU283
  60:app/gcode.c   ****     return 0;  /* 默认返回成功 */
 878              		.loc 1 60 41 view .LVU284
  61:app/gcode.c   **** }
 879              		.loc 1 61 5 view .LVU285
  62:app/gcode.c   **** 
 880              		.loc 1 62 1 is_stmt 0 view .LVU286
 881 0000 0020     		movs	r0, #0
 882 0002 7047     		bx	lr
ARM GAS  /tmp/ccqT8DeC.s 			page 29


 883              		.cfi_endproc
 884              	.LFE0:
 886              		.section	.text.toolhead_home,"ax",%progbits
 887              		.align	1
 888              		.p2align 2,,3
 889              		.weak	toolhead_home
 890              		.syntax unified
 891              		.thumb
 892              		.thumb_func
 893              		.fpu fpv4-sp-d16
 895              	toolhead_home:
 896              	.LVL89:
 897              	.LFB1:
  65:app/gcode.c   ****     (void)axes_mask;
 898              		.loc 1 65 1 is_stmt 1 view -0
 899              		.cfi_startproc
 900              		@ args = 0, pretend = 0, frame = 0
 901              		@ frame_needed = 0, uses_anonymous_args = 0
 902              		@ link register save eliminated.
  66:app/gcode.c   ****     return 0;  /* 默认返回成功 */
 903              		.loc 1 66 5 view .LVU288
  67:app/gcode.c   **** }
 904              		.loc 1 67 5 view .LVU289
  68:app/gcode.c   **** 
 905              		.loc 1 68 1 is_stmt 0 view .LVU290
 906 0000 0020     		movs	r0, #0
 907              	.LVL90:
  68:app/gcode.c   **** 
 908              		.loc 1 68 1 view .LVU291
 909 0002 7047     		bx	lr
 910              		.cfi_endproc
 911              	.LFE1:
 913              		.section	.text.toolhead_get_position,"ax",%progbits
 914              		.align	1
 915              		.p2align 2,,3
 916              		.weak	toolhead_get_position
 917              		.syntax unified
 918              		.thumb
 919              		.thumb_func
 920              		.fpu fpv4-sp-d16
 922              	toolhead_get_position:
 923              	.LVL91:
 924              	.LFB2:
  71:app/gcode.c   ****     /* 默认返回内部跟踪的位置 */
 925              		.loc 1 71 1 is_stmt 1 view -0
 926              		.cfi_startproc
 927              		@ args = 0, pretend = 0, frame = 0
 928              		@ frame_needed = 0, uses_anonymous_args = 0
 929              		@ link register save eliminated.
  73:app/gcode.c   ****     if (p_y != NULL) { *p_y = s_pos_y; }
 930              		.loc 1 73 5 view .LVU293
  73:app/gcode.c   ****     if (p_y != NULL) { *p_y = s_pos_y; }
 931              		.loc 1 73 8 is_stmt 0 view .LVU294
 932 0000 A0B1     		cbz	r0, .L140
  73:app/gcode.c   ****     if (p_y != NULL) { *p_y = s_pos_y; }
 933              		.loc 1 73 24 is_stmt 1 discriminator 1 view .LVU295
  74:app/gcode.c   ****     if (p_z != NULL) { *p_z = s_pos_z; }
ARM GAS  /tmp/ccqT8DeC.s 			page 30


 934              		.loc 1 74 5 discriminator 1 view .LVU296
  71:app/gcode.c   ****     /* 默认返回内部跟踪的位置 */
 935              		.loc 1 71 1 is_stmt 0 discriminator 1 view .LVU297
 936 0002 10B4     		push	{r4}
 937              		.cfi_def_cfa_offset 4
 938              		.cfi_offset 4, -4
  73:app/gcode.c   ****     if (p_y != NULL) { *p_y = s_pos_y; }
 939              		.loc 1 73 29 discriminator 1 view .LVU298
 940 0004 104C     		ldr	r4, .L149
 941 0006 D4F800C0 		ldr	ip, [r4]	@ float
 942 000a C0F800C0 		str	ip, [r0]	@ float
  74:app/gcode.c   ****     if (p_z != NULL) { *p_z = s_pos_z; }
 943              		.loc 1 74 8 discriminator 1 view .LVU299
 944 000e 11B1     		cbz	r1, .L124
  74:app/gcode.c   ****     if (p_z != NULL) { *p_z = s_pos_z; }
 945              		.loc 1 74 24 is_stmt 1 discriminator 1 view .LVU300
  74:app/gcode.c   ****     if (p_z != NULL) { *p_z = s_pos_z; }
 946              		.loc 1 74 29 is_stmt 0 discriminator 1 view .LVU301
 947 0010 0E48     		ldr	r0, .L149+4
 948              	.LVL92:
  74:app/gcode.c   ****     if (p_z != NULL) { *p_z = s_pos_z; }
 949              		.loc 1 74 29 discriminator 1 view .LVU302
 950 0012 0068     		ldr	r0, [r0]	@ float
 951 0014 0860     		str	r0, [r1]	@ float
 952              	.L124:
  75:app/gcode.c   ****     if (p_e != NULL) { *p_e = s_pos_e; }
 953              		.loc 1 75 5 is_stmt 1 view .LVU303
  75:app/gcode.c   ****     if (p_e != NULL) { *p_e = s_pos_e; }
 954              		.loc 1 75 8 is_stmt 0 view .LVU304
 955 0016 12B1     		cbz	r2, .L125
  75:app/gcode.c   ****     if (p_e != NULL) { *p_e = s_pos_e; }
 956              		.loc 1 75 24 is_stmt 1 discriminator 1 view .LVU305
  75:app/gcode.c   ****     if (p_e != NULL) { *p_e = s_pos_e; }
 957              		.loc 1 75 29 is_stmt 0 discriminator 1 view .LVU306
 958 0018 0D49     		ldr	r1, .L149+8
 959              	.LVL93:
  75:app/gcode.c   ****     if (p_e != NULL) { *p_e = s_pos_e; }
 960              		.loc 1 75 29 discriminator 1 view .LVU307
 961 001a 0968     		ldr	r1, [r1]	@ float
 962 001c 1160     		str	r1, [r2]	@ float
 963              	.L125:
  76:app/gcode.c   **** }
 964              		.loc 1 76 5 is_stmt 1 view .LVU308
  76:app/gcode.c   **** }
 965              		.loc 1 76 8 is_stmt 0 view .LVU309
 966 001e 13B1     		cbz	r3, .L122
  76:app/gcode.c   **** }
 967              		.loc 1 76 24 is_stmt 1 discriminator 1 view .LVU310
  76:app/gcode.c   **** }
 968              		.loc 1 76 29 is_stmt 0 discriminator 1 view .LVU311
 969 0020 0C4A     		ldr	r2, .L149+12
 970              	.LVL94:
  76:app/gcode.c   **** }
 971              		.loc 1 76 29 discriminator 1 view .LVU312
 972 0022 1268     		ldr	r2, [r2]	@ float
 973 0024 1A60     		str	r2, [r3]	@ float
 974              	.L122:
ARM GAS  /tmp/ccqT8DeC.s 			page 31


  77:app/gcode.c   **** 
 975              		.loc 1 77 1 view .LVU313
 976 0026 5DF8044B 		ldr	r4, [sp], #4
 977              		.cfi_restore 4
 978              		.cfi_def_cfa_offset 0
 979 002a 7047     		bx	lr
 980              	.LVL95:
 981              	.L140:
  74:app/gcode.c   ****     if (p_z != NULL) { *p_z = s_pos_z; }
 982              		.loc 1 74 5 is_stmt 1 view .LVU314
  74:app/gcode.c   ****     if (p_z != NULL) { *p_z = s_pos_z; }
 983              		.loc 1 74 8 is_stmt 0 view .LVU315
 984 002c 11B1     		cbz	r1, .L142
  74:app/gcode.c   ****     if (p_z != NULL) { *p_z = s_pos_z; }
 985              		.loc 1 74 24 is_stmt 1 view .LVU316
  74:app/gcode.c   ****     if (p_z != NULL) { *p_z = s_pos_z; }
 986              		.loc 1 74 29 is_stmt 0 view .LVU317
 987 002e 0748     		ldr	r0, .L149+4
 988              	.LVL96:
  74:app/gcode.c   ****     if (p_z != NULL) { *p_z = s_pos_z; }
 989              		.loc 1 74 29 view .LVU318
 990 0030 0068     		ldr	r0, [r0]	@ float
 991 0032 0860     		str	r0, [r1]	@ float
 992              	.L142:
  75:app/gcode.c   ****     if (p_e != NULL) { *p_e = s_pos_e; }
 993              		.loc 1 75 5 is_stmt 1 view .LVU319
  75:app/gcode.c   ****     if (p_e != NULL) { *p_e = s_pos_e; }
 994              		.loc 1 75 8 is_stmt 0 view .LVU320
 995 0034 12B1     		cbz	r2, .L144
  75:app/gcode.c   ****     if (p_e != NULL) { *p_e = s_pos_e; }
 996              		.loc 1 75 24 is_stmt 1 view .LVU321
  75:app/gcode.c   ****     if (p_e != NULL) { *p_e = s_pos_e; }
 997              		.loc 1 75 29 is_stmt 0 view .LVU322
 998 0036 0649     		ldr	r1, .L149+8
 999              	.LVL97:
  75:app/gcode.c   ****     if (p_e != NULL) { *p_e = s_pos_e; }
 1000              		.loc 1 75 29 view .LVU323
 1001 0038 0968     		ldr	r1, [r1]	@ float
 1002 003a 1160     		str	r1, [r2]	@ float
 1003              	.L144:
  76:app/gcode.c   **** }
 1004              		.loc 1 76 5 is_stmt 1 view .LVU324
  76:app/gcode.c   **** }
 1005              		.loc 1 76 8 is_stmt 0 view .LVU325
 1006 003c 1BB1     		cbz	r3, .L146
  76:app/gcode.c   **** }
 1007              		.loc 1 76 24 is_stmt 1 view .LVU326
  76:app/gcode.c   **** }
 1008              		.loc 1 76 29 is_stmt 0 view .LVU327
 1009 003e 054A     		ldr	r2, .L149+12
 1010              	.LVL98:
  76:app/gcode.c   **** }
 1011              		.loc 1 76 29 view .LVU328
 1012 0040 1268     		ldr	r2, [r2]	@ float
 1013 0042 1A60     		str	r2, [r3]	@ float
 1014 0044 7047     		bx	lr
 1015              	.LVL99:
ARM GAS  /tmp/ccqT8DeC.s 			page 32


 1016              	.L146:
  76:app/gcode.c   **** }
 1017              		.loc 1 76 29 view .LVU329
 1018 0046 7047     		bx	lr
 1019              	.L150:
 1020              		.align	2
 1021              	.L149:
 1022 0048 00000000 		.word	.LANCHOR0
 1023 004c 00000000 		.word	.LANCHOR1
 1024 0050 00000000 		.word	.LANCHOR2
 1025 0054 00000000 		.word	.LANCHOR3
 1026              		.cfi_endproc
 1027              	.LFE2:
 1029              		.section	.text.toolhead_wait_moves,"ax",%progbits
 1030              		.align	1
 1031              		.p2align 2,,3
 1032              		.weak	toolhead_wait_moves
 1033              		.syntax unified
 1034              		.thumb
 1035              		.thumb_func
 1036              		.fpu fpv4-sp-d16
 1038              	toolhead_wait_moves:
 1039              	.LFB3:
  80:app/gcode.c   ****     /* 默认空实现 */
 1040              		.loc 1 80 1 is_stmt 1 view -0
 1041              		.cfi_startproc
 1042              		@ args = 0, pretend = 0, frame = 0
 1043              		@ frame_needed = 0, uses_anonymous_args = 0
 1044              		@ link register save eliminated.
  82:app/gcode.c   **** 
 1045              		.loc 1 82 1 view .LVU331
 1046 0000 7047     		bx	lr
 1047              		.cfi_endproc
 1048              	.LFE3:
 1050 0002 00BF     		.section	.text.heater_set_temp,"ax",%progbits
 1051              		.align	1
 1052              		.p2align 2,,3
 1053              		.weak	heater_set_temp
 1054              		.syntax unified
 1055              		.thumb
 1056              		.thumb_func
 1057              		.fpu fpv4-sp-d16
 1059              	heater_set_temp:
 1060              	.LVL100:
 1061              	.LFB4:
  86:app/gcode.c   ****     (void)id; (void)temp;
 1062              		.loc 1 86 1 view -0
 1063              		.cfi_startproc
 1064              		@ args = 0, pretend = 0, frame = 0
 1065              		@ frame_needed = 0, uses_anonymous_args = 0
 1066              		@ link register save eliminated.
  87:app/gcode.c   **** }
 1067              		.loc 1 87 5 view .LVU333
  87:app/gcode.c   **** }
 1068              		.loc 1 87 15 view .LVU334
  88:app/gcode.c   **** 
 1069              		.loc 1 88 1 is_stmt 0 view .LVU335
ARM GAS  /tmp/ccqT8DeC.s 			page 33


 1070 0000 7047     		bx	lr
 1071              		.cfi_endproc
 1072              	.LFE4:
 1074 0002 00BF     		.section	.text.heater_get_temp,"ax",%progbits
 1075              		.align	1
 1076              		.p2align 2,,3
 1077              		.weak	heater_get_temp
 1078              		.syntax unified
 1079              		.thumb
 1080              		.thumb_func
 1081              		.fpu fpv4-sp-d16
 1083              	heater_get_temp:
 1084              	.LVL101:
 1085              	.LFB5:
  91:app/gcode.c   ****     (void)id;
 1086              		.loc 1 91 1 is_stmt 1 view -0
 1087              		.cfi_startproc
 1088              		@ args = 0, pretend = 0, frame = 0
 1089              		@ frame_needed = 0, uses_anonymous_args = 0
 1090              		@ link register save eliminated.
  92:app/gcode.c   ****     return 0.0f;  /* 默认返回 0 */
 1091              		.loc 1 92 5 view .LVU337
  93:app/gcode.c   **** }
 1092              		.loc 1 93 5 view .LVU338
  94:app/gcode.c   **** 
 1093              		.loc 1 94 1 is_stmt 0 view .LVU339
 1094 0000 9FED010A 		vldr.32	s0, .L154
 1095 0004 7047     		bx	lr
 1096              	.L155:
 1097 0006 00BF     		.align	2
 1098              	.L154:
 1099 0008 00000000 		.word	0
 1100              		.cfi_endproc
 1101              	.LFE5:
 1103              		.section	.text.heater_get_target,"ax",%progbits
 1104              		.align	1
 1105              		.p2align 2,,3
 1106              		.weak	heater_get_target
 1107              		.syntax unified
 1108              		.thumb
 1109              		.thumb_func
 1110              		.fpu fpv4-sp-d16
 1112              	heater_get_target:
 1113              	.LFB39:
 1114              		.cfi_startproc
 1115              		@ args = 0, pretend = 0, frame = 0
 1116              		@ frame_needed = 0, uses_anonymous_args = 0
 1117              		@ link register save eliminated.
 1118 0000 9FED010A 		vldr.32	s0, .L157
 1119 0004 7047     		bx	lr
 1120              	.L158:
 1121 0006 00BF     		.align	2
 1122              	.L157:
 1123 0008 00000000 		.word	0
 1124              		.cfi_endproc
 1125              	.LFE39:
 1127              		.section	.text.heater_is_at_target,"ax",%progbits
ARM GAS  /tmp/ccqT8DeC.s 			page 34


 1128              		.align	1
 1129              		.p2align 2,,3
 1130              		.weak	heater_is_at_target
 1131              		.syntax unified
 1132              		.thumb
 1133              		.thumb_func
 1134              		.fpu fpv4-sp-d16
 1136              	heater_is_at_target:
 1137              	.LVL102:
 1138              	.LFB7:
 103:app/gcode.c   ****     (void)id;
 1139              		.loc 1 103 1 is_stmt 1 view -0
 1140              		.cfi_startproc
 1141              		@ args = 0, pretend = 0, frame = 0
 1142              		@ frame_needed = 0, uses_anonymous_args = 0
 1143              		@ link register save eliminated.
 104:app/gcode.c   ****     return 1;  /* 默认返回已达到目标 */
 1144              		.loc 1 104 5 view .LVU341
 105:app/gcode.c   **** }
 1145              		.loc 1 105 5 view .LVU342
 106:app/gcode.c   **** 
 1146              		.loc 1 106 1 is_stmt 0 view .LVU343
 1147 0000 0120     		movs	r0, #1
 1148              	.LVL103:
 106:app/gcode.c   **** 
 1149              		.loc 1 106 1 view .LVU344
 1150 0002 7047     		bx	lr
 1151              		.cfi_endproc
 1152              	.LFE7:
 1154              		.section	.text.fan_set_speed,"ax",%progbits
 1155              		.align	1
 1156              		.p2align 2,,3
 1157              		.weak	fan_set_speed
 1158              		.syntax unified
 1159              		.thumb
 1160              		.thumb_func
 1161              		.fpu fpv4-sp-d16
 1163              	fan_set_speed:
 1164              	.LFB37:
 1165              		.cfi_startproc
 1166              		@ args = 0, pretend = 0, frame = 0
 1167              		@ frame_needed = 0, uses_anonymous_args = 0
 1168              		@ link register save eliminated.
 1169 0000 7047     		bx	lr
 1170              		.cfi_endproc
 1171              	.LFE37:
 1173 0002 00BF     		.section	.text.fan_get_speed,"ax",%progbits
 1174              		.align	1
 1175              		.p2align 2,,3
 1176              		.weak	fan_get_speed
 1177              		.syntax unified
 1178              		.thumb
 1179              		.thumb_func
 1180              		.fpu fpv4-sp-d16
 1182              	fan_get_speed:
 1183              	.LFB41:
 1184              		.cfi_startproc
ARM GAS  /tmp/ccqT8DeC.s 			page 35


 1185              		@ args = 0, pretend = 0, frame = 0
 1186              		@ frame_needed = 0, uses_anonymous_args = 0
 1187              		@ link register save eliminated.
 1188 0000 9FED010A 		vldr.32	s0, .L162
 1189 0004 7047     		bx	lr
 1190              	.L163:
 1191 0006 00BF     		.align	2
 1192              	.L162:
 1193 0008 00000000 		.word	0
 1194              		.cfi_endproc
 1195              	.LFE41:
 1197              		.section	.text.gcode_init,"ax",%progbits
 1198              		.align	1
 1199              		.p2align 2,,3
 1200              		.global	gcode_init
 1201              		.syntax unified
 1202              		.thumb
 1203              		.thumb_func
 1204              		.fpu fpv4-sp-d16
 1206              	gcode_init:
 1207              	.LFB10:
 148:app/gcode.c   ****     /* 设置默认坐标模式为绝对模式 */
 1208              		.loc 1 148 1 is_stmt 1 view -0
 1209              		.cfi_startproc
 1210              		@ args = 0, pretend = 0, frame = 0
 1211              		@ frame_needed = 0, uses_anonymous_args = 0
 1212              		@ link register save eliminated.
 150:app/gcode.c   **** }
 1213              		.loc 1 150 5 view .LVU346
 150:app/gcode.c   **** }
 1214              		.loc 1 150 18 is_stmt 0 view .LVU347
 1215 0000 014B     		ldr	r3, .L165
 1216 0002 0022     		movs	r2, #0
 1217 0004 1A70     		strb	r2, [r3]
 151:app/gcode.c   **** 
 1218              		.loc 1 151 1 view .LVU348
 1219 0006 7047     		bx	lr
 1220              	.L166:
 1221              		.align	2
 1222              	.L165:
 1223 0008 00000000 		.word	.LANCHOR4
 1224              		.cfi_endproc
 1225              	.LFE10:
 1227              		.section	.text.gcode_parse_line,"ax",%progbits
 1228              		.align	1
 1229              		.p2align 2,,3
 1230              		.global	gcode_parse_line
 1231              		.syntax unified
 1232              		.thumb
 1233              		.thumb_func
 1234              		.fpu fpv4-sp-d16
 1236              	gcode_parse_line:
 1237              	.LVL104:
 1238              	.LFB11:
 158:app/gcode.c   ****     const char *p_pos;
 1239              		.loc 1 158 1 is_stmt 1 view -0
 1240              		.cfi_startproc
ARM GAS  /tmp/ccqT8DeC.s 			page 36


 1241              		@ args = 0, pretend = 0, frame = 0
 1242              		@ frame_needed = 0, uses_anonymous_args = 0
 159:app/gcode.c   ****     int ret;
 1243              		.loc 1 159 5 view .LVU350
 160:app/gcode.c   ****     
 1244              		.loc 1 160 5 view .LVU351
 163:app/gcode.c   ****         return GCODE_ERR_NULL;
 1245              		.loc 1 163 5 view .LVU352
 163:app/gcode.c   ****         return GCODE_ERR_NULL;
 1246              		.loc 1 163 8 is_stmt 0 view .LVU353
 1247 0000 70B1     		cbz	r0, .L167
 1248 0002 0B46     		mov	r3, r1
 163:app/gcode.c   ****         return GCODE_ERR_NULL;
 1249              		.loc 1 163 24 discriminator 1 view .LVU354
 1250 0004 61B1     		cbz	r1, .L167
 158:app/gcode.c   ****     const char *p_pos;
 1251              		.loc 1 158 1 view .LVU355
 1252 0006 10B5     		push	{r4, lr}
 1253              		.cfi_def_cfa_offset 8
 1254              		.cfi_offset 4, -8
 1255              		.cfi_offset 14, -4
 1256              	.LBB119:
 1257              	.LBB120:
 1258              	.LBB121:
 228:app/gcode.c   ****     }
 1259              		.loc 1 228 9 view .LVU356
 1260 0008 0021     		movs	r1, #0
 1261              	.LVL105:
 228:app/gcode.c   ****     }
 1262              		.loc 1 228 9 view .LVU357
 1263 000a 0446     		mov	r4, r0
 1264              	.LBE121:
 1265              	.LBE120:
 1266              	.LBE119:
 168:app/gcode.c   ****     
 1267              		.loc 1 168 5 is_stmt 1 view .LVU358
 1268              	.LVL106:
 1269              	.LBB124:
 1270              	.LBI119:
 225:app/gcode.c   **** {
 1271              		.loc 1 225 1 view .LVU359
 1272              	.LBE124:
 227:app/gcode.c   ****         memset(p_cmd, 0, sizeof(gcode_cmd_t));
 1273              		.loc 1 227 5 view .LVU360
 1274              	.LBB125:
 1275              	.LBB123:
 1276              	.LBI120:
 225:app/gcode.c   **** {
 1277              		.loc 1 225 1 view .LVU361
 1278              	.LBB122:
 228:app/gcode.c   ****     }
 1279              		.loc 1 228 9 view .LVU362
 1280 000c 2422     		movs	r2, #36
 1281 000e 1846     		mov	r0, r3
 1282              	.LVL107:
 228:app/gcode.c   ****     }
 1283              		.loc 1 228 9 is_stmt 0 view .LVU363
ARM GAS  /tmp/ccqT8DeC.s 			page 37


 1284 0010 FFF7FEFF 		bl	memset
 1285              	.LVL108:
 228:app/gcode.c   ****     }
 1286              		.loc 1 228 9 view .LVU364
 1287              	.LBE122:
 1288              	.LBE123:
 1289              	.LBE125:
 1290 0014 0146     		mov	r1, r0
 1291 0016 2046     		mov	r0, r4
 201:app/gcode.c   **** 
 1292              		.loc 1 201 1 view .LVU365
 1293 0018 BDE81040 		pop	{r4, lr}
 1294              		.cfi_restore 14
 1295              		.cfi_restore 4
 1296              		.cfi_def_cfa_offset 0
 1297              	.LVL109:
 201:app/gcode.c   **** 
 1298              		.loc 1 201 1 view .LVU366
 1299 001c FFF7FEBF 		b	gcode_parse_line.part.0
 1300              	.LVL110:
 1301              	.L167:
 201:app/gcode.c   **** 
 1302              		.loc 1 201 1 view .LVU367
 1303 0020 4FF0FF30 		mov	r0, #-1
 1304              	.LVL111:
 201:app/gcode.c   **** 
 1305              		.loc 1 201 1 view .LVU368
 1306 0024 7047     		bx	lr
 1307              		.cfi_endproc
 1308              	.LFE11:
 1310 0026 00BF     		.section	.text.gcode_get_mode,"ax",%progbits
 1311              		.align	1
 1312              		.p2align 2,,3
 1313              		.global	gcode_get_mode
 1314              		.syntax unified
 1315              		.thumb
 1316              		.thumb_func
 1317              		.fpu fpv4-sp-d16
 1319              	gcode_get_mode:
 1320              	.LFB12:
 208:app/gcode.c   ****     return s_coord_mode;
 1321              		.loc 1 208 1 is_stmt 1 view -0
 1322              		.cfi_startproc
 1323              		@ args = 0, pretend = 0, frame = 0
 1324              		@ frame_needed = 0, uses_anonymous_args = 0
 1325              		@ link register save eliminated.
 209:app/gcode.c   **** }
 1326              		.loc 1 209 5 view .LVU370
 209:app/gcode.c   **** }
 1327              		.loc 1 209 12 is_stmt 0 view .LVU371
 1328 0000 014B     		ldr	r3, .L177
 210:app/gcode.c   **** 
 1329              		.loc 1 210 1 view .LVU372
 1330 0002 1878     		ldrb	r0, [r3]	@ zero_extendqisi2
 1331 0004 7047     		bx	lr
 1332              	.L178:
 1333 0006 00BF     		.align	2
ARM GAS  /tmp/ccqT8DeC.s 			page 38


 1334              	.L177:
 1335 0008 00000000 		.word	.LANCHOR4
 1336              		.cfi_endproc
 1337              	.LFE12:
 1339              		.section	.text.gcode_set_mode,"ax",%progbits
 1340              		.align	1
 1341              		.p2align 2,,3
 1342              		.global	gcode_set_mode
 1343              		.syntax unified
 1344              		.thumb
 1345              		.thumb_func
 1346              		.fpu fpv4-sp-d16
 1348              	gcode_set_mode:
 1349              	.LVL112:
 1350              	.LFB13:
 217:app/gcode.c   ****     s_coord_mode = mode;
 1351              		.loc 1 217 1 is_stmt 1 view -0
 1352              		.cfi_startproc
 1353              		@ args = 0, pretend = 0, frame = 0
 1354              		@ frame_needed = 0, uses_anonymous_args = 0
 1355              		@ link register save eliminated.
 218:app/gcode.c   **** }
 1356              		.loc 1 218 5 view .LVU374
 218:app/gcode.c   **** }
 1357              		.loc 1 218 18 is_stmt 0 view .LVU375
 1358 0000 014B     		ldr	r3, .L180
 1359 0002 1870     		strb	r0, [r3]
 219:app/gcode.c   **** 
 1360              		.loc 1 219 1 view .LVU376
 1361 0004 7047     		bx	lr
 1362              	.L181:
 1363 0006 00BF     		.align	2
 1364              	.L180:
 1365 0008 00000000 		.word	.LANCHOR4
 1366              		.cfi_endproc
 1367              	.LFE13:
 1369              		.section	.text.gcode_cmd_clear,"ax",%progbits
 1370              		.align	1
 1371              		.p2align 2,,3
 1372              		.global	gcode_cmd_clear
 1373              		.syntax unified
 1374              		.thumb
 1375              		.thumb_func
 1376              		.fpu fpv4-sp-d16
 1378              	gcode_cmd_clear:
 1379              	.LVL113:
 1380              	.LFB14:
 226:app/gcode.c   ****     if (p_cmd != NULL) {
 1381              		.loc 1 226 1 is_stmt 1 view -0
 1382              		.cfi_startproc
 1383              		@ args = 0, pretend = 0, frame = 0
 1384              		@ frame_needed = 0, uses_anonymous_args = 0
 1385              		@ link register save eliminated.
 227:app/gcode.c   ****         memset(p_cmd, 0, sizeof(gcode_cmd_t));
 1386              		.loc 1 227 5 view .LVU378
 227:app/gcode.c   ****         memset(p_cmd, 0, sizeof(gcode_cmd_t));
 1387              		.loc 1 227 8 is_stmt 0 view .LVU379
ARM GAS  /tmp/ccqT8DeC.s 			page 39


 1388 0000 18B1     		cbz	r0, .L182
 1389              	.LVL114:
 1390              	.LBB128:
 1391              	.LBI128:
 225:app/gcode.c   **** {
 1392              		.loc 1 225 1 is_stmt 1 view .LVU380
 1393              	.LBB129:
 228:app/gcode.c   ****     }
 1394              		.loc 1 228 9 view .LVU381
 1395 0002 2422     		movs	r2, #36
 1396 0004 0021     		movs	r1, #0
 1397 0006 FFF7FEBF 		b	memset
 1398              	.LVL115:
 1399              	.L182:
 228:app/gcode.c   ****     }
 1400              		.loc 1 228 9 is_stmt 0 view .LVU382
 1401              	.LBE129:
 1402              	.LBE128:
 230:app/gcode.c   **** 
 1403              		.loc 1 230 1 view .LVU383
 1404 000a 7047     		bx	lr
 1405              		.cfi_endproc
 1406              	.LFE14:
 1408              		.section	.rodata.gcode_execute.str1.4,"aMS",%progbits,1
 1409              		.align	2
 1410              	.LC0:
 1411 0000 583A252E 		.ascii	"X:%.2d.%02d Y:%.2d.%02d Z:%.2d.%02d E:%.2d.%02d\015"
 1411      32642E25 
 1411      30326420 
 1411      593A252E 
 1411      32642E25 
 1412 0030 0A00     		.ascii	"\012\000"
 1413              		.section	.text.gcode_execute,"ax",%progbits
 1414              		.align	1
 1415              		.p2align 2,,3
 1416              		.global	gcode_execute
 1417              		.syntax unified
 1418              		.thumb
 1419              		.thumb_func
 1420              		.fpu fpv4-sp-d16
 1422              	gcode_execute:
 1423              	.LVL116:
 1424              	.LFB29:
 468:app/gcode.c   ****             case 104:   /* M104: 设置热端温度 */
 469:app/gcode.c   ****             case 109:   /* M109: 等待热端温度 */
 470:app/gcode.c   ****             case 106:   /* M106: 设置风扇速度 */
 471:app/gcode.c   ****             case 107:   /* M107: 关闭风扇 */
 472:app/gcode.c   ****             case 114:   /* M114: 查询位置 */
 473:app/gcode.c   ****                 return 1;
 474:app/gcode.c   ****             default:
 475:app/gcode.c   ****                 return 0;
 476:app/gcode.c   ****         }
 477:app/gcode.c   ****     }
 478:app/gcode.c   ****     
 479:app/gcode.c   ****     return 0;
 480:app/gcode.c   **** }
 481:app/gcode.c   **** 
ARM GAS  /tmp/ccqT8DeC.s 			page 40


 482:app/gcode.c   **** /* ========== 命令执行函数 ========== */
 483:app/gcode.c   **** 
 484:app/gcode.c   **** /**
 485:app/gcode.c   ****  * @brief   处理 G0/G1 直线运动命令
 486:app/gcode.c   ****  * @param   p_cmd   命令结构体
 487:app/gcode.c   ****  * @retval  0 成功
 488:app/gcode.c   ****  * 
 489:app/gcode.c   ****  * @note    验收标准: 4.1.2 - 支持 G0/G1 (直线运动)
 490:app/gcode.c   ****  */
 491:app/gcode.c   **** static int
 492:app/gcode.c   **** execute_g0_g1(const gcode_cmd_t *p_cmd)
 493:app/gcode.c   **** {
 494:app/gcode.c   ****     float target_x, target_y, target_z, target_e;
 495:app/gcode.c   ****     float speed;
 496:app/gcode.c   ****     
 497:app/gcode.c   ****     /* 获取当前位置 */
 498:app/gcode.c   ****     toolhead_get_position(&target_x, &target_y, &target_z, &target_e);
 499:app/gcode.c   ****     
 500:app/gcode.c   ****     /* 计算目标位置 */
 501:app/gcode.c   ****     if (s_coord_mode == GCODE_MODE_ABSOLUTE) {
 502:app/gcode.c   ****         /* 绝对坐标模式 */
 503:app/gcode.c   ****         if (p_cmd->has_x) { target_x = p_cmd->x; }
 504:app/gcode.c   ****         if (p_cmd->has_y) { target_y = p_cmd->y; }
 505:app/gcode.c   ****         if (p_cmd->has_z) { target_z = p_cmd->z; }
 506:app/gcode.c   ****         if (p_cmd->has_e) { target_e = p_cmd->e; }
 507:app/gcode.c   ****     } else {
 508:app/gcode.c   ****         /* 相对坐标模式 */
 509:app/gcode.c   ****         if (p_cmd->has_x) { target_x += p_cmd->x; }
 510:app/gcode.c   ****         if (p_cmd->has_y) { target_y += p_cmd->y; }
 511:app/gcode.c   ****         if (p_cmd->has_z) { target_z += p_cmd->z; }
 512:app/gcode.c   ****         if (p_cmd->has_e) { target_e += p_cmd->e; }
 513:app/gcode.c   ****     }
 514:app/gcode.c   ****     
 515:app/gcode.c   ****     /* 更新进给速度 (F 参数单位是 mm/min) */
 516:app/gcode.c   ****     if (p_cmd->has_f) {
 517:app/gcode.c   ****         s_feedrate = p_cmd->f;
 518:app/gcode.c   ****     }
 519:app/gcode.c   ****     
 520:app/gcode.c   ****     /* 转换为 mm/s */
 521:app/gcode.c   ****     speed = s_feedrate / 60.0f;
 522:app/gcode.c   ****     
 523:app/gcode.c   ****     /* 执行运动 */
 524:app/gcode.c   ****     toolhead_move(target_x, target_y, target_z, target_e, speed);
 525:app/gcode.c   ****     
 526:app/gcode.c   ****     /* 更新内部位置跟踪 */
 527:app/gcode.c   ****     s_pos_x = target_x;
 528:app/gcode.c   ****     s_pos_y = target_y;
 529:app/gcode.c   ****     s_pos_z = target_z;
 530:app/gcode.c   ****     s_pos_e = target_e;
 531:app/gcode.c   ****     
 532:app/gcode.c   ****     return 0;
 533:app/gcode.c   **** }
 534:app/gcode.c   **** 
 535:app/gcode.c   **** /**
 536:app/gcode.c   ****  * @brief   处理 G28 归零命令
 537:app/gcode.c   ****  * @param   p_cmd   命令结构体
 538:app/gcode.c   ****  * @retval  0 成功
ARM GAS  /tmp/ccqT8DeC.s 			page 41


 539:app/gcode.c   ****  * 
 540:app/gcode.c   ****  * @note    验收标准: 4.1.3 - 支持 G28 (归零)
 541:app/gcode.c   ****  */
 542:app/gcode.c   **** static int
 543:app/gcode.c   **** execute_g28(const gcode_cmd_t *p_cmd)
 544:app/gcode.c   **** {
 545:app/gcode.c   ****     uint8_t axes_mask = 0;
 546:app/gcode.c   ****     
 547:app/gcode.c   ****     /* 确定要归零的轴 */
 548:app/gcode.c   ****     if (p_cmd->has_x) {
 549:app/gcode.c   ****         axes_mask |= HOME_X_AXIS;
 550:app/gcode.c   ****     }
 551:app/gcode.c   ****     if (p_cmd->has_y) {
 552:app/gcode.c   ****         axes_mask |= HOME_Y_AXIS;
 553:app/gcode.c   ****     }
 554:app/gcode.c   ****     if (p_cmd->has_z) {
 555:app/gcode.c   ****         axes_mask |= HOME_Z_AXIS;
 556:app/gcode.c   ****     }
 557:app/gcode.c   ****     
 558:app/gcode.c   ****     /* 如果没有指定轴，则归零所有轴 */
 559:app/gcode.c   ****     if (axes_mask == 0) {
 560:app/gcode.c   ****         axes_mask = HOME_X_AXIS | HOME_Y_AXIS | HOME_Z_AXIS;
 561:app/gcode.c   ****     }
 562:app/gcode.c   ****     
 563:app/gcode.c   ****     /* 执行归零 */
 564:app/gcode.c   ****     toolhead_home(axes_mask);
 565:app/gcode.c   ****     
 566:app/gcode.c   ****     /* 更新内部位置跟踪 */
 567:app/gcode.c   ****     if (axes_mask & HOME_X_AXIS) { s_pos_x = 0.0f; }
 568:app/gcode.c   ****     if (axes_mask & HOME_Y_AXIS) { s_pos_y = 0.0f; }
 569:app/gcode.c   ****     if (axes_mask & HOME_Z_AXIS) { s_pos_z = 0.0f; }
 570:app/gcode.c   ****     
 571:app/gcode.c   ****     return 0;
 572:app/gcode.c   **** }
 573:app/gcode.c   **** 
 574:app/gcode.c   **** /**
 575:app/gcode.c   ****  * @brief   处理 G90 绝对坐标模式命令
 576:app/gcode.c   ****  * @retval  0 成功
 577:app/gcode.c   ****  * 
 578:app/gcode.c   ****  * @note    验收标准: 4.1.4 - 支持 G90/G91 (坐标模式)
 579:app/gcode.c   ****  */
 580:app/gcode.c   **** static int
 581:app/gcode.c   **** execute_g90(void)
 582:app/gcode.c   **** {
 583:app/gcode.c   ****     s_coord_mode = GCODE_MODE_ABSOLUTE;
 584:app/gcode.c   ****     return 0;
 585:app/gcode.c   **** }
 586:app/gcode.c   **** 
 587:app/gcode.c   **** /**
 588:app/gcode.c   ****  * @brief   处理 G91 相对坐标模式命令
 589:app/gcode.c   ****  * @retval  0 成功
 590:app/gcode.c   ****  * 
 591:app/gcode.c   ****  * @note    验收标准: 4.1.4 - 支持 G90/G91 (坐标模式)
 592:app/gcode.c   ****  */
 593:app/gcode.c   **** static int
 594:app/gcode.c   **** execute_g91(void)
 595:app/gcode.c   **** {
ARM GAS  /tmp/ccqT8DeC.s 			page 42


 596:app/gcode.c   ****     s_coord_mode = GCODE_MODE_RELATIVE;
 597:app/gcode.c   ****     return 0;
 598:app/gcode.c   **** }
 599:app/gcode.c   **** 
 600:app/gcode.c   **** /**
 601:app/gcode.c   ****  * @brief   处理 M104 设置热端温度命令
 602:app/gcode.c   ****  * @param   p_cmd   命令结构体
 603:app/gcode.c   ****  * @retval  0 成功
 604:app/gcode.c   ****  * 
 605:app/gcode.c   ****  * @note    验收标准: 4.1.5 - 支持 M104/M109 (热端温度)
 606:app/gcode.c   ****  */
 607:app/gcode.c   **** static int
 608:app/gcode.c   **** execute_m104(const gcode_cmd_t *p_cmd)
 609:app/gcode.c   **** {
 610:app/gcode.c   ****     if (p_cmd->has_s) {
 611:app/gcode.c   ****         heater_set_temp(HEATER_HOTEND, p_cmd->s);
 612:app/gcode.c   ****     }
 613:app/gcode.c   ****     return 0;
 614:app/gcode.c   **** }
 615:app/gcode.c   **** 
 616:app/gcode.c   **** /**
 617:app/gcode.c   ****  * @brief   处理 M109 等待热端温度命令
 618:app/gcode.c   ****  * @param   p_cmd   命令结构体
 619:app/gcode.c   ****  * @retval  0 成功
 620:app/gcode.c   ****  * 
 621:app/gcode.c   ****  * @note    验收标准: 4.1.5 - 支持 M104/M109 (热端温度)
 622:app/gcode.c   ****  */
 623:app/gcode.c   **** static int
 624:app/gcode.c   **** execute_m109(const gcode_cmd_t *p_cmd)
 625:app/gcode.c   **** {
 626:app/gcode.c   ****     /* 先设置目标温度 */
 627:app/gcode.c   ****     if (p_cmd->has_s) {
 628:app/gcode.c   ****         heater_set_temp(HEATER_HOTEND, p_cmd->s);
 629:app/gcode.c   ****     }
 630:app/gcode.c   ****     
 631:app/gcode.c   ****     /* 等待温度达到目标 */
 632:app/gcode.c   ****     /* 注意: 在实际实现中，这应该是非阻塞的 */
 633:app/gcode.c   ****     /* 当前使用弱符号实现，直接返回 */
 634:app/gcode.c   ****     while (!heater_is_at_target(HEATER_HOTEND)) {
 635:app/gcode.c   ****         /* 在实际实现中，这里应该调用调度器 */
 636:app/gcode.c   ****         /* 并周期性检查温度 */
 637:app/gcode.c   ****         break;  /* 临时: 避免死循环 */
 638:app/gcode.c   ****     }
 639:app/gcode.c   ****     
 640:app/gcode.c   ****     return 0;
 641:app/gcode.c   **** }
 642:app/gcode.c   **** 
 643:app/gcode.c   **** /**
 644:app/gcode.c   ****  * @brief   处理 M106 设置风扇速度命令
 645:app/gcode.c   ****  * @param   p_cmd   命令结构体
 646:app/gcode.c   ****  * @retval  0 成功
 647:app/gcode.c   ****  * 
 648:app/gcode.c   ****  * @note    验收标准: 4.1.6 - 支持 M106/M107 (风扇)
 649:app/gcode.c   ****  */
 650:app/gcode.c   **** static int
 651:app/gcode.c   **** execute_m106(const gcode_cmd_t *p_cmd)
 652:app/gcode.c   **** {
ARM GAS  /tmp/ccqT8DeC.s 			page 43


 653:app/gcode.c   ****     float speed = 1.0f;  /* 默认全速 */
 654:app/gcode.c   ****     
 655:app/gcode.c   ****     if (p_cmd->has_s) {
 656:app/gcode.c   ****         /* S 参数范围 0-255，转换为 0.0-1.0 */
 657:app/gcode.c   ****         speed = p_cmd->s / 255.0f;
 658:app/gcode.c   ****         if (speed > 1.0f) {
 659:app/gcode.c   ****             speed = 1.0f;
 660:app/gcode.c   ****         } else if (speed < 0.0f) {
 661:app/gcode.c   ****             speed = 0.0f;
 662:app/gcode.c   ****         }
 663:app/gcode.c   ****     }
 664:app/gcode.c   ****     
 665:app/gcode.c   ****     fan_set_speed(FAN_PART, speed);
 666:app/gcode.c   ****     return 0;
 667:app/gcode.c   **** }
 668:app/gcode.c   **** 
 669:app/gcode.c   **** /**
 670:app/gcode.c   ****  * @brief   处理 M107 关闭风扇命令
 671:app/gcode.c   ****  * @retval  0 成功
 672:app/gcode.c   ****  * 
 673:app/gcode.c   ****  * @note    验收标准: 4.1.6 - 支持 M106/M107 (风扇)
 674:app/gcode.c   ****  */
 675:app/gcode.c   **** static int
 676:app/gcode.c   **** execute_m107(void)
 677:app/gcode.c   **** {
 678:app/gcode.c   ****     fan_set_speed(FAN_PART, 0.0f);
 679:app/gcode.c   ****     return 0;
 680:app/gcode.c   **** }
 681:app/gcode.c   **** 
 682:app/gcode.c   **** /**
 683:app/gcode.c   ****  * @brief   处理 M114 位置查询命令
 684:app/gcode.c   ****  * @retval  0 成功
 685:app/gcode.c   ****  * 
 686:app/gcode.c   ****  * @note    验收标准: 4.1.7 - 支持 M114 (位置查询)
 687:app/gcode.c   ****  */
 688:app/gcode.c   **** static int
 689:app/gcode.c   **** execute_m114(void)
 690:app/gcode.c   **** {
 691:app/gcode.c   ****     float x, y, z, e;
 692:app/gcode.c   ****     
 693:app/gcode.c   ****     /* 获取当前位置 */
 694:app/gcode.c   ****     toolhead_get_position(&x, &y, &z, &e);
 695:app/gcode.c   ****     
 696:app/gcode.c   ****     /* 输出位置信息 */
 697:app/gcode.c   ****     /* 格式: X:0.00 Y:0.00 Z:0.00 E:0.00 */
 698:app/gcode.c   **** #ifndef TEST_BUILD
 699:app/gcode.c   ****     serial_printf("X:%.2d.%02d Y:%.2d.%02d Z:%.2d.%02d E:%.2d.%02d\r\n",
 700:app/gcode.c   ****                   (int)x, (int)((x - (int)x) * 100),
 701:app/gcode.c   ****                   (int)y, (int)((y - (int)y) * 100),
 702:app/gcode.c   ****                   (int)z, (int)((z - (int)z) * 100),
 703:app/gcode.c   ****                   (int)e, (int)((e - (int)e) * 100));
 704:app/gcode.c   **** #endif
 705:app/gcode.c   ****     
 706:app/gcode.c   ****     return 0;
 707:app/gcode.c   **** }
 708:app/gcode.c   **** 
 709:app/gcode.c   **** /* ========== 公有函数实现 (命令执行) ========== */
ARM GAS  /tmp/ccqT8DeC.s 			page 44


 710:app/gcode.c   **** 
 711:app/gcode.c   **** /**
 712:app/gcode.c   ****  * @brief   执行 G-code 命令
 713:app/gcode.c   ****  */
 714:app/gcode.c   **** int
 715:app/gcode.c   **** gcode_execute(const gcode_cmd_t *p_cmd)
 716:app/gcode.c   **** {
 1425              		.loc 1 716 1 is_stmt 1 view -0
 1426              		.cfi_startproc
 1427              		@ args = 0, pretend = 0, frame = 16
 1428              		@ frame_needed = 0, uses_anonymous_args = 0
 717:app/gcode.c   ****     int ret = GCODE_OK;
 1429              		.loc 1 717 5 view .LVU385
 718:app/gcode.c   ****     
 719:app/gcode.c   ****     /* 参数检查 */
 720:app/gcode.c   ****     if (p_cmd == NULL) {
 1430              		.loc 1 720 5 view .LVU386
 1431              		.loc 1 720 8 is_stmt 0 view .LVU387
 1432 0000 0028     		cmp	r0, #0
 1433 0002 00F06D81 		beq	.L232
 716:app/gcode.c   ****     int ret = GCODE_OK;
 1434              		.loc 1 716 1 view .LVU388
 1435 0006 10B5     		push	{r4, lr}
 1436              		.cfi_def_cfa_offset 8
 1437              		.cfi_offset 4, -8
 1438              		.cfi_offset 14, -4
 721:app/gcode.c   ****         return GCODE_ERR_NULL;
 722:app/gcode.c   ****     }
 723:app/gcode.c   ****     
 724:app/gcode.c   ****     /* 根据命令类型分发 */
 725:app/gcode.c   ****     if (p_cmd->cmd == 'G') {
 1439              		.loc 1 725 14 view .LVU389
 1440 0008 0378     		ldrb	r3, [r0]	@ zero_extendqisi2
 1441              		.loc 1 725 8 view .LVU390
 1442 000a 472B     		cmp	r3, #71
 716:app/gcode.c   ****     int ret = GCODE_OK;
 1443              		.loc 1 716 1 view .LVU391
 1444 000c 8AB0     		sub	sp, sp, #40
 1445              		.cfi_def_cfa_offset 48
 1446 000e 0446     		mov	r4, r0
 1447              		.loc 1 725 5 is_stmt 1 view .LVU392
 1448              		.loc 1 725 8 is_stmt 0 view .LVU393
 1449 0010 0DD0     		beq	.L253
 726:app/gcode.c   ****         switch (p_cmd->code) {
 727:app/gcode.c   ****             case 0:     /* G0: 快速移动 */
 728:app/gcode.c   ****             case 1:     /* G1: 直线插补 */
 729:app/gcode.c   ****                 ret = execute_g0_g1(p_cmd);
 730:app/gcode.c   ****                 break;
 731:app/gcode.c   ****                 
 732:app/gcode.c   ****             case 28:    /* G28: 归零 */
 733:app/gcode.c   ****                 ret = execute_g28(p_cmd);
 734:app/gcode.c   ****                 break;
 735:app/gcode.c   ****                 
 736:app/gcode.c   ****             case 90:    /* G90: 绝对坐标 */
 737:app/gcode.c   ****                 ret = execute_g90();
 738:app/gcode.c   ****                 break;
 739:app/gcode.c   ****                 
ARM GAS  /tmp/ccqT8DeC.s 			page 45


 740:app/gcode.c   ****             case 91:    /* G91: 相对坐标 */
 741:app/gcode.c   ****                 ret = execute_g91();
 742:app/gcode.c   ****                 break;
 743:app/gcode.c   ****                 
 744:app/gcode.c   ****             default:
 745:app/gcode.c   ****                 ret = GCODE_ERR_UNKNOWN;
 746:app/gcode.c   ****                 break;
 747:app/gcode.c   ****         }
 748:app/gcode.c   ****     } else if (p_cmd->cmd == 'M') {
 1450              		.loc 1 748 12 is_stmt 1 view .LVU394
 1451              		.loc 1 748 15 is_stmt 0 view .LVU395
 1452 0012 4D2B     		cmp	r3, #77
 1453 0014 14D1     		bne	.L234
 749:app/gcode.c   ****         switch (p_cmd->code) {
 1454              		.loc 1 749 9 is_stmt 1 view .LVU396
 1455 0016 4368     		ldr	r3, [r0, #4]
 1456 0018 683B     		subs	r3, r3, #104
 1457 001a 0A2B     		cmp	r3, #10
 1458 001c 10D8     		bhi	.L234
 1459 001e DFE803F0 		tbb	[pc, r3]
 1460              	.L220:
 1461 0022 97       		.byte	(.L224-.L220)/2
 1462 0023 0F       		.byte	(.L234-.L220)/2
 1463 0024 78       		.byte	(.L223-.L220)/2
 1464 0025 8F       		.byte	(.L222-.L220)/2
 1465 0026 0F       		.byte	(.L234-.L220)/2
 1466 0027 9F       		.byte	(.L221-.L220)/2
 1467 0028 0F       		.byte	(.L234-.L220)/2
 1468 0029 0F       		.byte	(.L234-.L220)/2
 1469 002a 0F       		.byte	(.L234-.L220)/2
 1470 002b 0F       		.byte	(.L234-.L220)/2
 1471 002c AA       		.byte	(.L219-.L220)/2
 1472 002d 00       		.p2align 1
 1473              	.L253:
 726:app/gcode.c   ****         switch (p_cmd->code) {
 1474              		.loc 1 726 9 view .LVU397
 726:app/gcode.c   ****         switch (p_cmd->code) {
 1475              		.loc 1 726 22 is_stmt 0 view .LVU398
 1476 002e 4368     		ldr	r3, [r0, #4]
 726:app/gcode.c   ****         switch (p_cmd->code) {
 1477              		.loc 1 726 9 view .LVU399
 1478 0030 5A2B     		cmp	r3, #90
 1479 0032 00F0EC80 		beq	.L187
 1480 0036 24DC     		bgt	.L188
 1481 0038 012B     		cmp	r3, #1
 1482 003a 05DC     		bgt	.L189
 1483 003c 002B     		cmp	r3, #0
 1484 003e 27DA     		bge	.L190
 1485              	.L234:
 1486              		.loc 1 749 9 view .LVU400
 1487 0040 6FF00500 		mvn	r0, #5
 1488              	.LVL117:
 1489              	.L184:
 750:app/gcode.c   ****             case 104:   /* M104: 设置热端温度 */
 751:app/gcode.c   ****                 ret = execute_m104(p_cmd);
 752:app/gcode.c   ****                 break;
 753:app/gcode.c   ****                 
ARM GAS  /tmp/ccqT8DeC.s 			page 46


 754:app/gcode.c   ****             case 109:   /* M109: 等待热端温度 */
 755:app/gcode.c   ****                 ret = execute_m109(p_cmd);
 756:app/gcode.c   ****                 break;
 757:app/gcode.c   ****                 
 758:app/gcode.c   ****             case 106:   /* M106: 设置风扇速度 */
 759:app/gcode.c   ****                 ret = execute_m106(p_cmd);
 760:app/gcode.c   ****                 break;
 761:app/gcode.c   ****                 
 762:app/gcode.c   ****             case 107:   /* M107: 关闭风扇 */
 763:app/gcode.c   ****                 ret = execute_m107();
 764:app/gcode.c   ****                 break;
 765:app/gcode.c   ****                 
 766:app/gcode.c   ****             case 114:   /* M114: 查询位置 */
 767:app/gcode.c   ****                 ret = execute_m114();
 768:app/gcode.c   ****                 break;
 769:app/gcode.c   ****                 
 770:app/gcode.c   ****             default:
 771:app/gcode.c   ****                 ret = GCODE_ERR_UNKNOWN;
 772:app/gcode.c   ****                 break;
 773:app/gcode.c   ****         }
 774:app/gcode.c   ****     } else {
 775:app/gcode.c   ****         ret = GCODE_ERR_UNKNOWN;
 776:app/gcode.c   ****     }
 777:app/gcode.c   ****     
 778:app/gcode.c   ****     return ret;
 779:app/gcode.c   **** }
 1490              		.loc 1 779 1 view .LVU401
 1491 0044 0AB0     		add	sp, sp, #40
 1492              		.cfi_remember_state
 1493              		.cfi_def_cfa_offset 8
 1494              		@ sp needed
 1495 0046 10BD     		pop	{r4, pc}
 1496              	.LVL118:
 1497              	.L189:
 1498              		.cfi_restore_state
 726:app/gcode.c   ****             case 0:     /* G0: 快速移动 */
 1499              		.loc 1 726 9 view .LVU402
 1500 0048 1C2B     		cmp	r3, #28
 1501 004a F9D1     		bne	.L234
 733:app/gcode.c   ****                 break;
 1502              		.loc 1 733 17 is_stmt 1 view .LVU403
 1503              	.LVL119:
 1504              	.LBB148:
 1505              	.LBI148:
 543:app/gcode.c   **** {
 1506              		.loc 1 543 1 view .LVU404
 1507              	.LBB149:
 545:app/gcode.c   ****     
 1508              		.loc 1 545 5 view .LVU405
 548:app/gcode.c   ****         axes_mask |= HOME_X_AXIS;
 1509              		.loc 1 548 5 view .LVU406
 548:app/gcode.c   ****         axes_mask |= HOME_X_AXIS;
 1510              		.loc 1 548 9 is_stmt 0 view .LVU407
 1511 004c 90F82030 		ldrb	r3, [r0, #32]	@ zero_extendqisi2
 551:app/gcode.c   ****         axes_mask |= HOME_Y_AXIS;
 1512              		.loc 1 551 8 view .LVU408
 1513 0050 9A07     		lsls	r2, r3, #30
ARM GAS  /tmp/ccqT8DeC.s 			page 47


 548:app/gcode.c   ****         axes_mask |= HOME_X_AXIS;
 1514              		.loc 1 548 9 view .LVU409
 1515 0052 03F00104 		and	r4, r3, #1
 1516              	.LVL120:
 551:app/gcode.c   ****         axes_mask |= HOME_Y_AXIS;
 1517              		.loc 1 551 5 is_stmt 1 view .LVU410
 551:app/gcode.c   ****         axes_mask |= HOME_Y_AXIS;
 1518              		.loc 1 551 8 is_stmt 0 view .LVU411
 1519 0056 40F10281 		bpl	.L211
 552:app/gcode.c   ****     }
 1520              		.loc 1 552 9 is_stmt 1 view .LVU412
 554:app/gcode.c   ****         axes_mask |= HOME_Z_AXIS;
 1521              		.loc 1 554 8 is_stmt 0 view .LVU413
 1522 005a 5B07     		lsls	r3, r3, #29
 552:app/gcode.c   ****     }
 1523              		.loc 1 552 19 view .LVU414
 1524 005c 44F00200 		orr	r0, r4, #2
 1525              	.LVL121:
 554:app/gcode.c   ****         axes_mask |= HOME_Z_AXIS;
 1526              		.loc 1 554 5 is_stmt 1 view .LVU415
 554:app/gcode.c   ****         axes_mask |= HOME_Z_AXIS;
 1527              		.loc 1 554 8 is_stmt 0 view .LVU416
 1528 0060 40F14181 		bpl	.L254
 555:app/gcode.c   ****     }
 1529              		.loc 1 555 9 is_stmt 1 view .LVU417
 1530              	.LVL122:
 559:app/gcode.c   ****         axes_mask = HOME_X_AXIS | HOME_Y_AXIS | HOME_Z_AXIS;
 1531              		.loc 1 559 5 view .LVU418
 564:app/gcode.c   ****     
 1532              		.loc 1 564 5 view .LVU419
 1533 0064 44F00600 		orr	r0, r4, #6
 1534 0068 FFF7FEFF 		bl	toolhead_home
 1535              	.LVL123:
 567:app/gcode.c   ****     if (axes_mask & HOME_Y_AXIS) { s_pos_y = 0.0f; }
 1536              		.loc 1 567 5 view .LVU420
 567:app/gcode.c   ****     if (axes_mask & HOME_Y_AXIS) { s_pos_y = 0.0f; }
 1537              		.loc 1 567 8 is_stmt 0 view .LVU421
 1538 006c 002C     		cmp	r4, #0
 1539 006e 40F0FD80 		bne	.L231
 568:app/gcode.c   ****     if (axes_mask & HOME_Z_AXIS) { s_pos_z = 0.0f; }
 1540              		.loc 1 568 5 is_stmt 1 view .LVU422
 568:app/gcode.c   ****     if (axes_mask & HOME_Z_AXIS) { s_pos_z = 0.0f; }
 1541              		.loc 1 568 36 view .LVU423
 568:app/gcode.c   ****     if (axes_mask & HOME_Z_AXIS) { s_pos_z = 0.0f; }
 1542              		.loc 1 568 44 is_stmt 0 view .LVU424
 1543 0072 AC4B     		ldr	r3, .L260
 1544 0074 0022     		movs	r2, #0
 1545 0076 1A60     		str	r2, [r3]	@ float
 569:app/gcode.c   ****     
 1546              		.loc 1 569 5 is_stmt 1 view .LVU425
 1547              	.LVL124:
 1548              	.L230:
 569:app/gcode.c   ****     
 1549              		.loc 1 569 36 view .LVU426
 569:app/gcode.c   ****     
 1550              		.loc 1 569 44 is_stmt 0 view .LVU427
 1551 0078 AB4B     		ldr	r3, .L260+4
ARM GAS  /tmp/ccqT8DeC.s 			page 48


 1552 007a 0022     		movs	r2, #0
 1553              	.LBE149:
 1554              	.LBE148:
 733:app/gcode.c   ****                 break;
 1555              		.loc 1 733 23 view .LVU428
 1556 007c 0020     		movs	r0, #0
 1557              	.LBB153:
 1558              	.LBB150:
 569:app/gcode.c   ****     
 1559              		.loc 1 569 44 view .LVU429
 1560 007e 1A60     		str	r2, [r3]	@ float
 1561 0080 E0E7     		b	.L184
 1562              	.LVL125:
 1563              	.L188:
 569:app/gcode.c   ****     
 1564              		.loc 1 569 44 view .LVU430
 1565              	.LBE150:
 1566              	.LBE153:
 726:app/gcode.c   ****             case 0:     /* G0: 快速移动 */
 1567              		.loc 1 726 9 view .LVU431
 1568 0082 5B2B     		cmp	r3, #91
 1569 0084 DCD1     		bne	.L234
 741:app/gcode.c   ****                 break;
 1570              		.loc 1 741 17 is_stmt 1 view .LVU432
 1571              	.LBB154:
 1572              	.LBI154:
 594:app/gcode.c   **** {
 1573              		.loc 1 594 1 view .LVU433
 1574              	.LBB155:
 596:app/gcode.c   ****     return 0;
 1575              		.loc 1 596 5 view .LVU434
 596:app/gcode.c   ****     return 0;
 1576              		.loc 1 596 18 is_stmt 0 view .LVU435
 1577 0086 A94B     		ldr	r3, .L260+8
 1578 0088 0122     		movs	r2, #1
 1579 008a 1A70     		strb	r2, [r3]
 597:app/gcode.c   **** }
 1580              		.loc 1 597 5 is_stmt 1 view .LVU436
 597:app/gcode.c   **** }
 1581              		.loc 1 597 5 is_stmt 0 view .LVU437
 1582              	.LBE155:
 1583              	.LBE154:
 742:app/gcode.c   ****                 
 1584              		.loc 1 742 17 is_stmt 1 view .LVU438
 741:app/gcode.c   ****                 break;
 1585              		.loc 1 741 23 is_stmt 0 view .LVU439
 1586 008c 0020     		movs	r0, #0
 1587              	.LVL126:
 742:app/gcode.c   ****                 
 1588              		.loc 1 742 17 view .LVU440
 1589 008e D9E7     		b	.L184
 1590              	.LVL127:
 1591              	.L190:
 729:app/gcode.c   ****                 break;
 1592              		.loc 1 729 17 is_stmt 1 view .LVU441
 1593              	.LBB156:
 1594              	.LBI156:
ARM GAS  /tmp/ccqT8DeC.s 			page 49


 492:app/gcode.c   **** {
 1595              		.loc 1 492 1 view .LVU442
 1596              	.LBB157:
 494:app/gcode.c   ****     float speed;
 1597              		.loc 1 494 5 view .LVU443
 495:app/gcode.c   ****     
 1598              		.loc 1 495 5 view .LVU444
 498:app/gcode.c   ****     
 1599              		.loc 1 498 5 view .LVU445
 1600 0090 09AB     		add	r3, sp, #36
 1601 0092 08AA     		add	r2, sp, #32
 1602 0094 07A9     		add	r1, sp, #28
 1603 0096 06A8     		add	r0, sp, #24
 1604              	.LVL128:
 498:app/gcode.c   ****     
 1605              		.loc 1 498 5 is_stmt 0 view .LVU446
 1606 0098 FFF7FEFF 		bl	toolhead_get_position
 1607              	.LVL129:
 501:app/gcode.c   ****         /* 绝对坐标模式 */
 1608              		.loc 1 501 5 is_stmt 1 view .LVU447
 501:app/gcode.c   ****         /* 绝对坐标模式 */
 1609              		.loc 1 501 22 is_stmt 0 view .LVU448
 1610 009c A34B     		ldr	r3, .L260+8
 501:app/gcode.c   ****         /* 绝对坐标模式 */
 1611              		.loc 1 501 8 view .LVU449
 1612 009e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1613 00a0 002B     		cmp	r3, #0
 1614 00a2 00F0BB80 		beq	.L255
 509:app/gcode.c   ****         if (p_cmd->has_y) { target_y += p_cmd->y; }
 1615              		.loc 1 509 9 is_stmt 1 view .LVU450
 509:app/gcode.c   ****         if (p_cmd->has_y) { target_y += p_cmd->y; }
 1616              		.loc 1 509 13 is_stmt 0 view .LVU451
 1617 00a6 94F82030 		ldrb	r3, [r4, #32]	@ zero_extendqisi2
 509:app/gcode.c   ****         if (p_cmd->has_y) { target_y += p_cmd->y; }
 1618              		.loc 1 509 12 view .LVU452
 1619 00aa D807     		lsls	r0, r3, #31
 1620 00ac 00F10F81 		bmi	.L202
 524:app/gcode.c   ****     
 1621              		.loc 1 524 5 view .LVU453
 1622 00b0 9DED060A 		vldr.32	s0, [sp, #24]
 1623              	.L203:
 510:app/gcode.c   ****         if (p_cmd->has_z) { target_z += p_cmd->z; }
 1624              		.loc 1 510 9 is_stmt 1 view .LVU454
 510:app/gcode.c   ****         if (p_cmd->has_z) { target_z += p_cmd->z; }
 1625              		.loc 1 510 12 is_stmt 0 view .LVU455
 1626 00b4 9907     		lsls	r1, r3, #30
 1627 00b6 00F10181 		bmi	.L204
 524:app/gcode.c   ****     
 1628              		.loc 1 524 5 view .LVU456
 1629 00ba DDED070A 		vldr.32	s1, [sp, #28]
 1630              	.L205:
 511:app/gcode.c   ****         if (p_cmd->has_e) { target_e += p_cmd->e; }
 1631              		.loc 1 511 9 is_stmt 1 view .LVU457
 511:app/gcode.c   ****         if (p_cmd->has_e) { target_e += p_cmd->e; }
 1632              		.loc 1 511 12 is_stmt 0 view .LVU458
 1633 00be 5A07     		lsls	r2, r3, #29
 1634 00c0 00F1F380 		bmi	.L206
ARM GAS  /tmp/ccqT8DeC.s 			page 50


 524:app/gcode.c   ****     
 1635              		.loc 1 524 5 view .LVU459
 1636 00c4 9DED081A 		vldr.32	s2, [sp, #32]
 1637              	.L207:
 512:app/gcode.c   ****     }
 1638              		.loc 1 512 9 is_stmt 1 view .LVU460
 512:app/gcode.c   ****     }
 1639              		.loc 1 512 12 is_stmt 0 view .LVU461
 1640 00c8 1807     		lsls	r0, r3, #28
 1641 00ca 40F1EB80 		bpl	.L250
 512:app/gcode.c   ****     }
 1642              		.loc 1 512 29 is_stmt 1 view .LVU462
 512:app/gcode.c   ****     }
 1643              		.loc 1 512 38 is_stmt 0 view .LVU463
 1644 00ce DDED097A 		vldr.32	s15, [sp, #36]
 1645 00d2 D4ED051A 		vldr.32	s3, [r4, #20]
 1646 00d6 71EEA71A 		vadd.f32	s3, s3, s15
 1647 00da CDED091A 		vstr.32	s3, [sp, #36]
 1648              	.L201:
 516:app/gcode.c   ****         s_feedrate = p_cmd->f;
 1649              		.loc 1 516 5 is_stmt 1 view .LVU464
 516:app/gcode.c   ****         s_feedrate = p_cmd->f;
 1650              		.loc 1 516 8 is_stmt 0 view .LVU465
 1651 00de D906     		lsls	r1, r3, #27
 1652 00e0 00F1DA80 		bmi	.L209
 521:app/gcode.c   ****     
 1653              		.loc 1 521 24 view .LVU466
 1654 00e4 924B     		ldr	r3, .L260+12
 1655 00e6 D3ED007A 		vldr.32	s15, [r3]
 1656              	.L210:
 521:app/gcode.c   ****     
 1657              		.loc 1 521 5 is_stmt 1 view .LVU467
 1658              	.LVL130:
 524:app/gcode.c   ****     
 1659              		.loc 1 524 5 view .LVU468
 521:app/gcode.c   ****     
 1660              		.loc 1 521 11 is_stmt 0 view .LVU469
 1661 00ea 9FED922A 		vldr.32	s4, .L260+16
 524:app/gcode.c   ****     
 1662              		.loc 1 524 5 view .LVU470
 1663 00ee 87EE822A 		vdiv.f32	s4, s15, s4
 1664              	.LVL131:
 524:app/gcode.c   ****     
 1665              		.loc 1 524 5 view .LVU471
 1666 00f2 FFF7FEFF 		bl	toolhead_move
 1667              	.LVL132:
 527:app/gcode.c   ****     s_pos_y = target_y;
 1668              		.loc 1 527 5 is_stmt 1 view .LVU472
 528:app/gcode.c   ****     s_pos_z = target_z;
 1669              		.loc 1 528 13 is_stmt 0 view .LVU473
 1670 00f6 8B4B     		ldr	r3, .L260
 527:app/gcode.c   ****     s_pos_y = target_y;
 1671              		.loc 1 527 13 view .LVU474
 1672 00f8 8F48     		ldr	r0, .L260+20
 528:app/gcode.c   ****     s_pos_z = target_z;
 1673              		.loc 1 528 13 view .LVU475
 1674 00fa 079A     		ldr	r2, [sp, #28]	@ float
ARM GAS  /tmp/ccqT8DeC.s 			page 51


 1675 00fc 1A60     		str	r2, [r3]	@ float
 527:app/gcode.c   ****     s_pos_y = target_y;
 1676              		.loc 1 527 13 view .LVU476
 1677 00fe 069C     		ldr	r4, [sp, #24]	@ float
 1678              	.LVL133:
 529:app/gcode.c   ****     s_pos_e = target_e;
 1679              		.loc 1 529 13 view .LVU477
 1680 0100 8949     		ldr	r1, .L260+4
 530:app/gcode.c   ****     
 1681              		.loc 1 530 13 view .LVU478
 1682 0102 8E4B     		ldr	r3, .L260+24
 1683 0104 099A     		ldr	r2, [sp, #36]	@ float
 527:app/gcode.c   ****     s_pos_y = target_y;
 1684              		.loc 1 527 13 view .LVU479
 1685 0106 0460     		str	r4, [r0]	@ float
 528:app/gcode.c   ****     s_pos_z = target_z;
 1686              		.loc 1 528 5 is_stmt 1 view .LVU480
 529:app/gcode.c   ****     s_pos_e = target_e;
 1687              		.loc 1 529 5 view .LVU481
 529:app/gcode.c   ****     s_pos_e = target_e;
 1688              		.loc 1 529 13 is_stmt 0 view .LVU482
 1689 0108 0898     		ldr	r0, [sp, #32]	@ float
 1690 010a 0860     		str	r0, [r1]	@ float
 530:app/gcode.c   ****     
 1691              		.loc 1 530 5 is_stmt 1 view .LVU483
 530:app/gcode.c   ****     
 1692              		.loc 1 530 13 is_stmt 0 view .LVU484
 1693 010c 1A60     		str	r2, [r3]	@ float
 532:app/gcode.c   **** }
 1694              		.loc 1 532 5 is_stmt 1 view .LVU485
 1695              	.LVL134:
 532:app/gcode.c   **** }
 1696              		.loc 1 532 5 is_stmt 0 view .LVU486
 1697              	.LBE157:
 1698              	.LBE156:
 730:app/gcode.c   ****                 
 1699              		.loc 1 730 17 is_stmt 1 view .LVU487
 729:app/gcode.c   ****                 break;
 1700              		.loc 1 729 23 is_stmt 0 view .LVU488
 1701 010e 0020     		movs	r0, #0
 730:app/gcode.c   ****                 
 1702              		.loc 1 730 17 view .LVU489
 1703 0110 98E7     		b	.L184
 1704              	.LVL135:
 1705              	.L223:
 759:app/gcode.c   ****                 break;
 1706              		.loc 1 759 17 is_stmt 1 view .LVU490
 1707              	.LBB160:
 1708              	.LBI160:
 651:app/gcode.c   **** {
 1709              		.loc 1 651 1 view .LVU491
 1710              	.LBB161:
 653:app/gcode.c   ****     
 1711              		.loc 1 653 5 view .LVU492
 655:app/gcode.c   ****         /* S 参数范围 0-255，转换为 0.0-1.0 */
 1712              		.loc 1 655 5 view .LVU493
 655:app/gcode.c   ****         /* S 参数范围 0-255，转换为 0.0-1.0 */
ARM GAS  /tmp/ccqT8DeC.s 			page 52


 1713              		.loc 1 655 9 is_stmt 0 view .LVU494
 1714 0112 90F82030 		ldrb	r3, [r0, #32]	@ zero_extendqisi2
 655:app/gcode.c   ****         /* S 参数范围 0-255，转换为 0.0-1.0 */
 1715              		.loc 1 655 8 view .LVU495
 1716 0116 9B06     		lsls	r3, r3, #26
 1717 0118 7DD5     		bpl	.L235
 657:app/gcode.c   ****         if (speed > 1.0f) {
 1718              		.loc 1 657 9 is_stmt 1 view .LVU496
 657:app/gcode.c   ****         if (speed > 1.0f) {
 1719              		.loc 1 657 15 is_stmt 0 view .LVU497
 1720 011a D0ED076A 		vldr.32	s13, [r0, #28]
 1721 011e 9FED887A 		vldr.32	s14, .L260+28
 1722 0122 86EE870A 		vdiv.f32	s0, s13, s14
 1723              	.LVL136:
 658:app/gcode.c   ****             speed = 1.0f;
 1724              		.loc 1 658 9 is_stmt 1 view .LVU498
 658:app/gcode.c   ****             speed = 1.0f;
 1725              		.loc 1 658 12 is_stmt 0 view .LVU499
 1726 0126 F7EE007A 		vmov.f32	s15, #1.0e+0
 1727 012a B4EEE70A 		vcmpe.f32	s0, s15
 1728 012e F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 1729 0132 00F3A180 		bgt	.L236
 660:app/gcode.c   ****             speed = 0.0f;
 1730              		.loc 1 660 16 is_stmt 1 view .LVU500
 660:app/gcode.c   ****             speed = 0.0f;
 1731              		.loc 1 660 19 is_stmt 0 view .LVU501
 1732 0136 B5EEC00A 		vcmpe.f32	s0, #0
 1733 013a F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 1734 013e 01D5     		bpl	.L251
 1735              	.LVL137:
 1736              	.L222:
 660:app/gcode.c   ****             speed = 0.0f;
 1737              		.loc 1 660 19 view .LVU502
 1738              	.LBE161:
 1739              	.LBE160:
 763:app/gcode.c   ****                 break;
 1740              		.loc 1 763 17 is_stmt 1 view .LVU503
 1741              	.LBB164:
 1742              	.LBI164:
 676:app/gcode.c   **** {
 1743              		.loc 1 676 1 view .LVU504
 1744              	.LBB165:
 678:app/gcode.c   ****     return 0;
 1745              		.loc 1 678 5 view .LVU505
 1746 0140 9FED800A 		vldr.32	s0, .L260+32
 1747              	.L251:
 1748 0144 0020     		movs	r0, #0
 1749              	.LVL138:
 678:app/gcode.c   ****     return 0;
 1750              		.loc 1 678 5 is_stmt 0 view .LVU506
 1751 0146 FFF7FEFF 		bl	fan_set_speed
 1752              	.LVL139:
 679:app/gcode.c   **** }
 1753              		.loc 1 679 5 is_stmt 1 view .LVU507
 679:app/gcode.c   **** }
 1754              		.loc 1 679 5 is_stmt 0 view .LVU508
 1755              	.LBE165:
ARM GAS  /tmp/ccqT8DeC.s 			page 53


 1756              	.LBE164:
 764:app/gcode.c   ****                 
 1757              		.loc 1 764 17 is_stmt 1 view .LVU509
 763:app/gcode.c   ****                 break;
 1758              		.loc 1 763 23 is_stmt 0 view .LVU510
 1759 014a 0020     		movs	r0, #0
 1760              		.loc 1 779 1 view .LVU511
 1761 014c 0AB0     		add	sp, sp, #40
 1762              		.cfi_remember_state
 1763              		.cfi_def_cfa_offset 8
 1764              		@ sp needed
 1765 014e 10BD     		pop	{r4, pc}
 1766              	.LVL140:
 1767              	.L224:
 1768              		.cfi_restore_state
 751:app/gcode.c   ****                 break;
 1769              		.loc 1 751 17 is_stmt 1 view .LVU512
 1770              	.LBB166:
 1771              	.LBI166:
 608:app/gcode.c   **** {
 1772              		.loc 1 608 1 view .LVU513
 1773              	.LBB167:
 610:app/gcode.c   ****         heater_set_temp(HEATER_HOTEND, p_cmd->s);
 1774              		.loc 1 610 5 view .LVU514
 610:app/gcode.c   ****         heater_set_temp(HEATER_HOTEND, p_cmd->s);
 1775              		.loc 1 610 9 is_stmt 0 view .LVU515
 1776 0150 90F82030 		ldrb	r3, [r0, #32]	@ zero_extendqisi2
 610:app/gcode.c   ****         heater_set_temp(HEATER_HOTEND, p_cmd->s);
 1777              		.loc 1 610 8 view .LVU516
 1778 0154 9906     		lsls	r1, r3, #26
 1779 0156 00F19880 		bmi	.L256
 1780              	.LVL141:
 1781              	.L252:
 610:app/gcode.c   ****         heater_set_temp(HEATER_HOTEND, p_cmd->s);
 1782              		.loc 1 610 8 view .LVU517
 1783              	.LBE167:
 1784              	.LBE166:
 1785              	.LBB169:
 1786              	.LBB170:
 706:app/gcode.c   **** }
 1787              		.loc 1 706 5 is_stmt 1 view .LVU518
 706:app/gcode.c   **** }
 1788              		.loc 1 706 5 is_stmt 0 view .LVU519
 1789              	.LBE170:
 1790              	.LBE169:
 768:app/gcode.c   ****                 
 1791              		.loc 1 768 17 is_stmt 1 view .LVU520
 767:app/gcode.c   ****                 break;
 1792              		.loc 1 767 23 is_stmt 0 view .LVU521
 1793 015a 0020     		movs	r0, #0
 1794              		.loc 1 779 1 view .LVU522
 1795 015c 0AB0     		add	sp, sp, #40
 1796              		.cfi_remember_state
 1797              		.cfi_def_cfa_offset 8
 1798              		@ sp needed
 1799 015e 10BD     		pop	{r4, pc}
 1800              	.LVL142:
ARM GAS  /tmp/ccqT8DeC.s 			page 54


 1801              	.L221:
 1802              		.cfi_restore_state
 755:app/gcode.c   ****                 break;
 1803              		.loc 1 755 17 is_stmt 1 view .LVU523
 1804              	.LBB172:
 1805              	.LBI172:
 624:app/gcode.c   **** {
 1806              		.loc 1 624 1 view .LVU524
 1807              	.LBB173:
 627:app/gcode.c   ****         heater_set_temp(HEATER_HOTEND, p_cmd->s);
 1808              		.loc 1 627 5 view .LVU525
 627:app/gcode.c   ****         heater_set_temp(HEATER_HOTEND, p_cmd->s);
 1809              		.loc 1 627 9 is_stmt 0 view .LVU526
 1810 0160 90F82030 		ldrb	r3, [r0, #32]	@ zero_extendqisi2
 627:app/gcode.c   ****         heater_set_temp(HEATER_HOTEND, p_cmd->s);
 1811              		.loc 1 627 8 view .LVU527
 1812 0164 9A06     		lsls	r2, r3, #26
 1813 0166 00F18A80 		bmi	.L257
 1814              	.LVL143:
 1815              	.L226:
 634:app/gcode.c   ****         /* 在实际实现中，这里应该调用调度器 */
 1816              		.loc 1 634 5 is_stmt 1 view .LVU528
 634:app/gcode.c   ****         /* 在实际实现中，这里应该调用调度器 */
 1817              		.loc 1 634 11 view .LVU529
 634:app/gcode.c   ****         /* 在实际实现中，这里应该调用调度器 */
 1818              		.loc 1 634 13 is_stmt 0 view .LVU530
 1819 016a 0020     		movs	r0, #0
 1820 016c FFF7FEFF 		bl	heater_is_at_target
 1821              	.LVL144:
 640:app/gcode.c   **** }
 1822              		.loc 1 640 5 is_stmt 1 view .LVU531
 640:app/gcode.c   **** }
 1823              		.loc 1 640 5 is_stmt 0 view .LVU532
 1824              	.LBE173:
 1825              	.LBE172:
 756:app/gcode.c   ****                 
 1826              		.loc 1 756 17 is_stmt 1 view .LVU533
 755:app/gcode.c   ****                 break;
 1827              		.loc 1 755 23 is_stmt 0 view .LVU534
 1828 0170 0020     		movs	r0, #0
 1829              		.loc 1 779 1 view .LVU535
 1830 0172 0AB0     		add	sp, sp, #40
 1831              		.cfi_remember_state
 1832              		.cfi_def_cfa_offset 8
 1833              		@ sp needed
 1834 0174 10BD     		pop	{r4, pc}
 1835              	.LVL145:
 1836              	.L219:
 1837              		.cfi_restore_state
 767:app/gcode.c   ****                 break;
 1838              		.loc 1 767 17 is_stmt 1 view .LVU536
 1839              	.LBB175:
 1840              	.LBI169:
 689:app/gcode.c   **** {
 1841              		.loc 1 689 1 view .LVU537
 1842              	.LBB171:
 691:app/gcode.c   ****     
ARM GAS  /tmp/ccqT8DeC.s 			page 55


 1843              		.loc 1 691 5 view .LVU538
 694:app/gcode.c   ****     
 1844              		.loc 1 694 5 view .LVU539
 1845 0176 09AB     		add	r3, sp, #36
 1846 0178 08AA     		add	r2, sp, #32
 1847 017a 07A9     		add	r1, sp, #28
 1848 017c 06A8     		add	r0, sp, #24
 1849              	.LVL146:
 694:app/gcode.c   ****     
 1850              		.loc 1 694 5 is_stmt 0 view .LVU540
 1851 017e FFF7FEFF 		bl	toolhead_get_position
 1852              	.LVL147:
 699:app/gcode.c   ****                   (int)x, (int)((x - (int)x) * 100),
 1853              		.loc 1 699 5 is_stmt 1 view .LVU541
 1854 0182 DDED077A 		vldr.32	s15, [sp, #28]
 1855 0186 9DED087A 		vldr.32	s14, [sp, #32]
 1856 018a DDED096A 		vldr.32	s13, [sp, #36]
 1857 018e 9DED066A 		vldr.32	s12, [sp, #24]
 700:app/gcode.c   ****                   (int)y, (int)((y - (int)y) * 100),
 1858              		.loc 1 700 46 is_stmt 0 view .LVU542
 1859 0192 DFED6D5A 		vldr.32	s11, .L260+36
 699:app/gcode.c   ****                   (int)x, (int)((x - (int)x) * 100),
 1860              		.loc 1 699 5 view .LVU543
 1861 0196 6D48     		ldr	r0, .L260+40
 1862 0198 FDEEE74A 		vcvt.s32.f32	s9, s15
 1863 019c BDEEC74A 		vcvt.s32.f32	s8, s14
 1864 01a0 FDEEE63A 		vcvt.s32.f32	s7, s13
 1865 01a4 BDEEC65A 		vcvt.s32.f32	s10, s12
 703:app/gcode.c   **** #endif
 1866              		.loc 1 703 36 view .LVU544
 1867 01a8 F8EEE31A 		vcvt.f32.s32	s3, s7
 702:app/gcode.c   ****                   (int)e, (int)((e - (int)e) * 100));
 1868              		.loc 1 702 36 view .LVU545
 1869 01ac B8EEC42A 		vcvt.f32.s32	s4, s8
 701:app/gcode.c   ****                   (int)z, (int)((z - (int)z) * 100),
 1870              		.loc 1 701 36 view .LVU546
 1871 01b0 F8EEE42A 		vcvt.f32.s32	s5, s9
 700:app/gcode.c   ****                   (int)y, (int)((y - (int)y) * 100),
 1872              		.loc 1 700 36 view .LVU547
 1873 01b4 B8EEC53A 		vcvt.f32.s32	s6, s10
 703:app/gcode.c   **** #endif
 1874              		.loc 1 703 36 view .LVU548
 1875 01b8 76EEE16A 		vsub.f32	s13, s13, s3
 702:app/gcode.c   ****                   (int)e, (int)((e - (int)e) * 100));
 1876              		.loc 1 702 36 view .LVU549
 1877 01bc 37EE427A 		vsub.f32	s14, s14, s4
 701:app/gcode.c   ****                   (int)z, (int)((z - (int)z) * 100),
 1878              		.loc 1 701 36 view .LVU550
 1879 01c0 77EEE27A 		vsub.f32	s15, s15, s5
 700:app/gcode.c   ****                   (int)y, (int)((y - (int)y) * 100),
 1880              		.loc 1 700 36 view .LVU551
 1881 01c4 36EE436A 		vsub.f32	s12, s12, s6
 703:app/gcode.c   **** #endif
 1882              		.loc 1 703 46 view .LVU552
 1883 01c8 66EEA56A 		vmul.f32	s13, s13, s11
 702:app/gcode.c   ****                   (int)e, (int)((e - (int)e) * 100));
 1884              		.loc 1 702 46 view .LVU553
ARM GAS  /tmp/ccqT8DeC.s 			page 56


 1885 01cc 27EE257A 		vmul.f32	s14, s14, s11
 701:app/gcode.c   ****                   (int)z, (int)((z - (int)z) * 100),
 1886              		.loc 1 701 46 view .LVU554
 1887 01d0 67EEA57A 		vmul.f32	s15, s15, s11
 700:app/gcode.c   ****                   (int)y, (int)((y - (int)y) * 100),
 1888              		.loc 1 700 46 view .LVU555
 1889 01d4 26EE256A 		vmul.f32	s12, s12, s11
 699:app/gcode.c   ****                   (int)x, (int)((x - (int)x) * 100),
 1890              		.loc 1 699 5 view .LVU556
 1891 01d8 FDEEE66A 		vcvt.s32.f32	s13, s13
 1892 01dc BDEEC77A 		vcvt.s32.f32	s14, s14
 1893 01e0 FDEEE77A 		vcvt.s32.f32	s15, s15
 1894 01e4 BDEEC66A 		vcvt.s32.f32	s12, s12
 1895 01e8 14EE903A 		vmov	r3, s9	@ int
 1896 01ec 16EE102A 		vmov	r2, s12	@ int
 1897 01f0 15EE101A 		vmov	r1, s10	@ int
 1898 01f4 CDED046A 		vstr.32	s13, [sp, #16]	@ int
 1899 01f8 CDED033A 		vstr.32	s7, [sp, #12]	@ int
 1900 01fc 8DED027A 		vstr.32	s14, [sp, #8]	@ int
 1901 0200 8DED014A 		vstr.32	s8, [sp, #4]	@ int
 1902 0204 CDED007A 		vstr.32	s15, [sp]	@ int
 1903 0208 FFF7FEFF 		bl	serial_printf
 1904              	.LVL148:
 1905 020c A5E7     		b	.L252
 1906              	.LVL149:
 1907              	.L187:
 699:app/gcode.c   ****                   (int)x, (int)((x - (int)x) * 100),
 1908              		.loc 1 699 5 view .LVU557
 1909              	.LBE171:
 1910              	.LBE175:
 737:app/gcode.c   ****                 break;
 1911              		.loc 1 737 17 is_stmt 1 view .LVU558
 1912              	.LBB176:
 1913              	.LBI176:
 581:app/gcode.c   **** {
 1914              		.loc 1 581 1 view .LVU559
 1915              	.LBB177:
 583:app/gcode.c   ****     return 0;
 1916              		.loc 1 583 5 view .LVU560
 583:app/gcode.c   ****     return 0;
 1917              		.loc 1 583 18 is_stmt 0 view .LVU561
 1918 020e 474B     		ldr	r3, .L260+8
 1919 0210 0020     		movs	r0, #0
 1920              	.LVL150:
 583:app/gcode.c   ****     return 0;
 1921              		.loc 1 583 18 view .LVU562
 1922 0212 1870     		strb	r0, [r3]
 584:app/gcode.c   **** }
 1923              		.loc 1 584 5 is_stmt 1 view .LVU563
 584:app/gcode.c   **** }
 1924              		.loc 1 584 5 is_stmt 0 view .LVU564
 1925              	.LBE177:
 1926              	.LBE176:
 738:app/gcode.c   ****                 
 1927              		.loc 1 738 17 is_stmt 1 view .LVU565
 1928 0214 16E7     		b	.L184
 1929              	.LVL151:
ARM GAS  /tmp/ccqT8DeC.s 			page 57


 1930              	.L235:
 1931              	.LBB178:
 1932              	.LBB162:
 653:app/gcode.c   ****     
 1933              		.loc 1 653 11 is_stmt 0 view .LVU566
 1934 0216 B7EE000A 		vmov.f32	s0, #1.0e+0
 1935 021a 93E7     		b	.L251
 1936              	.LVL152:
 1937              	.L255:
 653:app/gcode.c   ****     
 1938              		.loc 1 653 11 view .LVU567
 1939              	.LBE162:
 1940              	.LBE178:
 1941              	.LBB179:
 1942              	.LBB158:
 503:app/gcode.c   ****         if (p_cmd->has_y) { target_y = p_cmd->y; }
 1943              		.loc 1 503 9 is_stmt 1 view .LVU568
 503:app/gcode.c   ****         if (p_cmd->has_y) { target_y = p_cmd->y; }
 1944              		.loc 1 503 13 is_stmt 0 view .LVU569
 1945 021c 94F82030 		ldrb	r3, [r4, #32]	@ zero_extendqisi2
 503:app/gcode.c   ****         if (p_cmd->has_y) { target_y = p_cmd->y; }
 1946              		.loc 1 503 12 view .LVU570
 1947 0220 DA07     		lsls	r2, r3, #31
 503:app/gcode.c   ****         if (p_cmd->has_y) { target_y = p_cmd->y; }
 1948              		.loc 1 503 45 view .LVU571
 1949 0222 4ABF     		itet	mi
 1950 0224 94ED020A 		vldrmi.32	s0, [r4, #8]
 524:app/gcode.c   ****     
 1951              		.loc 1 524 5 view .LVU572
 1952 0228 9DED060A 		vldrpl.32	s0, [sp, #24]
 503:app/gcode.c   ****         if (p_cmd->has_y) { target_y = p_cmd->y; }
 1953              		.loc 1 503 29 is_stmt 1 view .LVU573
 504:app/gcode.c   ****         if (p_cmd->has_z) { target_z = p_cmd->z; }
 1954              		.loc 1 504 9 view .LVU574
 503:app/gcode.c   ****         if (p_cmd->has_y) { target_y = p_cmd->y; }
 1955              		.loc 1 503 38 is_stmt 0 view .LVU575
 1956 022c 8DED060A 		vstrmi.32	s0, [sp, #24]
 504:app/gcode.c   ****         if (p_cmd->has_z) { target_z = p_cmd->z; }
 1957              		.loc 1 504 12 view .LVU576
 1958 0230 9807     		lsls	r0, r3, #30
 504:app/gcode.c   ****         if (p_cmd->has_z) { target_z = p_cmd->z; }
 1959              		.loc 1 504 45 view .LVU577
 1960 0232 4ABF     		itet	mi
 1961 0234 D4ED030A 		vldrmi.32	s1, [r4, #12]
 524:app/gcode.c   ****     
 1962              		.loc 1 524 5 view .LVU578
 1963 0238 DDED070A 		vldrpl.32	s1, [sp, #28]
 504:app/gcode.c   ****         if (p_cmd->has_z) { target_z = p_cmd->z; }
 1964              		.loc 1 504 29 is_stmt 1 view .LVU579
 505:app/gcode.c   ****         if (p_cmd->has_e) { target_e = p_cmd->e; }
 1965              		.loc 1 505 9 view .LVU580
 504:app/gcode.c   ****         if (p_cmd->has_z) { target_z = p_cmd->z; }
 1966              		.loc 1 504 38 is_stmt 0 view .LVU581
 1967 023c CDED070A 		vstrmi.32	s1, [sp, #28]
 505:app/gcode.c   ****         if (p_cmd->has_e) { target_e = p_cmd->e; }
 1968              		.loc 1 505 12 view .LVU582
 1969 0240 5907     		lsls	r1, r3, #29
ARM GAS  /tmp/ccqT8DeC.s 			page 58


 505:app/gcode.c   ****         if (p_cmd->has_e) { target_e = p_cmd->e; }
 1970              		.loc 1 505 45 view .LVU583
 1971 0242 4ABF     		itet	mi
 1972 0244 94ED041A 		vldrmi.32	s2, [r4, #16]
 524:app/gcode.c   ****     
 1973              		.loc 1 524 5 view .LVU584
 1974 0248 9DED081A 		vldrpl.32	s2, [sp, #32]
 505:app/gcode.c   ****         if (p_cmd->has_e) { target_e = p_cmd->e; }
 1975              		.loc 1 505 29 is_stmt 1 view .LVU585
 506:app/gcode.c   ****     } else {
 1976              		.loc 1 506 9 view .LVU586
 505:app/gcode.c   ****         if (p_cmd->has_e) { target_e = p_cmd->e; }
 1977              		.loc 1 505 38 is_stmt 0 view .LVU587
 1978 024c 8DED081A 		vstrmi.32	s2, [sp, #32]
 506:app/gcode.c   ****     } else {
 1979              		.loc 1 506 12 view .LVU588
 1980 0250 1A07     		lsls	r2, r3, #28
 1981 0252 27D5     		bpl	.L250
 506:app/gcode.c   ****     } else {
 1982              		.loc 1 506 29 is_stmt 1 view .LVU589
 506:app/gcode.c   ****     } else {
 1983              		.loc 1 506 45 is_stmt 0 view .LVU590
 1984 0254 D4ED051A 		vldr.32	s3, [r4, #20]
 506:app/gcode.c   ****     } else {
 1985              		.loc 1 506 38 view .LVU591
 1986 0258 CDED091A 		vstr.32	s3, [sp, #36]
 1987 025c 3FE7     		b	.L201
 1988              	.LVL153:
 1989              	.L211:
 506:app/gcode.c   ****     } else {
 1990              		.loc 1 506 38 view .LVU592
 1991              	.LBE158:
 1992              	.LBE179:
 1993              	.LBB180:
 1994              	.LBB151:
 554:app/gcode.c   ****         axes_mask |= HOME_Z_AXIS;
 1995              		.loc 1 554 5 is_stmt 1 view .LVU593
 554:app/gcode.c   ****         axes_mask |= HOME_Z_AXIS;
 1996              		.loc 1 554 8 is_stmt 0 view .LVU594
 1997 025e 5807     		lsls	r0, r3, #29
 1998              	.LVL154:
 554:app/gcode.c   ****         axes_mask |= HOME_Z_AXIS;
 1999              		.loc 1 554 8 view .LVU595
 2000 0260 4FD4     		bmi	.L258
 559:app/gcode.c   ****         axes_mask = HOME_X_AXIS | HOME_Y_AXIS | HOME_Z_AXIS;
 2001              		.loc 1 559 5 is_stmt 1 view .LVU596
 559:app/gcode.c   ****         axes_mask = HOME_X_AXIS | HOME_Y_AXIS | HOME_Z_AXIS;
 2002              		.loc 1 559 8 is_stmt 0 view .LVU597
 2003 0262 002C     		cmp	r4, #0
 2004 0264 46D1     		bne	.L259
 560:app/gcode.c   ****     }
 2005              		.loc 1 560 9 is_stmt 1 view .LVU598
 2006              	.LVL155:
 564:app/gcode.c   ****     
 2007              		.loc 1 564 5 view .LVU599
 2008 0266 0720     		movs	r0, #7
 2009 0268 FFF7FEFF 		bl	toolhead_home
ARM GAS  /tmp/ccqT8DeC.s 			page 59


 2010              	.LVL156:
 567:app/gcode.c   ****     if (axes_mask & HOME_Y_AXIS) { s_pos_y = 0.0f; }
 2011              		.loc 1 567 5 view .LVU600
 567:app/gcode.c   ****     if (axes_mask & HOME_Y_AXIS) { s_pos_y = 0.0f; }
 2012              		.loc 1 567 36 view .LVU601
 2013              	.L231:
 567:app/gcode.c   ****     if (axes_mask & HOME_Y_AXIS) { s_pos_y = 0.0f; }
 2014              		.loc 1 567 36 view .LVU602
 567:app/gcode.c   ****     if (axes_mask & HOME_Y_AXIS) { s_pos_y = 0.0f; }
 2015              		.loc 1 567 44 is_stmt 0 view .LVU603
 2016 026c 3249     		ldr	r1, .L260+20
 568:app/gcode.c   ****     if (axes_mask & HOME_Z_AXIS) { s_pos_z = 0.0f; }
 2017              		.loc 1 568 44 view .LVU604
 2018 026e 2D4A     		ldr	r2, .L260
 567:app/gcode.c   ****     if (axes_mask & HOME_Y_AXIS) { s_pos_y = 0.0f; }
 2019              		.loc 1 567 44 view .LVU605
 2020 0270 0023     		movs	r3, #0
 2021 0272 0B60     		str	r3, [r1]	@ float
 568:app/gcode.c   ****     if (axes_mask & HOME_Z_AXIS) { s_pos_z = 0.0f; }
 2022              		.loc 1 568 5 is_stmt 1 view .LVU606
 568:app/gcode.c   ****     if (axes_mask & HOME_Z_AXIS) { s_pos_z = 0.0f; }
 2023              		.loc 1 568 36 view .LVU607
 568:app/gcode.c   ****     if (axes_mask & HOME_Z_AXIS) { s_pos_z = 0.0f; }
 2024              		.loc 1 568 44 is_stmt 0 view .LVU608
 2025 0274 1360     		str	r3, [r2]	@ float
 569:app/gcode.c   ****     
 2026              		.loc 1 569 5 is_stmt 1 view .LVU609
 2027 0276 FFE6     		b	.L230
 2028              	.LVL157:
 2029              	.L236:
 569:app/gcode.c   ****     
 2030              		.loc 1 569 5 is_stmt 0 view .LVU610
 2031              	.LBE151:
 2032              	.LBE180:
 2033              	.LBB181:
 2034              	.LBB163:
 653:app/gcode.c   ****     
 2035              		.loc 1 653 11 view .LVU611
 2036 0278 B0EE670A 		vmov.f32	s0, s15
 2037              	.LVL158:
 665:app/gcode.c   ****     return 0;
 2038              		.loc 1 665 5 is_stmt 1 view .LVU612
 2039 027c 62E7     		b	.L251
 2040              	.LVL159:
 2041              	.L257:
 665:app/gcode.c   ****     return 0;
 2042              		.loc 1 665 5 is_stmt 0 view .LVU613
 2043              	.LBE163:
 2044              	.LBE181:
 2045              	.LBB182:
 2046              	.LBB174:
 628:app/gcode.c   ****     }
 2047              		.loc 1 628 9 is_stmt 1 view .LVU614
 2048 027e 90ED070A 		vldr.32	s0, [r0, #28]
 2049 0282 0020     		movs	r0, #0
 2050              	.LVL160:
 628:app/gcode.c   ****     }
ARM GAS  /tmp/ccqT8DeC.s 			page 60


 2051              		.loc 1 628 9 is_stmt 0 view .LVU615
 2052 0284 FFF7FEFF 		bl	heater_set_temp
 2053              	.LVL161:
 2054 0288 6FE7     		b	.L226
 2055              	.LVL162:
 2056              	.L256:
 628:app/gcode.c   ****     }
 2057              		.loc 1 628 9 view .LVU616
 2058              	.LBE174:
 2059              	.LBE182:
 2060              	.LBB183:
 2061              	.LBB168:
 611:app/gcode.c   ****     }
 2062              		.loc 1 611 9 is_stmt 1 view .LVU617
 2063 028a 90ED070A 		vldr.32	s0, [r0, #28]
 2064 028e 0020     		movs	r0, #0
 2065              	.LVL163:
 611:app/gcode.c   ****     }
 2066              		.loc 1 611 9 is_stmt 0 view .LVU618
 2067 0290 FFF7FEFF 		bl	heater_set_temp
 2068              	.LVL164:
 2069              	.LBE168:
 2070              	.LBE183:
 751:app/gcode.c   ****                 break;
 2071              		.loc 1 751 23 view .LVU619
 2072 0294 0020     		movs	r0, #0
 2073 0296 D5E6     		b	.L184
 2074              	.LVL165:
 2075              	.L209:
 2076              	.LBB184:
 2077              	.LBB159:
 517:app/gcode.c   ****     }
 2078              		.loc 1 517 9 is_stmt 1 view .LVU620
 517:app/gcode.c   ****     }
 2079              		.loc 1 517 27 is_stmt 0 view .LVU621
 2080 0298 D4ED067A 		vldr.32	s15, [r4, #24]
 517:app/gcode.c   ****     }
 2081              		.loc 1 517 20 view .LVU622
 2082 029c 244B     		ldr	r3, .L260+12
 2083 029e C3ED007A 		vstr.32	s15, [r3]
 2084 02a2 22E7     		b	.L210
 2085              	.L250:
 524:app/gcode.c   ****     
 2086              		.loc 1 524 5 view .LVU623
 2087 02a4 DDED091A 		vldr.32	s3, [sp, #36]
 2088 02a8 19E7     		b	.L201
 2089              	.L206:
 511:app/gcode.c   ****         if (p_cmd->has_e) { target_e += p_cmd->e; }
 2090              		.loc 1 511 29 is_stmt 1 view .LVU624
 511:app/gcode.c   ****         if (p_cmd->has_e) { target_e += p_cmd->e; }
 2091              		.loc 1 511 38 is_stmt 0 view .LVU625
 2092 02aa DDED087A 		vldr.32	s15, [sp, #32]
 2093 02ae 94ED041A 		vldr.32	s2, [r4, #16]
 2094 02b2 31EE271A 		vadd.f32	s2, s2, s15
 2095 02b6 8DED081A 		vstr.32	s2, [sp, #32]
 2096 02ba 05E7     		b	.L207
 2097              	.L204:
ARM GAS  /tmp/ccqT8DeC.s 			page 61


 510:app/gcode.c   ****         if (p_cmd->has_z) { target_z += p_cmd->z; }
 2098              		.loc 1 510 29 is_stmt 1 view .LVU626
 510:app/gcode.c   ****         if (p_cmd->has_z) { target_z += p_cmd->z; }
 2099              		.loc 1 510 38 is_stmt 0 view .LVU627
 2100 02bc DDED077A 		vldr.32	s15, [sp, #28]
 2101 02c0 D4ED030A 		vldr.32	s1, [r4, #12]
 2102 02c4 70EEA70A 		vadd.f32	s1, s1, s15
 2103 02c8 CDED070A 		vstr.32	s1, [sp, #28]
 2104 02cc F7E6     		b	.L205
 2105              	.L202:
 509:app/gcode.c   ****         if (p_cmd->has_y) { target_y += p_cmd->y; }
 2106              		.loc 1 509 29 is_stmt 1 view .LVU628
 509:app/gcode.c   ****         if (p_cmd->has_y) { target_y += p_cmd->y; }
 2107              		.loc 1 509 38 is_stmt 0 view .LVU629
 2108 02ce DDED067A 		vldr.32	s15, [sp, #24]
 2109 02d2 94ED020A 		vldr.32	s0, [r4, #8]
 2110 02d6 30EE270A 		vadd.f32	s0, s0, s15
 2111 02da 8DED060A 		vstr.32	s0, [sp, #24]
 2112 02de E9E6     		b	.L203
 2113              	.LVL166:
 2114              	.L232:
 2115              		.cfi_def_cfa_offset 0
 2116              		.cfi_restore 4
 2117              		.cfi_restore 14
 509:app/gcode.c   ****         if (p_cmd->has_y) { target_y += p_cmd->y; }
 2118              		.loc 1 509 38 view .LVU630
 2119              	.LBE159:
 2120              	.LBE184:
 721:app/gcode.c   ****     }
 2121              		.loc 1 721 16 view .LVU631
 2122 02e0 4FF0FF30 		mov	r0, #-1
 2123              	.LVL167:
 2124              		.loc 1 779 1 view .LVU632
 2125 02e4 7047     		bx	lr
 2126              	.LVL168:
 2127              	.L254:
 2128              		.cfi_def_cfa_offset 48
 2129              		.cfi_offset 4, -8
 2130              		.cfi_offset 14, -4
 2131              	.LBB185:
 2132              	.LBB152:
 564:app/gcode.c   ****     
 2133              		.loc 1 564 5 is_stmt 1 view .LVU633
 2134 02e6 FFF7FEFF 		bl	toolhead_home
 2135              	.LVL169:
 567:app/gcode.c   ****     if (axes_mask & HOME_Y_AXIS) { s_pos_y = 0.0f; }
 2136              		.loc 1 567 5 view .LVU634
 567:app/gcode.c   ****     if (axes_mask & HOME_Y_AXIS) { s_pos_y = 0.0f; }
 2137              		.loc 1 567 8 is_stmt 0 view .LVU635
 2138 02ea ACB9     		cbnz	r4, .L229
 568:app/gcode.c   ****     if (axes_mask & HOME_Z_AXIS) { s_pos_z = 0.0f; }
 2139              		.loc 1 568 36 is_stmt 1 view .LVU636
 568:app/gcode.c   ****     if (axes_mask & HOME_Z_AXIS) { s_pos_z = 0.0f; }
 2140              		.loc 1 568 44 is_stmt 0 view .LVU637
 2141 02ec 0D4B     		ldr	r3, .L260
 2142 02ee 0022     		movs	r2, #0
 2143 02f0 1A60     		str	r2, [r3]	@ float
ARM GAS  /tmp/ccqT8DeC.s 			page 62


 569:app/gcode.c   ****     
 2144              		.loc 1 569 5 is_stmt 1 view .LVU638
 2145 02f2 32E7     		b	.L252
 2146              	.LVL170:
 2147              	.L259:
 564:app/gcode.c   ****     
 2148              		.loc 1 564 5 view .LVU639
 2149 02f4 0120     		movs	r0, #1
 2150 02f6 FFF7FEFF 		bl	toolhead_home
 2151              	.LVL171:
 567:app/gcode.c   ****     if (axes_mask & HOME_Y_AXIS) { s_pos_y = 0.0f; }
 2152              		.loc 1 567 5 view .LVU640
 567:app/gcode.c   ****     if (axes_mask & HOME_Y_AXIS) { s_pos_y = 0.0f; }
 2153              		.loc 1 567 36 view .LVU641
 567:app/gcode.c   ****     if (axes_mask & HOME_Y_AXIS) { s_pos_y = 0.0f; }
 2154              		.loc 1 567 44 is_stmt 0 view .LVU642
 2155 02fa 0F4B     		ldr	r3, .L260+20
 2156 02fc 0022     		movs	r2, #0
 2157 02fe 1A60     		str	r2, [r3]	@ float
 568:app/gcode.c   ****     if (axes_mask & HOME_Z_AXIS) { s_pos_z = 0.0f; }
 2158              		.loc 1 568 5 is_stmt 1 view .LVU643
 569:app/gcode.c   ****     
 2159              		.loc 1 569 5 view .LVU644
 2160 0300 2BE7     		b	.L252
 2161              	.LVL172:
 2162              	.L258:
 555:app/gcode.c   ****     }
 2163              		.loc 1 555 9 view .LVU645
 559:app/gcode.c   ****         axes_mask = HOME_X_AXIS | HOME_Y_AXIS | HOME_Z_AXIS;
 2164              		.loc 1 559 5 view .LVU646
 564:app/gcode.c   ****     
 2165              		.loc 1 564 5 view .LVU647
 2166 0302 44F00400 		orr	r0, r4, #4
 2167 0306 FFF7FEFF 		bl	toolhead_home
 2168              	.LVL173:
 567:app/gcode.c   ****     if (axes_mask & HOME_Y_AXIS) { s_pos_y = 0.0f; }
 2169              		.loc 1 567 5 view .LVU648
 567:app/gcode.c   ****     if (axes_mask & HOME_Y_AXIS) { s_pos_y = 0.0f; }
 2170              		.loc 1 567 8 is_stmt 0 view .LVU649
 2171 030a 002C     		cmp	r4, #0
 2172 030c 3FF4B4AE 		beq	.L230
 2173              	.LVL174:
 567:app/gcode.c   ****     if (axes_mask & HOME_Y_AXIS) { s_pos_y = 0.0f; }
 2174              		.loc 1 567 36 is_stmt 1 view .LVU650
 567:app/gcode.c   ****     if (axes_mask & HOME_Y_AXIS) { s_pos_y = 0.0f; }
 2175              		.loc 1 567 44 is_stmt 0 view .LVU651
 2176 0310 094B     		ldr	r3, .L260+20
 2177 0312 0022     		movs	r2, #0
 2178 0314 1A60     		str	r2, [r3]	@ float
 568:app/gcode.c   ****     if (axes_mask & HOME_Z_AXIS) { s_pos_z = 0.0f; }
 2179              		.loc 1 568 5 is_stmt 1 view .LVU652
 2180 0316 AFE6     		b	.L230
 2181              	.LVL175:
 2182              	.L229:
 567:app/gcode.c   ****     if (axes_mask & HOME_Y_AXIS) { s_pos_y = 0.0f; }
 2183              		.loc 1 567 36 view .LVU653
 567:app/gcode.c   ****     if (axes_mask & HOME_Y_AXIS) { s_pos_y = 0.0f; }
ARM GAS  /tmp/ccqT8DeC.s 			page 63


 2184              		.loc 1 567 44 is_stmt 0 view .LVU654
 2185 0318 0749     		ldr	r1, .L260+20
 568:app/gcode.c   ****     if (axes_mask & HOME_Z_AXIS) { s_pos_z = 0.0f; }
 2186              		.loc 1 568 44 view .LVU655
 2187 031a 024A     		ldr	r2, .L260
 567:app/gcode.c   ****     if (axes_mask & HOME_Y_AXIS) { s_pos_y = 0.0f; }
 2188              		.loc 1 567 44 view .LVU656
 2189 031c 0023     		movs	r3, #0
 2190 031e 0B60     		str	r3, [r1]	@ float
 568:app/gcode.c   ****     if (axes_mask & HOME_Z_AXIS) { s_pos_z = 0.0f; }
 2191              		.loc 1 568 5 is_stmt 1 view .LVU657
 568:app/gcode.c   ****     if (axes_mask & HOME_Z_AXIS) { s_pos_z = 0.0f; }
 2192              		.loc 1 568 36 view .LVU658
 568:app/gcode.c   ****     if (axes_mask & HOME_Z_AXIS) { s_pos_z = 0.0f; }
 2193              		.loc 1 568 44 is_stmt 0 view .LVU659
 2194 0320 1360     		str	r3, [r2]	@ float
 569:app/gcode.c   ****     
 2195              		.loc 1 569 5 is_stmt 1 view .LVU660
 2196 0322 1AE7     		b	.L252
 2197              	.L261:
 2198              		.align	2
 2199              	.L260:
 2200 0324 00000000 		.word	.LANCHOR1
 2201 0328 00000000 		.word	.LANCHOR2
 2202 032c 00000000 		.word	.LANCHOR4
 2203 0330 00000000 		.word	.LANCHOR5
 2204 0334 00007042 		.word	1114636288
 2205 0338 00000000 		.word	.LANCHOR0
 2206 033c 00000000 		.word	.LANCHOR3
 2207 0340 00007F43 		.word	1132396544
 2208 0344 00000000 		.word	0
 2209 0348 0000C842 		.word	1120403456
 2210 034c 00000000 		.word	.LC0
 2211              	.LBE152:
 2212              	.LBE185:
 2213              		.cfi_endproc
 2214              	.LFE29:
 2216              		.section	.rodata.gcode_respond.str1.4,"aMS",%progbits,1
 2217              		.align	2
 2218              	.LC1:
 2219 0000 0D0A00   		.ascii	"\015\012\000"
 2220              		.section	.text.gcode_respond,"ax",%progbits
 2221              		.align	1
 2222              		.p2align 2,,3
 2223              		.global	gcode_respond
 2224              		.syntax unified
 2225              		.thumb
 2226              		.thumb_func
 2227              		.fpu fpv4-sp-d16
 2229              	gcode_respond:
 2230              	.LVL176:
 2231              	.LFB30:
 780:app/gcode.c   **** 
 781:app/gcode.c   **** /**
 782:app/gcode.c   ****  * @brief   发送响应消息
 783:app/gcode.c   ****  */
 784:app/gcode.c   **** void
ARM GAS  /tmp/ccqT8DeC.s 			page 64


 785:app/gcode.c   **** gcode_respond(const char *msg)
 786:app/gcode.c   **** {
 2232              		.loc 1 786 1 view -0
 2233              		.cfi_startproc
 2234              		@ args = 0, pretend = 0, frame = 0
 2235              		@ frame_needed = 0, uses_anonymous_args = 0
 787:app/gcode.c   ****     if (msg == NULL) {
 2236              		.loc 1 787 5 view .LVU662
 2237              		.loc 1 787 8 is_stmt 0 view .LVU663
 2238 0000 38B1     		cbz	r0, .L262
 2239              	.LBB188:
 2240              	.LBI188:
 785:app/gcode.c   **** {
 2241              		.loc 1 785 1 is_stmt 1 view .LVU664
 2242              	.LBB189:
 788:app/gcode.c   ****         return;
 789:app/gcode.c   ****     }
 790:app/gcode.c   ****     
 791:app/gcode.c   **** #ifndef TEST_BUILD
 792:app/gcode.c   ****     serial_puts(msg);
 2243              		.loc 1 792 5 view .LVU665
 2244              	.LBE189:
 2245              	.LBE188:
 786:app/gcode.c   ****     if (msg == NULL) {
 2246              		.loc 1 786 1 is_stmt 0 view .LVU666
 2247 0002 08B5     		push	{r3, lr}
 2248              		.cfi_def_cfa_offset 8
 2249              		.cfi_offset 3, -8
 2250              		.cfi_offset 14, -4
 2251              	.LBB192:
 2252              	.LBB190:
 2253              		.loc 1 792 5 view .LVU667
 2254 0004 FFF7FEFF 		bl	serial_puts
 2255              	.LVL177:
 793:app/gcode.c   ****     serial_puts("\r\n");
 2256              		.loc 1 793 5 is_stmt 1 view .LVU668
 2257              	.LBE190:
 2258              	.LBE192:
 794:app/gcode.c   **** #else
 795:app/gcode.c   ****     /* 测试构建时不输出 */
 796:app/gcode.c   ****     (void)msg;
 797:app/gcode.c   **** #endif
 798:app/gcode.c   **** }
 2259              		.loc 1 798 1 is_stmt 0 view .LVU669
 2260 0008 BDE80840 		pop	{r3, lr}
 2261              		.cfi_restore 14
 2262              		.cfi_restore 3
 2263              		.cfi_def_cfa_offset 0
 2264              	.LBB193:
 2265              	.LBB191:
 793:app/gcode.c   ****     serial_puts("\r\n");
 2266              		.loc 1 793 5 view .LVU670
 2267 000c 0148     		ldr	r0, .L267
 2268 000e FFF7FEBF 		b	serial_puts
 2269              	.LVL178:
 2270              	.L262:
 793:app/gcode.c   ****     serial_puts("\r\n");
ARM GAS  /tmp/ccqT8DeC.s 			page 65


 2271              		.loc 1 793 5 view .LVU671
 2272 0012 7047     		bx	lr
 2273              	.L268:
 2274              		.align	2
 2275              	.L267:
 2276 0014 00000000 		.word	.LC1
 2277              	.LBE191:
 2278              	.LBE193:
 2279              		.cfi_endproc
 2280              	.LFE30:
 2282              		.section	.text.gcode_respond_fmt,"ax",%progbits
 2283              		.align	1
 2284              		.p2align 2,,3
 2285              		.global	gcode_respond_fmt
 2286              		.syntax unified
 2287              		.thumb
 2288              		.thumb_func
 2289              		.fpu fpv4-sp-d16
 2291              	gcode_respond_fmt:
 2292              	.LVL179:
 2293              	.LFB31:
 799:app/gcode.c   **** 
 800:app/gcode.c   **** /**
 801:app/gcode.c   ****  * @brief   发送格式化响应消息
 802:app/gcode.c   ****  */
 803:app/gcode.c   **** void
 804:app/gcode.c   **** gcode_respond_fmt(const char *fmt, ...)
 805:app/gcode.c   **** {
 2294              		.loc 1 805 1 is_stmt 1 view -0
 2295              		.cfi_startproc
 2296              		@ args = 4, pretend = 16, frame = 8
 2297              		@ frame_needed = 0, uses_anonymous_args = 1
 806:app/gcode.c   ****     if (fmt == NULL) {
 2298              		.loc 1 806 5 view .LVU673
 805:app/gcode.c   ****     if (fmt == NULL) {
 2299              		.loc 1 805 1 is_stmt 0 view .LVU674
 2300 0000 0FB4     		push	{r0, r1, r2, r3}
 2301              		.cfi_def_cfa_offset 16
 2302              		.cfi_offset 0, -16
 2303              		.cfi_offset 1, -12
 2304              		.cfi_offset 2, -8
 2305              		.cfi_offset 3, -4
 2306 0002 00B5     		push	{lr}
 2307              		.cfi_def_cfa_offset 20
 2308              		.cfi_offset 14, -20
 2309 0004 83B0     		sub	sp, sp, #12
 2310              		.cfi_def_cfa_offset 32
 805:app/gcode.c   ****     if (fmt == NULL) {
 2311              		.loc 1 805 1 view .LVU675
 2312 0006 0498     		ldr	r0, [sp, #16]
 2313              		.loc 1 806 8 view .LVU676
 2314 0008 30B1     		cbz	r0, .L269
 807:app/gcode.c   ****         return;
 808:app/gcode.c   ****     }
 809:app/gcode.c   ****     
 810:app/gcode.c   **** #ifndef TEST_BUILD
 811:app/gcode.c   ****     va_list args;
ARM GAS  /tmp/ccqT8DeC.s 			page 66


 2315              		.loc 1 811 5 is_stmt 1 view .LVU677
 812:app/gcode.c   ****     va_start(args, fmt);
 2316              		.loc 1 812 5 view .LVU678
 2317 000a 05AB     		add	r3, sp, #20
 2318 000c 0193     		str	r3, [sp, #4]
 813:app/gcode.c   ****     
 814:app/gcode.c   ****     /* 使用简单的格式化输出 */
 815:app/gcode.c   ****     /* 注意: serial_printf 不支持 va_list，需要手动处理 */
 816:app/gcode.c   ****     /* 这里简化处理，直接输出格式字符串 */
 817:app/gcode.c   ****     serial_puts(fmt);
 2319              		.loc 1 817 5 view .LVU679
 2320 000e FFF7FEFF 		bl	serial_puts
 2321              	.LVL180:
 818:app/gcode.c   ****     serial_puts("\r\n");
 2322              		.loc 1 818 5 view .LVU680
 2323 0012 0448     		ldr	r0, .L273
 2324 0014 FFF7FEFF 		bl	serial_puts
 2325              	.LVL181:
 819:app/gcode.c   ****     
 820:app/gcode.c   ****     va_end(args);
 2326              		.loc 1 820 5 view .LVU681
 2327              	.L269:
 821:app/gcode.c   **** #else
 822:app/gcode.c   ****     /* 测试构建时不输出 */
 823:app/gcode.c   ****     (void)fmt;
 824:app/gcode.c   **** #endif
 825:app/gcode.c   **** }
 2328              		.loc 1 825 1 is_stmt 0 view .LVU682
 2329 0018 03B0     		add	sp, sp, #12
 2330              		.cfi_def_cfa_offset 20
 2331              		@ sp needed
 2332 001a 5DF804EB 		ldr	lr, [sp], #4
 2333              		.cfi_restore 14
 2334              		.cfi_def_cfa_offset 16
 2335 001e 04B0     		add	sp, sp, #16
 2336              		.cfi_restore 3
 2337              		.cfi_restore 2
 2338              		.cfi_restore 1
 2339              		.cfi_restore 0
 2340              		.cfi_def_cfa_offset 0
 2341 0020 7047     		bx	lr
 2342              	.L274:
 2343 0022 00BF     		.align	2
 2344              	.L273:
 2345 0024 00000000 		.word	.LC1
 2346              		.cfi_endproc
 2347              	.LFE31:
 2349              		.section	.rodata.gcode_process.str1.4,"aMS",%progbits,1
 2350              		.align	2
 2351              	.LC2:
 2352 0000 6F6B00   		.ascii	"ok\000"
 2353 0003 00       		.align	2
 2354              	.LC3:
 2355 0004 6572726F 		.ascii	"error: execution failed\000"
 2355      723A2065 
 2355      78656375 
 2355      74696F6E 
ARM GAS  /tmp/ccqT8DeC.s 			page 67


 2355      20666169 
 2356              		.align	2
 2357              	.LC4:
 2358 001c 6572726F 		.ascii	"error: unknown command\000"
 2358      723A2075 
 2358      6E6B6E6F 
 2358      776E2063 
 2358      6F6D6D61 
 2359 0033 00       		.align	2
 2360              	.LC5:
 2361 0034 6572726F 		.ascii	"error: invalid command\000"
 2361      723A2069 
 2361      6E76616C 
 2361      69642063 
 2361      6F6D6D61 
 2362 004b 00       		.align	2
 2363              	.LC6:
 2364 004c 6572726F 		.ascii	"error: parse error\000"
 2364      723A2070 
 2364      61727365 
 2364      20657272 
 2364      6F7200
 2365              		.section	.text.gcode_process,"ax",%progbits
 2366              		.align	1
 2367              		.p2align 2,,3
 2368              		.global	gcode_process
 2369              		.syntax unified
 2370              		.thumb
 2371              		.thumb_func
 2372              		.fpu fpv4-sp-d16
 2374              	gcode_process:
 2375              	.LFB32:
 826:app/gcode.c   **** 
 827:app/gcode.c   **** /**
 828:app/gcode.c   ****  * @brief   处理串口输入
 829:app/gcode.c   ****  * 
 830:app/gcode.c   ****  * 从串口读取一行 G-code，解析并执行。
 831:app/gcode.c   ****  * 非阻塞函数，如果没有完整行则立即返回。
 832:app/gcode.c   ****  */
 833:app/gcode.c   **** void
 834:app/gcode.c   **** gcode_process(void)
 835:app/gcode.c   **** {
 2376              		.loc 1 835 1 is_stmt 1 view -0
 2377              		.cfi_startproc
 2378              		@ args = 0, pretend = 0, frame = 40
 2379              		@ frame_needed = 0, uses_anonymous_args = 0
 836:app/gcode.c   **** #ifndef TEST_BUILD
 837:app/gcode.c   ****     gcode_cmd_t cmd;
 2380              		.loc 1 837 5 view .LVU684
 838:app/gcode.c   ****     int ret;
 2381              		.loc 1 838 5 view .LVU685
 839:app/gcode.c   ****     int line_len;
 2382              		.loc 1 839 5 view .LVU686
 840:app/gcode.c   ****     
 841:app/gcode.c   ****     /* 检查是否有完整行可用 */
 842:app/gcode.c   ****     if (!serial_line_available()) {
 2383              		.loc 1 842 5 view .LVU687
ARM GAS  /tmp/ccqT8DeC.s 			page 68


 835:app/gcode.c   **** #ifndef TEST_BUILD
 2384              		.loc 1 835 1 is_stmt 0 view .LVU688
 2385 0000 00B5     		push	{lr}
 2386              		.cfi_def_cfa_offset 4
 2387              		.cfi_offset 14, -4
 2388 0002 8BB0     		sub	sp, sp, #44
 2389              		.cfi_def_cfa_offset 48
 2390              		.loc 1 842 10 view .LVU689
 2391 0004 FFF7FEFF 		bl	serial_line_available
 2392              	.LVL182:
 2393              		.loc 1 842 8 view .LVU690
 2394 0008 10B9     		cbnz	r0, .L289
 2395              	.L275:
 843:app/gcode.c   ****         return;
 844:app/gcode.c   ****     }
 845:app/gcode.c   ****     
 846:app/gcode.c   ****     /* 读取一行 */
 847:app/gcode.c   ****     line_len = serial_readline(s_line_buffer, GCODE_LINE_BUFFER_SIZE);
 848:app/gcode.c   ****     if (line_len <= 0) {
 849:app/gcode.c   ****         return;
 850:app/gcode.c   ****     }
 851:app/gcode.c   ****     
 852:app/gcode.c   ****     /* 解析 G-code */
 853:app/gcode.c   ****     ret = gcode_parse_line(s_line_buffer, &cmd);
 854:app/gcode.c   ****     
 855:app/gcode.c   ****     /* 处理解析结果 */
 856:app/gcode.c   ****     switch (ret) {
 857:app/gcode.c   ****         case GCODE_OK:
 858:app/gcode.c   ****             /* 执行命令 */
 859:app/gcode.c   ****             ret = gcode_execute(&cmd);
 860:app/gcode.c   ****             if (ret == GCODE_OK) {
 861:app/gcode.c   ****                 gcode_respond("ok");
 862:app/gcode.c   ****             } else {
 863:app/gcode.c   ****                 gcode_respond("error: execution failed");
 864:app/gcode.c   ****             }
 865:app/gcode.c   ****             break;
 866:app/gcode.c   ****             
 867:app/gcode.c   ****         case GCODE_ERR_EMPTY:
 868:app/gcode.c   ****         case GCODE_ERR_COMMENT:
 869:app/gcode.c   ****             /* 空行或注释，发送 ok */
 870:app/gcode.c   ****             gcode_respond("ok");
 871:app/gcode.c   ****             break;
 872:app/gcode.c   ****             
 873:app/gcode.c   ****         case GCODE_ERR_UNKNOWN:
 874:app/gcode.c   ****             gcode_respond("error: unknown command");
 875:app/gcode.c   ****             break;
 876:app/gcode.c   ****             
 877:app/gcode.c   ****         case GCODE_ERR_INVALID:
 878:app/gcode.c   ****             gcode_respond("error: invalid command");
 879:app/gcode.c   ****             break;
 880:app/gcode.c   ****             
 881:app/gcode.c   ****         default:
 882:app/gcode.c   ****             gcode_respond("error: parse error");
 883:app/gcode.c   ****             break;
 884:app/gcode.c   ****     }
 885:app/gcode.c   **** #endif
 886:app/gcode.c   **** }
ARM GAS  /tmp/ccqT8DeC.s 			page 69


 2396              		.loc 1 886 1 view .LVU691
 2397 000a 0BB0     		add	sp, sp, #44
 2398              		.cfi_remember_state
 2399              		.cfi_def_cfa_offset 4
 2400              		@ sp needed
 2401 000c 5DF804FB 		ldr	pc, [sp], #4
 2402              	.L289:
 2403              		.cfi_restore_state
 847:app/gcode.c   ****     if (line_len <= 0) {
 2404              		.loc 1 847 5 is_stmt 1 view .LVU692
 847:app/gcode.c   ****     if (line_len <= 0) {
 2405              		.loc 1 847 16 is_stmt 0 view .LVU693
 2406 0010 1F48     		ldr	r0, .L290
 2407 0012 8021     		movs	r1, #128
 2408 0014 FFF7FEFF 		bl	serial_readline
 2409              	.LVL183:
 848:app/gcode.c   ****         return;
 2410              		.loc 1 848 5 is_stmt 1 view .LVU694
 848:app/gcode.c   ****         return;
 2411              		.loc 1 848 8 is_stmt 0 view .LVU695
 2412 0018 0028     		cmp	r0, #0
 2413 001a F6DD     		ble	.L275
 853:app/gcode.c   ****     
 2414              		.loc 1 853 5 is_stmt 1 view .LVU696
 2415              	.LVL184:
 2416              	.LBB224:
 2417              	.LBI224:
 157:app/gcode.c   **** {
 2418              		.loc 1 157 1 view .LVU697
 2419              	.LBB225:
 159:app/gcode.c   ****     int ret;
 2420              		.loc 1 159 5 view .LVU698
 160:app/gcode.c   ****     
 2421              		.loc 1 160 5 view .LVU699
 163:app/gcode.c   ****         return GCODE_ERR_NULL;
 2422              		.loc 1 163 5 view .LVU700
 168:app/gcode.c   ****     
 2423              		.loc 1 168 5 view .LVU701
 2424              	.LBB226:
 2425              	.LBI226:
 225:app/gcode.c   **** {
 2426              		.loc 1 225 1 view .LVU702
 2427              	.LBE226:
 2428              	.LBE225:
 2429              	.LBE224:
 227:app/gcode.c   ****         memset(p_cmd, 0, sizeof(gcode_cmd_t));
 2430              		.loc 1 227 5 view .LVU703
 2431              	.LBB231:
 2432              	.LBB230:
 2433              	.LBB229:
 2434              	.LBB227:
 2435              	.LBI227:
 225:app/gcode.c   **** {
 2436              		.loc 1 225 1 view .LVU704
 2437              	.LBB228:
 228:app/gcode.c   ****     }
 2438              		.loc 1 228 9 view .LVU705
ARM GAS  /tmp/ccqT8DeC.s 			page 70


 2439 001c 2422     		movs	r2, #36
 2440 001e 0021     		movs	r1, #0
 2441 0020 01A8     		add	r0, sp, #4
 2442              	.LVL185:
 228:app/gcode.c   ****     }
 2443              		.loc 1 228 9 is_stmt 0 view .LVU706
 2444 0022 FFF7FEFF 		bl	memset
 2445              	.LVL186:
 228:app/gcode.c   ****     }
 2446              		.loc 1 228 9 view .LVU707
 2447              	.LBE228:
 2448              	.LBE227:
 2449              	.LBE229:
 2450 0026 1A48     		ldr	r0, .L290
 2451 0028 01A9     		add	r1, sp, #4
 2452              	.LVL187:
 228:app/gcode.c   ****     }
 2453              		.loc 1 228 9 view .LVU708
 2454 002a FFF7FEFF 		bl	gcode_parse_line.part.0
 2455              	.LVL188:
 228:app/gcode.c   ****     }
 2456              		.loc 1 228 9 view .LVU709
 2457              	.LBE230:
 2458              	.LBE231:
 856:app/gcode.c   ****         case GCODE_OK:
 2459              		.loc 1 856 5 is_stmt 1 view .LVU710
 2460 002e 0630     		adds	r0, r0, #6
 2461              	.LVL189:
 856:app/gcode.c   ****         case GCODE_OK:
 2462              		.loc 1 856 5 is_stmt 0 view .LVU711
 2463 0030 0628     		cmp	r0, #6
 2464 0032 1ED8     		bhi	.L277
 2465 0034 DFE800F0 		tbb	[pc, r0]
 2466              	.L279:
 2467 0038 16       		.byte	(.L282-.L279)/2
 2468 0039 1D       		.byte	(.L277-.L279)/2
 2469 003a 0F       		.byte	(.L281-.L279)/2
 2470 003b 08       		.byte	(.L280-.L279)/2
 2471 003c 08       		.byte	(.L280-.L279)/2
 2472 003d 1D       		.byte	(.L277-.L279)/2
 2473 003e 04       		.byte	(.L278-.L279)/2
 2474 003f 00       		.p2align 1
 2475              	.L278:
 859:app/gcode.c   ****             if (ret == GCODE_OK) {
 2476              		.loc 1 859 13 is_stmt 1 view .LVU712
 859:app/gcode.c   ****             if (ret == GCODE_OK) {
 2477              		.loc 1 859 19 is_stmt 0 view .LVU713
 2478 0040 01A8     		add	r0, sp, #4
 2479              	.LVL190:
 859:app/gcode.c   ****             if (ret == GCODE_OK) {
 2480              		.loc 1 859 19 view .LVU714
 2481 0042 FFF7FEFF 		bl	gcode_execute
 2482              	.LVL191:
 860:app/gcode.c   ****                 gcode_respond("ok");
 2483              		.loc 1 860 13 is_stmt 1 view .LVU715
 860:app/gcode.c   ****                 gcode_respond("ok");
 2484              		.loc 1 860 16 is_stmt 0 view .LVU716
ARM GAS  /tmp/ccqT8DeC.s 			page 71


 2485 0046 D8B9     		cbnz	r0, .L283
 2486              	.LVL192:
 2487              	.L280:
 870:app/gcode.c   ****             break;
 2488              		.loc 1 870 13 is_stmt 1 view .LVU717
 2489              	.LBB232:
 2490              	.LBI232:
 785:app/gcode.c   **** {
 2491              		.loc 1 785 1 view .LVU718
 2492              	.LBE232:
 787:app/gcode.c   ****         return;
 2493              		.loc 1 787 5 view .LVU719
 2494              	.LBB235:
 2495              	.LBB233:
 2496              	.LBI233:
 785:app/gcode.c   **** {
 2497              		.loc 1 785 1 view .LVU720
 2498              	.LBB234:
 792:app/gcode.c   ****     serial_puts("\r\n");
 2499              		.loc 1 792 5 view .LVU721
 2500 0048 1248     		ldr	r0, .L290+4
 2501 004a FFF7FEFF 		bl	serial_puts
 2502              	.LVL193:
 793:app/gcode.c   **** #else
 2503              		.loc 1 793 5 view .LVU722
 2504 004e 1248     		ldr	r0, .L290+8
 2505 0050 FFF7FEFF 		bl	serial_puts
 2506              	.LVL194:
 2507 0054 D9E7     		b	.L275
 2508              	.LVL195:
 2509              	.L281:
 793:app/gcode.c   **** #else
 2510              		.loc 1 793 5 is_stmt 0 view .LVU723
 2511              	.LBE234:
 2512              	.LBE233:
 2513              	.LBE235:
 878:app/gcode.c   ****             break;
 2514              		.loc 1 878 13 is_stmt 1 view .LVU724
 2515              	.LBB236:
 2516              	.LBI236:
 785:app/gcode.c   **** {
 2517              		.loc 1 785 1 view .LVU725
 2518              	.LBE236:
 787:app/gcode.c   ****         return;
 2519              		.loc 1 787 5 view .LVU726
 2520              	.LBB239:
 2521              	.LBB237:
 2522              	.LBI237:
 785:app/gcode.c   **** {
 2523              		.loc 1 785 1 view .LVU727
 2524              	.LBB238:
 792:app/gcode.c   ****     serial_puts("\r\n");
 2525              		.loc 1 792 5 view .LVU728
 2526 0056 1148     		ldr	r0, .L290+12
 2527              	.LVL196:
 792:app/gcode.c   ****     serial_puts("\r\n");
 2528              		.loc 1 792 5 is_stmt 0 view .LVU729
ARM GAS  /tmp/ccqT8DeC.s 			page 72


 2529 0058 FFF7FEFF 		bl	serial_puts
 2530              	.LVL197:
 793:app/gcode.c   **** #else
 2531              		.loc 1 793 5 is_stmt 1 view .LVU730
 2532 005c 0E48     		ldr	r0, .L290+8
 2533 005e FFF7FEFF 		bl	serial_puts
 2534              	.LVL198:
 2535 0062 D2E7     		b	.L275
 2536              	.LVL199:
 2537              	.L282:
 793:app/gcode.c   **** #else
 2538              		.loc 1 793 5 is_stmt 0 view .LVU731
 2539              	.LBE238:
 2540              	.LBE237:
 2541              	.LBE239:
 874:app/gcode.c   ****             break;
 2542              		.loc 1 874 13 is_stmt 1 view .LVU732
 2543              	.LBB240:
 2544              	.LBI240:
 785:app/gcode.c   **** {
 2545              		.loc 1 785 1 view .LVU733
 2546              	.LBE240:
 787:app/gcode.c   ****         return;
 2547              		.loc 1 787 5 view .LVU734
 2548              	.LBB243:
 2549              	.LBB241:
 2550              	.LBI241:
 785:app/gcode.c   **** {
 2551              		.loc 1 785 1 view .LVU735
 2552              	.LBB242:
 792:app/gcode.c   ****     serial_puts("\r\n");
 2553              		.loc 1 792 5 view .LVU736
 2554 0064 0E48     		ldr	r0, .L290+16
 2555              	.LVL200:
 792:app/gcode.c   ****     serial_puts("\r\n");
 2556              		.loc 1 792 5 is_stmt 0 view .LVU737
 2557 0066 FFF7FEFF 		bl	serial_puts
 2558              	.LVL201:
 793:app/gcode.c   **** #else
 2559              		.loc 1 793 5 is_stmt 1 view .LVU738
 2560 006a 0B48     		ldr	r0, .L290+8
 2561 006c FFF7FEFF 		bl	serial_puts
 2562              	.LVL202:
 2563 0070 CBE7     		b	.L275
 2564              	.LVL203:
 2565              	.L277:
 793:app/gcode.c   **** #else
 2566              		.loc 1 793 5 is_stmt 0 view .LVU739
 2567              	.LBE242:
 2568              	.LBE241:
 2569              	.LBE243:
 882:app/gcode.c   ****             break;
 2570              		.loc 1 882 13 is_stmt 1 view .LVU740
 2571              	.LBB244:
 2572              	.LBI244:
 785:app/gcode.c   **** {
 2573              		.loc 1 785 1 view .LVU741
ARM GAS  /tmp/ccqT8DeC.s 			page 73


 2574              	.LBE244:
 787:app/gcode.c   ****         return;
 2575              		.loc 1 787 5 view .LVU742
 2576              	.LBB247:
 2577              	.LBB245:
 2578              	.LBI245:
 785:app/gcode.c   **** {
 2579              		.loc 1 785 1 view .LVU743
 2580              	.LBB246:
 792:app/gcode.c   ****     serial_puts("\r\n");
 2581              		.loc 1 792 5 view .LVU744
 2582 0072 0C48     		ldr	r0, .L290+20
 2583              	.LVL204:
 792:app/gcode.c   ****     serial_puts("\r\n");
 2584              		.loc 1 792 5 is_stmt 0 view .LVU745
 2585 0074 FFF7FEFF 		bl	serial_puts
 2586              	.LVL205:
 793:app/gcode.c   **** #else
 2587              		.loc 1 793 5 is_stmt 1 view .LVU746
 2588 0078 0748     		ldr	r0, .L290+8
 2589 007a FFF7FEFF 		bl	serial_puts
 2590              	.LVL206:
 793:app/gcode.c   **** #else
 2591              		.loc 1 793 5 is_stmt 0 view .LVU747
 2592 007e C4E7     		b	.L275
 2593              	.LVL207:
 2594              	.L283:
 793:app/gcode.c   **** #else
 2595              		.loc 1 793 5 view .LVU748
 2596              	.LBE246:
 2597              	.LBE245:
 2598              	.LBE247:
 863:app/gcode.c   ****             }
 2599              		.loc 1 863 17 is_stmt 1 view .LVU749
 2600              	.LBB248:
 2601              	.LBI248:
 785:app/gcode.c   **** {
 2602              		.loc 1 785 1 view .LVU750
 2603              	.LBE248:
 787:app/gcode.c   ****         return;
 2604              		.loc 1 787 5 view .LVU751
 2605              	.LBB251:
 2606              	.LBB249:
 2607              	.LBI249:
 785:app/gcode.c   **** {
 2608              		.loc 1 785 1 view .LVU752
 2609              	.LBB250:
 792:app/gcode.c   ****     serial_puts("\r\n");
 2610              		.loc 1 792 5 view .LVU753
 2611 0080 0948     		ldr	r0, .L290+24
 2612              	.LVL208:
 792:app/gcode.c   ****     serial_puts("\r\n");
 2613              		.loc 1 792 5 is_stmt 0 view .LVU754
 2614 0082 FFF7FEFF 		bl	serial_puts
 2615              	.LVL209:
 793:app/gcode.c   **** #else
 2616              		.loc 1 793 5 is_stmt 1 view .LVU755
ARM GAS  /tmp/ccqT8DeC.s 			page 74


 2617 0086 0448     		ldr	r0, .L290+8
 2618 0088 FFF7FEFF 		bl	serial_puts
 2619              	.LVL210:
 2620 008c BDE7     		b	.L275
 2621              	.L291:
 2622 008e 00BF     		.align	2
 2623              	.L290:
 2624 0090 00000000 		.word	.LANCHOR6
 2625 0094 00000000 		.word	.LC2
 2626 0098 00000000 		.word	.LC1
 2627 009c 34000000 		.word	.LC5
 2628 00a0 1C000000 		.word	.LC4
 2629 00a4 4C000000 		.word	.LC6
 2630 00a8 04000000 		.word	.LC3
 2631              	.LBE250:
 2632              	.LBE249:
 2633              	.LBE251:
 2634              		.cfi_endproc
 2635              	.LFE32:
 2637              		.section	.bss.s_coord_mode,"aw",%nobits
 2638              		.set	.LANCHOR4,. + 0
 2641              	s_coord_mode:
 2642 0000 00       		.space	1
 2643              		.section	.bss.s_line_buffer,"aw",%nobits
 2644              		.align	2
 2645              		.set	.LANCHOR6,. + 0
 2648              	s_line_buffer:
 2649 0000 00000000 		.space	128
 2649      00000000 
 2649      00000000 
 2649      00000000 
 2649      00000000 
 2650              		.section	.bss.s_pos_e,"aw",%nobits
 2651              		.align	2
 2652              		.set	.LANCHOR3,. + 0
 2655              	s_pos_e:
 2656 0000 00000000 		.space	4
 2657              		.section	.bss.s_pos_x,"aw",%nobits
 2658              		.align	2
 2659              		.set	.LANCHOR0,. + 0
 2662              	s_pos_x:
 2663 0000 00000000 		.space	4
 2664              		.section	.bss.s_pos_y,"aw",%nobits
 2665              		.align	2
 2666              		.set	.LANCHOR1,. + 0
 2669              	s_pos_y:
 2670 0000 00000000 		.space	4
 2671              		.section	.bss.s_pos_z,"aw",%nobits
 2672              		.align	2
 2673              		.set	.LANCHOR2,. + 0
 2676              	s_pos_z:
 2677 0000 00000000 		.space	4
 2678              		.section	.data.s_feedrate,"aw"
 2679              		.align	2
 2680              		.set	.LANCHOR5,. + 0
 2683              	s_feedrate:
 2684 0000 00803B45 		.word	1161527296
ARM GAS  /tmp/ccqT8DeC.s 			page 75


 2685              		.text
 2686              	.Letext0:
 2687              		.file 2 "/usr/lib/gcc/arm-none-eabi/10.3.1/include/stdint.h"
 2688              		.file 3 "app/gcode.h"
 2689              		.file 4 "/usr/lib/gcc/arm-none-eabi/10.3.1/include/stdarg.h"
 2690              		.file 5 "/usr/include/newlib/ctype.h"
 2691              		.file 6 "./src/stm32/serial.h"
 2692              		.file 7 "<built-in>"
ARM GAS  /tmp/ccqT8DeC.s 			page 76


DEFINED SYMBOLS
                            *ABS*:0000000000000000 gcode.c
     /tmp/ccqT8DeC.s:18     .text.gcode_parse_line.part.0:0000000000000000 $t
     /tmp/ccqT8DeC.s:26     .text.gcode_parse_line.part.0:0000000000000000 gcode_parse_line.part.0
     /tmp/ccqT8DeC.s:472    .text.gcode_parse_line.part.0:0000000000000178 $d
     /tmp/ccqT8DeC.s:484    .text.gcode_parse_line.part.0:00000000000001a4 $t
     /tmp/ccqT8DeC.s:563    .text.gcode_parse_line.part.0:00000000000001f4 $d
     /tmp/ccqT8DeC.s:586    .text.gcode_parse_line.part.0:000000000000020a $t
     /tmp/ccqT8DeC.s:850    .text.gcode_parse_line.part.0:0000000000000324 $d
     /tmp/ccqT8DeC.s:858    .text.toolhead_move:0000000000000000 $t
     /tmp/ccqT8DeC.s:866    .text.toolhead_move:0000000000000000 toolhead_move
     /tmp/ccqT8DeC.s:887    .text.toolhead_home:0000000000000000 $t
     /tmp/ccqT8DeC.s:895    .text.toolhead_home:0000000000000000 toolhead_home
     /tmp/ccqT8DeC.s:914    .text.toolhead_get_position:0000000000000000 $t
     /tmp/ccqT8DeC.s:922    .text.toolhead_get_position:0000000000000000 toolhead_get_position
     /tmp/ccqT8DeC.s:1022   .text.toolhead_get_position:0000000000000048 $d
     /tmp/ccqT8DeC.s:1030   .text.toolhead_wait_moves:0000000000000000 $t
     /tmp/ccqT8DeC.s:1038   .text.toolhead_wait_moves:0000000000000000 toolhead_wait_moves
     /tmp/ccqT8DeC.s:1051   .text.heater_set_temp:0000000000000000 $t
     /tmp/ccqT8DeC.s:1059   .text.heater_set_temp:0000000000000000 heater_set_temp
     /tmp/ccqT8DeC.s:1075   .text.heater_get_temp:0000000000000000 $t
     /tmp/ccqT8DeC.s:1083   .text.heater_get_temp:0000000000000000 heater_get_temp
     /tmp/ccqT8DeC.s:1099   .text.heater_get_temp:0000000000000008 $d
     /tmp/ccqT8DeC.s:1104   .text.heater_get_target:0000000000000000 $t
     /tmp/ccqT8DeC.s:1112   .text.heater_get_target:0000000000000000 heater_get_target
     /tmp/ccqT8DeC.s:1123   .text.heater_get_target:0000000000000008 $d
     /tmp/ccqT8DeC.s:1128   .text.heater_is_at_target:0000000000000000 $t
     /tmp/ccqT8DeC.s:1136   .text.heater_is_at_target:0000000000000000 heater_is_at_target
     /tmp/ccqT8DeC.s:1155   .text.fan_set_speed:0000000000000000 $t
     /tmp/ccqT8DeC.s:1163   .text.fan_set_speed:0000000000000000 fan_set_speed
     /tmp/ccqT8DeC.s:1174   .text.fan_get_speed:0000000000000000 $t
     /tmp/ccqT8DeC.s:1182   .text.fan_get_speed:0000000000000000 fan_get_speed
     /tmp/ccqT8DeC.s:1193   .text.fan_get_speed:0000000000000008 $d
     /tmp/ccqT8DeC.s:1198   .text.gcode_init:0000000000000000 $t
     /tmp/ccqT8DeC.s:1206   .text.gcode_init:0000000000000000 gcode_init
     /tmp/ccqT8DeC.s:1223   .text.gcode_init:0000000000000008 $d
     /tmp/ccqT8DeC.s:1228   .text.gcode_parse_line:0000000000000000 $t
     /tmp/ccqT8DeC.s:1236   .text.gcode_parse_line:0000000000000000 gcode_parse_line
     /tmp/ccqT8DeC.s:1311   .text.gcode_get_mode:0000000000000000 $t
     /tmp/ccqT8DeC.s:1319   .text.gcode_get_mode:0000000000000000 gcode_get_mode
     /tmp/ccqT8DeC.s:1335   .text.gcode_get_mode:0000000000000008 $d
     /tmp/ccqT8DeC.s:1340   .text.gcode_set_mode:0000000000000000 $t
     /tmp/ccqT8DeC.s:1348   .text.gcode_set_mode:0000000000000000 gcode_set_mode
     /tmp/ccqT8DeC.s:1365   .text.gcode_set_mode:0000000000000008 $d
     /tmp/ccqT8DeC.s:1370   .text.gcode_cmd_clear:0000000000000000 $t
     /tmp/ccqT8DeC.s:1378   .text.gcode_cmd_clear:0000000000000000 gcode_cmd_clear
     /tmp/ccqT8DeC.s:1409   .rodata.gcode_execute.str1.4:0000000000000000 $d
     /tmp/ccqT8DeC.s:1414   .text.gcode_execute:0000000000000000 $t
     /tmp/ccqT8DeC.s:1422   .text.gcode_execute:0000000000000000 gcode_execute
     /tmp/ccqT8DeC.s:1461   .text.gcode_execute:0000000000000022 $d
     /tmp/ccqT8DeC.s:2200   .text.gcode_execute:0000000000000324 $d
     /tmp/ccqT8DeC.s:2217   .rodata.gcode_respond.str1.4:0000000000000000 $d
     /tmp/ccqT8DeC.s:2221   .text.gcode_respond:0000000000000000 $t
     /tmp/ccqT8DeC.s:2229   .text.gcode_respond:0000000000000000 gcode_respond
     /tmp/ccqT8DeC.s:2276   .text.gcode_respond:0000000000000014 $d
     /tmp/ccqT8DeC.s:2283   .text.gcode_respond_fmt:0000000000000000 $t
     /tmp/ccqT8DeC.s:2291   .text.gcode_respond_fmt:0000000000000000 gcode_respond_fmt
ARM GAS  /tmp/ccqT8DeC.s 			page 77


     /tmp/ccqT8DeC.s:2345   .text.gcode_respond_fmt:0000000000000024 $d
     /tmp/ccqT8DeC.s:2350   .rodata.gcode_process.str1.4:0000000000000000 $d
     /tmp/ccqT8DeC.s:2366   .text.gcode_process:0000000000000000 $t
     /tmp/ccqT8DeC.s:2374   .text.gcode_process:0000000000000000 gcode_process
     /tmp/ccqT8DeC.s:2467   .text.gcode_process:0000000000000038 $d
     /tmp/ccqT8DeC.s:2624   .text.gcode_process:0000000000000090 $d
     /tmp/ccqT8DeC.s:2641   .bss.s_coord_mode:0000000000000000 s_coord_mode
     /tmp/ccqT8DeC.s:2642   .bss.s_coord_mode:0000000000000000 $d
     /tmp/ccqT8DeC.s:2644   .bss.s_line_buffer:0000000000000000 $d
     /tmp/ccqT8DeC.s:2648   .bss.s_line_buffer:0000000000000000 s_line_buffer
     /tmp/ccqT8DeC.s:2651   .bss.s_pos_e:0000000000000000 $d
     /tmp/ccqT8DeC.s:2655   .bss.s_pos_e:0000000000000000 s_pos_e
     /tmp/ccqT8DeC.s:2658   .bss.s_pos_x:0000000000000000 $d
     /tmp/ccqT8DeC.s:2662   .bss.s_pos_x:0000000000000000 s_pos_x
     /tmp/ccqT8DeC.s:2665   .bss.s_pos_y:0000000000000000 $d
     /tmp/ccqT8DeC.s:2669   .bss.s_pos_y:0000000000000000 s_pos_y
     /tmp/ccqT8DeC.s:2672   .bss.s_pos_z:0000000000000000 $d
     /tmp/ccqT8DeC.s:2676   .bss.s_pos_z:0000000000000000 s_pos_z
     /tmp/ccqT8DeC.s:2679   .data.s_feedrate:0000000000000000 $d
     /tmp/ccqT8DeC.s:2683   .data.s_feedrate:0000000000000000 s_feedrate
     /tmp/ccqT8DeC.s:1472   .text.gcode_execute:000000000000002d $d
     /tmp/ccqT8DeC.s:1472   .text.gcode_execute:000000000000002e $t
     /tmp/ccqT8DeC.s:2474   .text.gcode_process:000000000000003f $d
     /tmp/ccqT8DeC.s:2474   .text.gcode_process:0000000000000040 $t

UNDEFINED SYMBOLS
_ctype_
memset
serial_printf
serial_puts
serial_line_available
serial_readline
